[{"title":"ES6ä¸­çš„æš‚æ—¶æ€§æ­»åŒºï¼ˆTDZï¼‰","date":"2017-02-10T06:54:50.000Z","path":"2017/02/10/ES6 TDZ/","text":"èµ·å› æ•…äº‹è¦ä»é˜®ä¸€å³°è€å¸ˆçš„ä¸€æ¡å¾®åšå¼€å§‹è¯´èµ·ã€‚ã€‚ã€‚ è¿™æ¡å¾®åšä¸‹é¢æœ‰å¾ˆå¤šçš„è¯„è®ºï¼Œæœ‰çš„å‰å®³çš„äººä¸€çœ¼å°±æŒ‡å‡ºäº†è¿™æ˜¯ç”±äºTDZçš„åŸå› ï¼Œå¹¶ä¸æ˜¯ä»€ä¹ˆV8çš„bugï¼ŒTDZæ˜¯ä»€ä¹ˆï¼Ÿä¸‹é¢æˆ‘ä»¬å°±æ¥æ…¢æ…¢æ­å¼€è¿™å±‚é¢çº±ã€‚ å˜é‡æå‡å…ˆä»æœ€ç®€å•çš„å˜é‡æå‡è¯´èµ·ã€‚ 12345678console.log(a);var a = 123;// è¿™é‡Œä¼šè¾“å‡ºundefinedï¼ŒåŸå› æ˜¯ä¸Šé¢è¿™æ®µä»£ç å’Œä¸‹é¢çš„è¿™æ®µä»£ç æ˜¯ç­‰ä»·çš„var a;console.log(a);a = 123; åœ¨ES6ä¸­ï¼Œé™¤äº†varå…³é”®å­—æ„å¤–ï¼Œè¿˜å¤šäº†letå’Œconstå…³é”®å­—ï¼Œæœ‰ä»€ä¹ˆå·®å¼‚å‘¢ï¼Ÿ å…ˆè¯´constå§ï¼Œconstçš„æ„æ€æ˜¯å®šä¹‰é™æ€å¸¸é‡ï¼Œæ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆæ¥å¼€è„‘æ´æƒ³æƒ³ï¼Œå½“consté‡ä¸Šå˜é‡æå‡ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ 12345678console.log(a);const a = 123;// å¦‚æœconstçš„å˜é‡æå‡å­˜åœ¨ï¼Œåˆ™ä¸Šé¢ä»£ç åº”è¯¥å’Œä¸‹é¢ä»£ç ç­‰ä»·const a;console.log(a);a = 123; æƒ³å¿…å¤§å®¶éƒ½å‘ç°é—®é¢˜äº†å§ï¼Œå¾ˆæ˜æ˜¾ï¼Œå‰é¢è¯´äº†constæ˜¯å®šä¹‰çš„é™æ€å¸¸é‡ï¼Œæ˜¯ä¸å¯å˜çš„ï¼Œå‡è®¾ä¸Šé¢çš„ä»£ç æ˜¯å¯¹çš„ï¼Œé‚£ä¹ˆæœ€å¼€å§‹aåº”è¯¥æ˜¯undefinedï¼Œå¯æ˜¯åé¢å´è¢«å†æ¬¡èµ‹å€¼æˆäº†123ï¼Œå’Œconstå®šä¹‰çš„é™æ€å¸¸é‡ä¸å¯æ”¹å˜ç›¸è¿èƒŒï¼Œæ‰€ä»¥è¿™é‡Œå°±æœ‰é—®é¢˜ï¼Œæ‰€ä»¥constæ²¡æœ‰å˜é‡æå‡ï¼Ÿè‡³å°‘ç°åœ¨çœ‹èµ·æ¥ï¼Œconstæ˜¯ä¸åº”è¯¥æœ‰å˜é‡æå‡çš„ã€‚ ç„¶åå†æ¥çœ‹çœ‹letå…³é”®å­—ï¼Œå’Œä¸Šé¢ä¸€æ ·ï¼Œå½“leté‡è§å˜é‡æå‡ï¼Œåˆä¼šæ€æ ·å‘¢ï¼Ÿè€è§„çŸ©ï¼Œä¸Šä»£ç å§ã€‚ 12345678console.log(a);let a = 123;// å¦‚æœletçš„å˜é‡æå‡å­˜åœ¨ï¼Œåˆ™ä¸Šé¢ä»£ç åº”è¯¥å’Œä¸‹é¢ä»£ç ç­‰ä»·let a;console.log(a);a = 123; è¿™æ®µä»£ç ï¼Œè‡³å°‘çœ‹èµ·æ¥æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä¸æ˜¯å—ï¼Ÿå¯æ˜¯å®é™…æœ‰é—®é¢˜æ²¡æœ‰ï¼Œè¿˜æ˜¯è¦æ”¾è¿›æµè§ˆå™¨ä¸­è¿è¡Œä¸€ä¸‹æ‰çŸ¥é“ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¿™æ®µä»£ç æ”¾è¿›chromeé‡Œçœ‹çœ‹ã€‚ å¯æƒœï¼Œä¼¼ä¹å¾ˆä¸å¹¸ã€‚ã€‚ã€‚ æ‰€ä»¥ç…§ç°åœ¨çœ‹æ¥ï¼Œconstå’Œletéƒ½æ˜¯æ²¡æœ‰å˜é‡æå‡çš„ï¼Œå¯¹å§ã€‚ ç„¶åæˆ‘ä»¬æ¥çœ‹ä¸‹é¢ä¸€æ®µä»£ç ã€‚ 123456let e = 12;(function()&#123;console.log(e);let e = 123;&#125;)()// å¦‚æœè¯´letçœŸçš„æ²¡æœ‰å˜é‡æå‡çš„è¯ï¼Œé‚£ä¹ˆè¿™é‡Œåº”è¯¥æ‰“å°å‡º12ï¼ŒOKï¼Ÿå®é™…ä¸Šå¦‚ä½•å‘¢ï¼Œè¿˜æ˜¯æŠŠä»£ç æ”¾è¿›æµè§ˆå™¨ä¸­è¿è¡Œçœ‹çœ‹å§ã€‚ æ€ä¹ˆä¼šæ˜¯è¿™æ ·å‘¢ï¼Œä¸æ˜¯è¯´å¥½çš„æ²¡æœ‰å˜é‡æå‡å—ï¼Œæ€ä¹ˆä¼šæŠ¥é”™å•Šï¼Ÿä¸‹é¢æˆ‘ä»¬æ¥ç»†ç»†åˆ†æã€‚ let const è¯¦è§£åœ¨ES6ä¸­ï¼Œæœ€å¸¸è§çš„TDZå°±æ˜¯åœ¨let/constçš„ä½¿ç”¨ä¸Šï¼Œæ ¹æ®ES6ä¸­å¯¹let/constå£°æ˜çš„ç« èŠ‚ï¼ŒåŸæ–‡æ˜¯è¿™æ ·è¯´çš„ï¼š 1The variables are created when their containing Lexical Environment is instantiated but may not be accessed in any way until the variableâ€™s LexicalBinding is evaluated. è¿™æ®µè¯çš„æ„æ€æ˜¯è¯´ï¼Œç”±let/constå£°æ˜çš„å˜é‡ï¼Œå½“å®ƒä»¬åŒ…å«çš„è¯æ³•ç¯å¢ƒå®ä¾‹åŒ–æ—¶ï¼Œæ‰ä¼šè¢«åˆ›å»ºï¼›ä¸”åªæœ‰åœ¨å˜é‡çš„è¯æ³•ç»‘å®šå·²ç»è¢«èµ‹å€¼åï¼Œæ‰èƒ½è¢«è®¿é—®ï¼ˆä½¿ç”¨ï¼‰ã€‚ è¿™æ®µè¯è¯¦ç»†åœ°è¯´ï¼Œå°±æ˜¯åœ¨ç¨‹åºåœ¨å…¶è¯æ³•ç¯å¢ƒï¼ˆä¹Ÿå°±æ˜¯å…¶å¯¹åº”çš„ä½œç”¨åŸŸï¼Œæ¯”å¦‚æ¨¡å—ï¼Œå‡½æ•°ï¼Œå—çº§ä½œç”¨åŸŸç­‰ï¼‰å°±è¡Œå®ä¾‹åŒ–çš„æ—¶å€™ï¼Œï¼ˆlet/constå£°æ˜çš„ï¼‰å˜é‡å°±å·²ç»è¢«åˆ›å»ºäº†ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™è¿˜ä¸èƒ½è¢«è®¿é—®ï¼ˆæ­¤æ—¶è®¿é—®ä¼šå‡ºç°not definedï¼‰ï¼Œåªæœ‰å½“è¿™ä¸ªå˜é‡çš„è¯æ³•ç»‘å®šè¢«èµ‹å€¼åï¼Œæ‰èƒ½è¿›è¡Œè®¿é—®è¿™ä¸ªå˜é‡ï¼Œä¹Ÿå°±æ˜¯è¯´å½“è¿™ä¸ªå˜é‡è¢«èµ‹å€¼åï¼Œæ‰èƒ½æ­£å¸¸è®¿é—®ã€‚æ‰€ä»¥åœ¨å˜é‡åˆ›å»ºåˆ°å˜é‡èµ‹å€¼è¿™ä¸€æ®µæ—¶é—´å†…ï¼Œè®¿é—®æ—¶ä¼šæŠ¥é”™ï¼Œè¿™æ®µæ—¶é—´å°±å«åšTDZï¼ˆæš‚æ—¶æ­»åŒºï¼‰ã€‚ å› æ­¤ï¼Œä»ä¸Šé¢çœ‹æ¥ï¼Œä¼¼ä¹let/constå£°æ˜çš„å˜é‡ï¼Œè¿˜æ˜¯æœ‰å˜é‡æå‡ï¼ˆhoistï¼‰çš„ä½œç”¨çš„ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯ä¼šè®©å¾ˆå¤šäººè¯¯è§£çš„åœ°æ–¹ï¼Œå®é™…ä¸Šï¼ŒJSä¸­çš„å˜é‡éƒ½æœ‰å˜é‡æå‡ï¼Œè¿™æ˜¯JSè¯­è¨€ä¸­ï¼Œå˜é‡çš„åŸºæœ¬ç‰¹æ€§ï¼Œbutï¼Œå› ä¸ºTDZçš„ä½œç”¨ï¼Œæ‰€ä»¥let/constçš„å˜é‡æå‡å¹¶æ²¡æœ‰åƒvaré‚£æ ·æ˜æ˜¾åœ°å¾—åˆ°undefinedï¼Œè€Œæ˜¯ä¼šç›´æ¥æŠ¥é”™ï¼šnot definedï¼›è€Œä¸”è¿™å¾ˆæ˜æ˜¾æ˜¯ä¸€ä¸ªè¿è¡ŒæœŸé—´æ‰ä¼šå‡ºç°çš„é—®é¢˜ã€‚ æ‰€ä»¥ä¸Šé¢æåˆ°çš„é‚£ä¸ªä¾‹å­å°±å·²ç»è¯´æ˜äº†letä¹Ÿæœ‰å˜é‡æå‡ï¼Œæˆ‘ä»¬å†æ¥åˆ†æä¸€ä¸‹è¿™ä¸ªä¾‹å­ã€‚ 123456let e = 12;(function()&#123;// TDZ startconsole.log(e);let e = 123; // TDZ end&#125;)() åœ¨è¿™ä¸ªIIFEå‡½æ•°ä¸­ï¼Œæœ¬æ¥console.logçš„æ—¶å€™ï¼Œåº”è¯¥ç°åœ¨å‡½æ•°å†…éƒ¨æ‰¾ï¼Œæ‰¾ä¸åˆ°çš„è¯å†å¾€å¤–é¢æ‰¾ï¼›å¯æ˜¯ç”±äºä¸‹é¢ï¼Œeåˆè¢«åœ¨è¿™ä¸ªå‡½æ•°å†…é‡æ–°å®šä¹‰èµ‹å€¼äº†ï¼Œè™½ç„¶æ˜¯åœ¨console.logä¸‹é¢ï¼Œä½†æ˜¯ç”±äºæ˜¯æœ‰å˜é‡æå‡çš„ï¼Œæ‰€ä»¥åœ¨å¯¹åº”çš„ä½œç”¨åŸŸé¡¶ç«¯ï¼ˆä¹Ÿå°±æ˜¯è¿™ä¸ªIIFEå‡½æ•°çš„é¡¶ç«¯ï¼‰ï¼Œæ˜¯TDZ startï¼Œç„¶åç›´åˆ°è¿™ä¸ªå˜é‡è¢«èµ‹å€¼ï¼Œæ‰æ˜¯TDZ endï¼Œè¿™ä¸­é—´çš„åŒºåŸŸå°±å«åšTDZï¼›å› æ­¤ï¼Œåœ¨consoleçš„æ—¶å€™ç”±äºå†…éƒ¨åˆå£°æ˜äº†å˜é‡eï¼Œæ‰€ä»¥åœ¨å†…éƒ¨æ‰¾åˆ°äº†å˜é‡eäºæ˜¯å°±ä¸ç”¨ç»§ç»­å¾€å¤–é¢æ‰¾äº†ï¼Œå› æ­¤ä¸ä¼šè¾“å‡º12ï¼Œåˆå› ä¸ºconsoleçš„åŒºåŸŸåˆšå¥½å¤„åœ¨TDZçš„åŒºåŸŸå†…ï¼Œæ‰€ä»¥å°±ç®—å˜é‡eè¢«å£°æ˜äº†ï¼Œå¯æ˜¯ç”±äºTDZçš„å­˜åœ¨ï¼Œåœ¨å˜é‡è¢«èµ‹å€¼ä¹‹å‰æš‚æ—¶è¿˜ä¸èƒ½è®¿é—®ï¼Œæ‰€ä»¥æ­¤æ—¶è®¿é—®ä¼šå‡ºç°æŠ¥é”™â€œnot definedâ€ã€‚ åœ¨ES6ä¸­çš„letä¸constå£°æ˜ç« èŠ‚çš„åé¢å‡ å¥ï¼Œè¯´æ˜äº†æœ‰å…³å˜é‡æ˜¯å¦‚ä½•è¿›è¡Œåˆå§‹åŒ–çš„ï¼š 1A variable defined by a LexicalBinding with an Initializer is assigned the value of its Initializerâ€™s AssignmentExpression when the LexicalBinding is evaluated, not when the variable is created. If a LexicalBinding in a let declaration does not have an Initializer the variable is assigned the value undefined when the LexicalBinding is evaluated. è¿™å‡ å¥æ˜¯å…³äºå˜é‡åˆå§‹åŒ–çš„è¿‡ç¨‹çš„ã€‚ä»¥let/constæ‰€å£°æ˜çš„å˜é‡ï¼ˆconstå£°æ˜çš„å˜é‡å«åšå›ºå®šçš„å˜é‡ï¼‰ï¼Œå¿…é¡»æ˜¯ç»è¿‡å£°æ˜çš„èµ‹å€¼è¯­å¥çš„æ±‚å€¼åï¼Œæ‰ç®—åˆå§‹åŒ–å®Œæˆï¼Œè€Œä¸æ˜¯åˆ›å»ºåå°±åˆå§‹åŒ–å®Œæˆã€‚let/varå£°æ˜è¿‡åå¦‚æœæ²¡æœ‰èµ‹äºˆåˆå§‹å€¼ï¼Œé‚£ä¹ˆä¼šèµ‹å€¼ä¸ºundefinedï¼Œä½†æ˜¯constä¸è¡Œï¼Œconstå£°æ˜äº†å˜é‡åä¸€å®šéœ€è¦èµ‹åˆå§‹å€¼çš„ã€‚åˆå§‹åŒ–å®Œæˆåæ‰ä»£è¡¨TDZçš„çœŸæ­£ç»“æŸï¼Œè¿™äº›åœ¨ä½œç”¨åŸŸä¸­è¢«å£°æ˜çš„å˜é‡æ‰èƒ½è¢«æ­£å¸¸çš„è®¿é—®ã€‚ ä¸‹é¢çš„ç¤ºä¾‹æ˜¯ä¸€ä¸ªæœªåˆå§‹åŒ–å®Œæˆçš„ç»“æœï¼Œå®ƒè¿˜åœ¨TDZä¸­ï¼Œæ‰€ä»¥ä¼šå‘ç”Ÿé”™è¯¯ï¼Œâ€œx is not definedâ€ã€‚ 1let x = x; å› ä¸ºç­‰å·å³è¾¹çš„xï¼Œå®ƒåœ¨æ­¤æ—¶è¿˜æ˜¯ä¸€ä¸ªæœªè¢«åˆå§‹åŒ–å®Œæˆçš„å˜é‡ï¼Œå®é™…ä¸Šæˆ‘ä»¬å°±åœ¨è¿™åŒä¸€ä¸ªè¡¨è¾¾å¼ä¸­è¦åˆå§‹åŒ–å®ƒã€‚ å‡½æ•°ä¼ å‚é¢„è®¾å€¼TDZä½œç”¨åœ¨ES6ä¸­ï¼Œå¾ˆæ˜ç¡®çš„å°±æ˜¯ä¸åŒºå—ä½œç”¨åŸŸ(block scope)ï¼Œä»¥åŠå˜é‡/å¸¸é‡çš„è¦å¦‚ä½•è¢«åˆå§‹åŒ–æœ‰å…³ã€‚å®é™…ä¸Šåœ¨è®¸å¤šES6æ–°ç‰¹æ€§ä¸­éƒ½æœ‰å‡ºç°TDZä½œç”¨ï¼Œè€Œå¦ä¸€ä¸ªå¸¸ä¼šè¢«æåŠçš„æ˜¯å‡½æ•°çš„ä¼ å‚é¢„è®¾å€¼ä¸­çš„TDZä½œç”¨ã€‚ ç›´æ¥ä¸Šç¤ºä¾‹æŠŠï¼Œçœ‹ä¸‹é¢çš„ä»£ç ã€‚ 123456789function foo(x=y,y=1)&#123; console.log(y)&#125;foo(1) // è¿™ä¸ä¼šæœ‰é”™è¯¯foo(undefined, 1) // é”™è¯¯ ReferenceError: y is not definedfoo() // é”™è¯¯ ReferenceError: y is not defined ä¸Šé¢è¿™äº›æŠ¥é”™çš„ä¸»è¦åŸå› æ˜¯åœ¨å‡½æ•°å£°æ˜æ—¶ä¼ å…¥çš„å½¢å‚åˆå§‹åŒ–çš„è¿™é‡Œï¼Œx=y,y=1å¯ä»¥çœ‹æˆlet x=y,let y=1ï¼Œè¿™æ ·åº”è¯¥å°±ä¼šæ¸…æ™°å¾ˆå¤šã€‚ å½“ç„¶ï¼Œå¯¹äºä¼ å‚é¢„è®¾å€¼çš„ä½œç”¨åŸŸï¼Œä¹Ÿæ˜¯ä½œç”¨åŸŸè¯é¢˜é‡Œä¸€ä¸ªå¸¸è¢«è®¨è®ºçš„è¯é¢˜ï¼Œè®¨è®ºè¿™åˆ°åº•æ˜¯å±äºâ€œå…¨å±€ä½œç”¨åŸŸâ€è¿˜æ˜¯â€œå‡½æ•°ä¸­çš„ä½œç”¨åŸŸâ€ï¼ŒæŠ‘æˆ–æ˜¯å¤„äºè¿™ä¸¤è€…ä¹‹é—´çš„â€œä¸­ä»‹åŒºåŸŸâ€ï¼Ÿç°åœ¨çœ‹åˆ°æ¯”è¾ƒå¸¸è§çš„ä¸€ç§è¯´æ³•å°±æ˜¯ï¼Œå®ƒæ˜¯å¤„äºâ€œä¸­ä»‹çš„ä½œç”¨åŸŸâ€ï¼Œå¤¹åœ¨è¿™ä¸¤è€…ä¹‹é—´ï¼Œä»ç„¶ä¼šä¸å…¶å®ƒä½œç”¨åŸŸç›¸äº’å½±å“ã€‚ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„ç¤ºä¾‹å°±æ˜¯ï¼Œä½¿ç”¨å…¶å®ƒå‡½æ•°ä½œä¸ºä½œä¸ºä¼ å‚çš„é¢„è®¾å€¼ï¼Œè¿™é€šå¸¸ä¼šæ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æœ¬æ²¡ä»€ä¹ˆï¼Œä½†æ˜¯æ¶‰åŠåˆ°ä½œç”¨åŸŸç›¸äº’å½±å“çš„æ—¶å€™ï¼Œå°±ä¼šæ¯”è¾ƒéš¾ä»¥ç†è§£ï¼Œæ¯”å¦‚è¿™ä¸ªç¤ºä¾‹ï¼Œæˆ‘å°†å®ƒå¤§è‡´çš„æ•´ç†äº†ä¸€ä¸‹ã€‚ 123456789101112let x = 1;function foo(a = 1, b=function()&#123;x = 2;&#125; )&#123; let x = 3; b(); console.log(x);&#125;foo();console.log(x); ä¸Šé¢è¿™ä¸ªä¾‹å­ï¼Œæœ€åä¼šè¾“å‡ºä»€ä¹ˆå‘¢ï¼Ÿ è¿™é‡Œæœ‰ä¸¤ä¸ªconsoleï¼Œé‡Œé¢å¤–é¢å„ä¸€ä¸ªï¼Œæ‰€ä»¥ä¼šè¾“å‡ºä¸¤ä¸ªå€¼ï¼Œé‡Œé¢çš„xçš„å€¼æ˜¯å¤šå°‘ï¼Œè¦çœ‹ä½œç”¨åŸŸä¹‹é—´ç›¸äº’çš„å½±å“ï¼Œè€Œå¤–é¢çš„xçš„å€¼ï¼Œè¦çœ‹æœ€å¤–å›´çš„ä½œç”¨åŸŸæœ€åä¼šä¸ä¼šè¢«æ”¹å˜ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ ä¸‹é¢æ¥è¯¦ç»†åˆ†è§£ä¸€ä¸‹ï¼Œå‡½æ•°fooä¸­çš„xï¼Œå€¼å¯èƒ½æ˜¯2ï¼Œä¹Ÿå¯èƒ½æ˜¯3ï¼Œè‚¯å®šä¸æ˜¯1ï¼Œè¿™ä¸ªå¯ä»¥ç†è§£å§ï¼›è€Œå‡½æ•°å¤–é¢çš„é‚£ä¸ªxï¼Œå€¼å¯èƒ½æ˜¯1ï¼Œä¹Ÿå¯èƒ½æ˜¯2ï¼Œç»ä¸å¯èƒ½æ˜¯3ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥ç†è§£å§ã€‚ å…·ä½“ç­”æ¡ˆæ˜¯å¤šå°‘ï¼Ÿæˆ‘ä¸çŸ¥é“ï¼Œæˆ–è€…è¯´æ²¡æœ‰å…·ä½“ç­”æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥åˆ†åˆ«ç”¨æµè§ˆå™¨å’Œç¼–è¯‘å™¨æ¥è¿è¡Œä¸€ä¸‹ä»£ç è¯•è¯•ï¼šchromeä¸‹é¢ä¼šåˆ†åˆ«è¾“å‡º3å’Œ2ï¼Œfirefoxä¸‹é¢ä¼šåˆ†åˆ«è¾“å‡º2å’Œ1ï¼Œç„¶åæˆ‘å°±æ„Ÿåˆ°å¥‡æ€ªï¼Œå†ä½¿ç”¨Edgeæ¥è¯•è¯•ï¼Œç»“æœå‘ç°ä¼šè¾“å‡º3ä¸2ï¼Œæœ€åå†ä½¿ç”¨è‘—åçš„babelç¼–è¯‘å™¨ï¼Œå¾—å‡ºçš„ç»“æœæ˜¯2ä¸1ï¼Œæš‚æ—¶çœ‹æ¥ï¼Œç»“æœåº”è¯¥æœ‰2ä¸ªï¼Œ3ä¸2æˆ–è€…2ä¸1ï¼Œæˆ‘ä»¬åˆ†åˆ«æ¥åˆ†æä¸€ä¸‹è¿™ä¸¤ä¸ªç­”æ¡ˆå§ï¼Œçœ‹çœ‹æ˜¯ä»€ä¹ˆé—®é¢˜è®©æµè§ˆå™¨éƒ½æ²¡æœ‰ç»Ÿä¸€çš„ç­”æ¡ˆã€‚ å½“ç»“æœæ˜¯3ä¸2çš„æ—¶å€™ï¼Œè¯´æ˜bå‡½æ•°ä¸­çš„x=2è¿è¡Œäº†å‡ºæ¥ï¼Œä½†æ˜¯ç”±äºä¸­ä»‹ä½œç”¨åŸŸçš„å½±å“ï¼Œæ‰€ä»¥å¹²æ‰°ä¸åˆ°å‡½æ•°ä¸­åŸæœ¬çš„åŒºå—ä½œç”¨åŸŸï¼Œä½†æ˜¯ç›´æ¥æ”¹å˜äº†å…¨å±€xçš„å€¼ã€‚ä¹Ÿå°±æ˜¯å‡ æœ¬è®¤ä¸ºäº†å‡½æ•°é¢„è®¾å€¼ä¸­çš„é‚£ä¸ªå‡½æ•°ä¸­çš„ä½œç”¨åŸŸä¸å…¨å±€ï¼ˆæˆ–è€…è¯´æ˜¯å‡½æ•°å¤–å±‚ï¼‰æœ‰å½±å“ã€‚ å½“ç»“æœæ˜¯2ä¸1çš„æ—¶å€™ï¼Œå°±å€’è¿‡æ¥ï¼Œä¸­ä»‹ä½œç”¨åŸŸå½±å“äº†å‡½æ•°å†…å±‚çš„ä½œç”¨åŸŸï¼Œè€Œæ²¡æœ‰å½±å“å¤–å±‚çš„ä½œç”¨åŸŸã€‚ å› æ­¤ï¼Œåªæœ‰å½“ä¸­ä»‹ä½œç”¨åŸŸæœ‰è‡ªå·±ç‹¬ç«‹çš„ä½œç”¨åŸŸçš„æ—¶å€™ï¼Œå®Œå…¨ä¸å‡½æ•°åŒºå—ä¸­çš„ä½œç”¨åŸŸä»¥åŠå‡½æ•°å¤–å±‚ä¸­çš„ä½œç”¨åŸŸæ¯«ä¸ç›¸å¹²çš„æ—¶å€™ï¼Œé‚£è¿™ä¸ªæ—¶å€™å°±ä¼šè¾“å‡º3ä¸1ï¼Œå¾ˆé—æ†¾ï¼Œç°åœ¨éƒ½æ˜¯3ä¸2æˆ–è€…2ä¸1ï¼Œçœ‹æ¥ä¸­ä»‹ä½œç”¨åŸŸè¿˜æ˜¯å’Œå‡½æ•°å¤–å±‚ï¼ˆæˆ–è€…å†…å±‚ç›¸å…³çš„ï¼‰ï¼Œè‡³äºå…·ä½“æ˜¯å¤–å±‚éŸ©è¿˜æ˜¯å†…å±‚ï¼Œè¿™ä¸ªé—®é¢˜ç°åœ¨è¿˜æ²¡æœ‰ä¸€ä¸ªæ˜ç¡®çš„ç»“æœå§ï¼Œå¦åˆ™å„ç§æµè§ˆå™¨çš„è¾“å‡ºä¹Ÿå°±ä¸ä¼šæœ‰å·®å¼‚äº†ï¼Œä¸åªè¿™ä¸€ä¸ªé—®é¢˜ï¼Œchromeå’Œfirefoxçš„å·®å¼‚è¿˜æœ‰å…¶å®ƒï¼Œè¿™é‡Œå°±ä¸ç»†è®²äº†ã€‚ ä¸ç®¡å¦‚ä½•ï¼Œè¿™ä¸ªä½œç”¨åŸŸçš„å½±å“ä»ç„¶æ˜¯æœ‰äº‰è®®çš„ï¼Œç›®å‰å¹¶æ²¡æœ‰ç»Ÿä¸€çš„ç­”æ¡ˆã€‚è¿™ä»£è¡¨ES6è™½ç„¶æ ‡å‡†å®šå¥½äº†ï¼Œä½†é‡Œé¢çš„ä¸€äº›æ–°ç‰¹æ€§ä»ç„¶æœ‰å®ä½œç»†èŠ‚çš„å·®å¼‚ï¼Œæœªæ¥æœ‰å¯èƒ½è¿™äº›å·®å¼‚æ‰ä¼šæ…¢æ…¢ä¸€è‡´ã€‚ä½†å¯¹ä¸€èˆ¬çš„å¼€å‘è€…æ¥è¯´ï¼Œå› ä¸ºçŸ¥é“äº†æœ‰è¿™äº›æƒ…å†µï¼Œæ‰€ä»¥è¦å°½é‡é¿å…ï¼Œä»¥å…äº§ç”Ÿä¸å¿…è¦çš„éº»çƒ¦ã€‚ TDZçš„å…¶å®ƒé™·é˜±typeofè¯­å¥1234567// ä¸€èˆ¬æ¥è¯´ï¼Œtypeof ä¸€ä¸ªæœªå®šä¹‰çš„æ•°æ®ï¼Œéƒ½æ˜¯undefinedï¼Œå› æ­¤typeofä¹Ÿå¯ä»¥ä½œä¸ºåˆ¤æ–­å˜é‡æ˜¯å¦å­˜åœ¨ï¼ˆè¢«èµ‹å€¼ï¼‰çš„ä¸€ç§æ–¹æ³•ï¼Œé‚£æ˜¯å› ä¸ºä¹‹å‰æ²¡æœ‰letå’Œconstã€‚typeof a; // undefinedtypeof b; // b is not definedlet b=1; ç°åœ¨typeofä¹Ÿå˜å¾—ä¸å®‰å…¨äº†ï¼Œä½ ä¸èƒ½éšæ„çš„å¯¹å˜é‡ä½¿ç”¨typeofæ“ä½œï¼Œå› ä¸ºç°åœ¨ä¼šæœ‰æŠ¥é”™çš„é£é™©ï¼Œä¼šå˜æˆä¸€ä¸ªé™·é˜±ï¼Œç”±äºTDZçš„è®¾è®¡ï¼Œä½¿å¾—å˜é‡æœ¬å°±ä¸è¯¥åœ¨å£°æ˜å‰è¢«è®¿é—®ã€‚ TDZæœŸé—´æŠ›å‡ºçš„é”™è¯¯æ˜¯è¿è¡Œé˜¶æ®µçš„é”™è¯¯TDZæœŸé—´çš„é”™è¯¯ï¼Œå…¨éƒ¨æ˜¯è¿è¡Œé˜¶æ®µæ‰ä¼šå‘ç”Ÿçš„é”™è¯¯ï¼Œå› ä¸ºå®ƒéœ€è¦å˜é‡ï¼å¸¸é‡åˆå§‹åŒ–çš„è¿‡ç¨‹ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ‰ä¼šåˆ›å»ºå‡ºTDZï¼Œä¸”çœŸæ­£è¿è¡Œåˆ°é‚£é‡Œï¼Œè°ƒç”¨åˆ°å‡½æ•°è¿è¡Œé‡Œé¢çš„ä»£ç æ—¶ï¼Œæ‰ä¼šTDZç›¸å…³çš„é”™è¯¯æ‰ä¼šè¢«æŠ›å‡ºã€‚ ä¸ç”¨let/const ï¼Ÿå…¶å®æ²¡é”™ï¼Œåªè¦ä½ å£°æ˜å˜é‡çš„æ—¶å€™ï¼Œä¸ç®¡å±€éƒ¨è¿˜æ˜¯å…¨éƒ¨ï¼Œå…¨éƒ¨ä½¿ç”¨varï¼Œé‚£ä¹ˆä½ å°±æ ¹æœ¬ä¸ç”¨å…³å¿ƒTDZã€‚ å¯æ˜¯ï¼Œåœ¨æµè§ˆå™¨ä¸Šçš„è¿è¡Œæ•ˆèƒ½æ¥çœ‹ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œletæ•ˆèƒ½æ¯”varå¼ºï¼Œä¸”ä¼šæœ‰å—çº§ä½œç”¨åŸŸçš„æ¦‚å¿µï¼Œè¿™ä¼šå‡å°‘å› ä¸ºå±€éƒ¨å˜é‡ï¼å…¨å±€å˜é‡æ‰€å¼•èµ·çš„é—®é¢˜ï¼Œè€Œä¸”letå¯¹å˜é‡æœ‰äº†æ›´é«˜çš„è¦æ±‚ä¸æ ‡å‡†ï¼Œæ¯”å¦‚ä¸å…è®¸æœªå®šä¹‰å°±ä½¿ç”¨ï¼›ä¸å…è®¸é‡å¤å®šä¹‰ç­‰ã€‚ã€‚ã€‚","tags":[]},{"title":"reduxæºç è§£è¯»","date":"2017-01-16T10:01:41.000Z","path":"2017/01/16/reduxæºç è§£è¯»/","text":"è¿™æ˜¯2017å¹´çš„ç¬¬ä¸€ç¯‡åšå®¢ï¼Œä¸Šå‘¨å‚åŠ å®Œå„ç§å¹´ä¼šèšä¼šï¼Œæœ¬æ¥å‡†å¤‡å‘¨æœ«å†™çš„ï¼Œå¯æ˜¯å‘¨æœ«åˆçªç„¶æœ‰äº‹ï¼Œæ‰€ä»¥ä¸€ç›´æ‹–åˆ°ç°åœ¨ï¼Œè€Œä¸”è¿™æ˜¯2017çš„ç¬¬ä¸€ç¯‡æŠ€æœ¯åšå®¢ï¼Œæ‰€è°“å¥½çš„å¼€å§‹æ˜¯æˆåŠŸçš„ä¸€åŠï¼Œå¸Œæœ›æ–°çš„ä¸€å¹´ï¼Œè‡ªå·±å¯ä»¥ç»§ç»­åšæŒï¼Œå˜å¾—æ›´å¥½ã€‚ reduxå…¶å®æˆ‘å·¥ä½œé¡¹ç›®ä¸­æ¥è§¦çš„reduxå¹¶ä¸å¤šï¼Œåº”è¯¥è¯´åªæœ‰ä¸€ä¸¤ä¸ªé¡¹ç›®ç”¨åˆ°äº†reduxï¼Œè¦æ±‚ä¹Ÿæ˜¯åŸºæœ¬çš„reduxçš„ä½¿ç”¨ï¼Œdispatchä¸€ä¸ªactionè¿™ç§ç¨‹åº¦ï¼Œreact-reduxä¹Ÿè¿˜æ²¡æœ‰æ¶‰åŠåˆ°ï¼Œå¯èƒ½æ˜¯é¡¹ç›®çš„å¤æ‚ç¨‹åº¦ä¸å¤Ÿå¤§å§ï¼Œæ‰€ä»¥æ¶‰åŠåˆ°reduxçš„ç›¸å…³æŠ€æœ¯ç°åœ¨éƒ½æ˜¯é è‡ªå­¦ï¼ˆå”‰ï¼Œç°åœ¨å…¬å¸PHPè¿ç§»åˆ°JAVAï¼Œä¸šåŠ¡å‹åŠ›è¿™ä¹ˆé‡ï¼Œå“ªæœ‰æ—¶é—´è‡ªå­¦å•Šï¼Œè¿ç¤ºä¾‹éƒ½æ²¡çœ‹å®Œï¼Œå›§2333ï½ï¼‰ã€‚ åæ§½å®Œæ¯•ï¼Œå›åˆ°æ­£é¢˜ä¸Šæ¥å§ï¼Œå­¦ä¹ ä¸€ä¸ªåº“å’Œæ¡†æ¶æœ€å¥½çš„æ–¹æ³•å°±æ˜¯ç›´æ¥çœ‹æºç ï¼Œçœ‹æºç å¥½å¤„æœ‰å¾ˆå¤šï¼Œä¸ä»…ä»…æ˜¯å­¦ä¹ APIï¼Œè¿˜å¯ä»¥å­¦ä¹ åˆ«äººç¼–å†™è¿™ä¸ªåº“ï¼ˆæ¡†æ¶ï¼‰çš„æ€æƒ³ï¼Œè¿™æ‰æ˜¯æœ€ä¸ºé‡è¦çš„ï¼Œæ‰€ä»¥è¿™æ¬¡æ¥å†™ä¸€ç¯‡reduxæºç ç›¸å…³çš„åšå®¢ã€‚ reduxæºç è§£è¯»å…ˆæŠŠreduxä¸‹è½½ä¸‹æ¥ï¼Œå‘ç°å¾ˆå°ï¼Œä¸”æ²¡æœ‰ä¾èµ–å…¶ä»–ç¬¬ä¸‰æ–¹åº“ï¼Œç®€ç›´æ˜¯çŸ­å°ç²¾æ‚å•Šï¼Œä¸‹é¢å°±è®©æˆ‘å¥½å¥½è§è¯†ä¸‹é‡Œé¢çš„æ€æƒ³ã€‚ æˆ‘ä»¬ç›´æ¥çœ‹åˆ°srcæ–‡ä»¶å¤¹ä¸‹ï¼Œå‘ç°ä¸‹é¢ä¸€å…±æœ‰ä¸ƒä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«æ˜¯utilsï¼ŒapplyMiddleware.jsï¼ŒbindActionCreators.jsï¼ŒcombineReducers.jsï¼Œcompose.jsï¼ŒcreateStore.jsï¼Œindex.jsã€‚æˆ‘ä»¬åˆ†åˆ«æ¥çœ‹çœ‹ã€‚ utilsè¿™ä¸ªæ˜¯å…¬ç”¨çš„å·¥å…·æ–¹æ³•ï¼Œé‡Œé¢å°±warning.jsä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰“å¼€æ–‡ä»¶å¯ä»¥çœ‹åˆ°ï¼Œé‡Œé¢å°±ä¸€ä¸ªwarningå‡½æ•°ã€‚ 12345678export default function warning(message) &#123; if (typeof console !== &apos;undefined&apos; &amp;&amp; typeof console.error === &apos;function&apos;) &#123; console.error(message) &#125; try &#123; throw new Error(message) &#125; catch (e) &#123; &#125;&#125; è¿™ä¸ªå‡½æ•°çš„ä¸»è¦ç›®çš„å°±æ˜¯æŠ›å‡ºå¼‚å¸¸ï¼ˆé”™è¯¯ï¼‰ï¼Œè¿™ä¸ªåº”è¯¥æ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚ index.jsæ¥ä¸‹æ¥çœ‹çœ‹index.jsæ–‡ä»¶ï¼Œè¿™ç§æ–‡ä»¶çš„ä¸»è¦ç›®çš„ä¸€èˆ¬æ˜¯ä½œä¸ºå…¥å£æ–‡ä»¶ï¼Œé‡Œé¢ä»£ç ä¹Ÿä¸å¤šã€‚ 1234567891011121314151617181920212223function isCrushed() &#123;&#125;if ( process.env.NODE_ENV !== &apos;production&apos; &amp;&amp; typeof isCrushed.name === &apos;string&apos; &amp;&amp; isCrushed.name !== &apos;isCrushed&apos;) &#123; warning( &apos;You are currently using minified code outside of NODE_ENV === \\&apos;production\\&apos;. &apos; + &apos;This means that you are running a slower development build of Redux. &apos; + &apos;You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify &apos; + &apos;or DefinePlugin for webpack (http://stackoverflow.com/questions/30030031) &apos; + &apos;to ensure you have the correct code for your production build.&apos; )&#125;export &#123; createStore, combineReducers, bindActionCreators, applyMiddleware, compose&#125; é¦–å…ˆçœ‹åˆ°ä¸€ä¸ªç©ºå‡½æ•°isCrushedï¼Œåé¢è·Ÿäº†ä¸€ä¸ªifåˆ¤æ–­ï¼Œç¬¬ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶æ˜¯process.env.NODE_ENV !== â€˜productionâ€™ï¼Œæˆ‘è®°å¾—processæ˜¯nodeé‡Œçš„ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œç„¶åæˆ‘å»nodeç¯å¢ƒæ‰¾äº†ä¸‹process.env.NODE_ENVï¼Œå‘ç°undefinedï¼Œè¯´æ˜æœ¬èº«æ˜¯æ²¡æœ‰è¿™ä¸ªå‚æ•°çš„ï¼Œè°·æ­Œäº†ä¸€ä¸‹ï¼Œå‘ç°è¿™æ˜¯nodeçš„ç¯å¢ƒå˜é‡ï¼Œå¦‚æœprocess.env.NODE_ENV == â€˜productionâ€™ï¼Œåˆ™è¡¨ç¤ºç”Ÿäº§ç¯å¢ƒï¼Œå…·ä½“å‚è€ƒåœ°å€åœ¨è¿™é‡Œã€‚è¿™æ˜¯ç¬¬ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶ï¼Œè€Œåé¢ä¸¤ä¸ªåˆ¤æ–­æ¡ä»¶éƒ½æ˜¯åˆ¤æ–­æ–‡ä»¶ä»£ç æ˜¯å¦è¢«å‹ç¼©ï¼Œå› ä¸ºå¦‚æœè¢«å‹ç¼©äº†ï¼Œé‚£ä¹ˆisCrushedå‡½æ•°å°±ä¸å«isCrushedå‡½æ•°äº†ï¼ŒåŒæ—¶æµè§ˆå™¨å‘å‡ºè­¦å‘Šã€‚æœ€åexportä¸€å †æ¥å£ï¼Œåˆ†åˆ«æ˜¯createStore,combineReducers,bindActionCreators,applyMiddleware,composeè¿™äº”ä¸ªã€‚ createStoreè¿™åº”è¯¥æ˜¯reduxä¸»è¦çš„ä¸€ä¸ªå‡½æ•°ï¼Œä¸å¯¹ï¼Œåº”è¯¥æ˜¯æœ€ä¸»è¦çš„ï¼Œé¡¾åæ€ä¹‰ï¼ŒcreateStoreçš„æ„æ€å°±æ˜¯åˆ›å»ºstoreï¼Œè€Œä¸€ä¸ªåº”ç”¨ä¸­åªæœ‰å”¯ä¸€çš„ä¸€ä¸ªstoreï¼Œä½ è¯´è¿™èƒ½ä¸é‡è¦å—ï¼Ÿ åºŸè¯ä¸å¤šè¯´ï¼Œå…ˆçœ‹ä»£ç å§ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182// é¦–å…ˆå°±å®šä¹‰äº†ä¸€ä¸ª ActionTypes å¯¹è±¡ï¼Œå®ƒæ˜¯ä¸€ä¸ªactionï¼Œæ˜¯ä¸€ä¸ªReduxçš„ç§æœ‰actionï¼Œä¸å…è®¸å¤–ç•Œè§¦å‘ï¼Œä½ å¯ä»¥åœ¨è¿™æ®µä»£ç çš„æœ€åé¢å‘ç°è¿™ä¸ªactionå°±æ˜¯åˆå§‹åŒ–æ—¶ï¼Œdispatchçš„actionï¼Œä¹Ÿå°±æ˜¯åˆå§‹åŒ–Storeçš„çŠ¶æ€æ ‘å’Œæ”¹å˜reducersååˆå§‹åŒ–Storeçš„çŠ¶æ€æ ‘ã€‚export var ActionTypes = &#123; INIT: &apos;@@redux/INIT&apos;&#125;// è¿™æ˜¯ä¸»å‡½æ•°ï¼ŒcreateStoreï¼Œå®ƒèƒ½å¤Ÿæ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œreduceræ˜¯å¿…é¡»çš„ï¼ŒpreloadedStateå’Œenhanceræ˜¯ä¸å¿…é¡»ï¼Œå…ˆæ¥è®²è®²å‚æ•°å§ï¼Œreducerå°±æ˜¯reduxé‡Œçš„å…¨å±€reducerï¼Œç›¸å½“äºä¸€ä¸ªå…¨å±€çš„å›è°ƒå‡½æ•°ï¼Œè¿”å›ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œæ¥å—ä¸¤ä¸ªå‚æ•°ï¼šå½“å‰çŠ¶æ€å’Œè§¦å‘çš„actionï¼ˆæˆ‘è‡ªå·±ç¼–çš„ï¼Œ2333ï½ï¼‰ï¼›preloadedStateè¡¨ç¤ºçš„æ˜¯åˆå§‹æ—¶çš„stateï¼Œæ¯”å¦‚æœåŠ¡ç«¯æ¸²æŸ“å¾—åˆ°çš„åˆå§‹çŠ¶æ€ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨combineReducersæ¥ç”Ÿæˆreducerï¼Œé‚£å¿…é¡»ä¿æŒçŠ¶æ€å¯¹è±¡çš„keyå’ŒcombineReducersä¸­çš„keyç›¸å¯¹åº”ï¼›è€Œenhanceræ˜¯storeçš„å¢å¼ºå™¨å‡½æ•°ï¼Œå¯ä»¥æŒ‡å®šä¸ºç¬¬ä¸‰æ–¹çš„ä¸­é—´ä»¶ï¼Œæ—¶é—´æ—…è¡Œï¼ŒæŒä¹…åŒ–ç­‰ç­‰ï¼Œä½†æ˜¯è¿™ä¸ªå‡½æ•°åªèƒ½ç”¨reduxæä¾›çš„applyMiddlewareå‡½æ•°æ¥ç”Ÿæˆã€‚ï¼ˆè¿™ä¸ªæˆ‘ä¸æ€ä¹ˆæ¸…æ¥šï¼Œä¹Ÿæ²¡æ€ä¹ˆç”¨è¿‡ã€‚ã€‚ã€‚ï¼‰export default function createStore(reducer, preloadedState, enhancer) &#123; // è¿™æ˜¯åˆ¤æ–­æ˜¯å¦æœ‰äººä¼ å…¥å‚æ•°é¡ºåºä¸å¯¹ï¼Œå¦‚æœæ˜¯çš„è¯è°ƒæ•´ä¸€ä¸‹å‚æ•°ä½ç½®ã€‚ if (typeof preloadedState === &apos;function&apos; &amp;&amp; typeof enhancer === &apos;undefined&apos;) &#123; enhancer = preloadedState preloadedState = undefined &#125; // enhanceråªå…è®¸ä¼ å…¥å‡½æ•° if (typeof enhancer !== &apos;undefined&apos;) &#123; if (typeof enhancer !== &apos;function&apos;) &#123; throw new Error(&apos;Expected the enhancer to be a function.&apos;) &#125; return enhancer(createStore)(reducer, preloadedState) &#125; // reduceræ˜¯å¿…å¡«çš„ if (typeof reducer !== &apos;function&apos;) &#123; throw new Error(&apos;Expected the reducer to be a function.&apos;) &#125; // åˆå§‹åŒ–å‚æ•°ï¼Œå°†å½“å‰çŠ¶æ€currentStateè®¾ç½®ä¸ºåˆå§‹çŠ¶æ€preloadedStateï¼Œåˆå§‹åŒ–æ—¶é—´ç›‘å¬å™¨æ•°ç»„ç­‰ã€‚ var currentReducer = reducer var currentState = preloadedState var currentListeners = [] var nextListeners = currentListeners var isDispatching = false function ensureCanMutateNextListeners() &#123; if (nextListeners === currentListeners) &#123; nextListeners = currentListeners.slice() &#125; &#125; // getStateæ–¹æ³•ï¼Œè¿”å›å½“å‰çš„çŠ¶æ€æ ‘currentStateã€‚ function getState() &#123; return currentState &#125; // subscribeå‡½æ•°ï¼Œæ˜¯ç»™çŠ¶æ€æ ‘æ·»åŠ ç›‘å¬å‡½æ•°ï¼Œæ¯å½“è°ƒç”¨dispatchçš„æ—¶å€™ï¼Œæ‰€æœ‰çš„ç›‘å¬å‡½æ•°å°±ä¼šæ‰§è¡Œã€‚ function subscribe(listener) &#123; // åˆ¤æ–­ä¼ å…¥å‚æ•°æ˜¯å¦ä¸ºå‡½æ•° if (typeof listener !== &apos;function&apos;) &#123; throw new Error(&apos;Expected listener to be a function.&apos;) &#125; var isSubscribed = true // nextListenersæ˜¯å½“å‰ç›‘å¬çš„äº‹ä»¶åˆ—è¡¨ï¼Œæ¯æ¬¡è°ƒç”¨subscribeçš„æ—¶å€™ï¼Œå°±ä¼šå‘nextListenersä¸­pushä¸€ä¸ªè¢«ç›‘å¬çš„å‡½æ•°ï¼Œå¹¶ä¸”å°†isSubscribedèµ‹å€¼ä¸ºtrueã€‚ ensureCanMutateNextListeners() nextListeners.push(listener) // è°ƒç”¨subscribeå‡½æ•°çš„æ—¶å€™ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªunsubscribeå‡½æ•°ï¼Œç”¨æ¥å–æ¶ˆç›‘å¬å‡½æ•°ï¼Œunsubscribeå‡½æ•°ä¼šå…ˆå°†isSubscribedçš„å€¼æ”¹ä¸ºfalseï¼ŒåŒæ—¶å°†è¿™ä¸ªå‡½æ•°ä»å½“å‰ç›‘å¬çš„äº‹ä»¶åˆ—è¡¨ï¼Œä¹Ÿå°±æ˜¯nextListenersä¸­å»é™¤æ‰ã€‚ return function unsubscribe() &#123; if (!isSubscribed) &#123; return &#125; isSubscribed = false ensureCanMutateNextListeners() var index = nextListeners.indexOf(listener) nextListeners.splice(index, 1) &#125; &#125; // dispatchå‡½æ•°ï¼Œä½œç”¨æ˜¯åˆ†å‘action function dispatch(action) &#123; // é¦–å…ˆåˆ¤æ–­actionæ ¼å¼ if (!isPlainObject(action)) &#123; throw new Error( &apos;Actions must be plain objects. &apos; + &apos;Use custom middleware for async actions.&apos; ) &#125; // actionä¸­typeå‚æ•°æ˜¯å¿…éœ€çš„ if (typeof action.type === &apos;undefined&apos;) &#123; throw new Error( &apos;Actions may not have an undefined &quot;type&quot; property. &apos; + &apos;Have you misspelled a constant?&apos; ) &#125; // åˆ¤æ–­æ˜¯å¦æ­£åœ¨dispatch if (isDispatching) &#123; throw new Error(&apos;Reducers may not dispatch actions.&apos;) &#125; // å¼€å§‹dispatchï¼Œå°†isDispatchingèµ‹å€¼ä¸ºtrueï¼Œç„¶åå°†currentStateå’Œactionä¼ ç»™reducerï¼Œå®Œæˆåå†å°†isDispatchingçš„å€¼æ”¹ä¸ºfalseã€‚ try &#123; isDispatching = true currentState = currentReducer(currentState, action) &#125; finally &#123; isDispatching = false &#125; // dispatchå®Œäº†åæ‰§è¡Œè¢«ç›‘å¬äº†çš„å‡½æ•°ï¼Œéå†å‡½æ•°åˆ—è¡¨nextListenersï¼Œåˆ†åˆ«æ‰§è¡Œé‡Œé¢çš„æ¯ä¸ªå‡½æ•°ï¼Œæœ€åä¼šè¿”å›è¿™ä¸ªactionã€‚ var listeners = currentListeners = nextListeners for (var i = 0; i &lt; listeners.length; i++) &#123; listeners[i]() &#125; return action &#125; // æ›´æ”¹reducerï¼Œä¼ å…¥ä¸€ä¸ªæ–°çš„reducerï¼Œå¹¶ä¸”é€šè¿‡åˆ†å‘åˆå§‹actionï¼Œæ¥åˆå§‹åŒ–æ›¿æ¢åreducerç”Ÿæˆçš„åˆå§‹åŒ–çŠ¶æ€å¹¶ä¸”èµ‹äºˆstoreçš„çŠ¶æ€ã€‚ function replaceReducer(nextReducer) &#123; // å®¹é”™åˆ¤æ–­ï¼Œreducerå¿…é¡»æ˜¯å‡½æ•°ï¼Œæ˜¯çš„è¯å°±ç”¨nextReduceræ›¿æ¢æ‰currentReducerï¼Œå†é‡æ–°dispatchä¸€ä¸‹åˆå§‹actionï¼Œåˆå§‹storeã€‚ if (typeof nextReducer !== &apos;function&apos;) &#123; throw new Error(&apos;Expected the nextReducer to be a function.&apos;) &#125; currentReducer = nextReducer dispatch(&#123; type: ActionTypes.INIT &#125;) &#125; function observable() &#123; var outerSubscribe = subscribe return &#123; subscribe(observer) &#123; if (typeof observer !== &apos;object&apos;) &#123; throw new TypeError(&apos;Expected the observer to be an object.&apos;) &#125; function observeState() &#123; if (observer.next) &#123; observer.next(getState()) &#125; &#125; observeState() var unsubscribe = outerSubscribe(observeState) return &#123; unsubscribe &#125; &#125;, [$$observable]() &#123; return this &#125; &#125; &#125; dispatch(&#123; type: ActionTypes.INIT &#125;) // æœ€åå°±æ˜¯è¿”å›è¿™äº›æ‰€æœ‰çš„å‡½æ•°ï¼Œä½œä¸ºæš´éœ²çš„æ¥å£ä½¿ç”¨ã€‚ return &#123; dispatch, subscribe, getState, replaceReducer, [$$observable]: observable &#125;&#125; ç»ˆäºæŠŠcreateStoreæ–‡ä»¶è§£è¯»å®Œäº†ï¼Œä¸‹é¢æ¥çœ‹çœ‹combineReducerså‡½æ•°ã€‚ combineReducers.jsreducerå‡½æ•°çš„ä½œç”¨æ˜¯å¾—åˆ°actionåç”Ÿæˆæ–°çš„stateï¼Œè€Œç”±äºä¸€ä¸ªappåªæ‹¥æœ‰ä¸€ä¸ªstateï¼Œæ‰€ä»¥è¿™ä¸ªstateè‚¯å®šæ˜¯æ¯”è¾ƒå¤æ‚ï¼Œæ•°æ®æ¯”è¾ƒå¤šçš„ï¼Œå› æ­¤è¿™ä¸ªå¯¹åº”çš„å¤„ç†ç”Ÿæˆstateçš„reducerè‚¯å®šä¹Ÿä¼šæ˜¯å¾ˆå¤æ‚çš„ï¼Œæ‰€ä»¥ä¸ºäº†é™ä½å¤æ‚åº¦ï¼Œä¹Ÿä¸ºäº†é€»è¾‘çš„è§£è€¦ï¼Œæˆ‘ä»¬ä¼šæŠŠè¿™ä¸ªå¤§çš„reduceræ‹†åˆ†æˆå¤šä¸ªå°çš„reducerï¼Œè€Œè¿™ä¸ªcombineReducerså‡½æ•°æ˜¯ä¸ºäº†æ•´åˆæ‰€æœ‰çš„å°çš„reducerï¼Œé‡æ–°å˜ä¸ºä¸€ä¸ªå¤§çš„reducerï¼Œè¿™å°±æ˜¯combineReducerså­˜åœ¨çš„åŸå› ï¼Œæœ¬æ¥æˆ‘æƒ³ç›´æ¥å°±æŠŠcombineReducersçš„æºç æ”¾ä¸Šæ¥çš„ï¼Œä¸è¿‡æˆ‘è§‰å¾—å¯ä»¥å…ˆä¸å¿™ï¼Œå…ˆå…·ä½“çš„è¯´ä¸€è¯´combineReducersåšçš„äº‹æƒ…ï¼Œä¸‹é¢è¿™æ®µè®²è§£å€Ÿé‰´äºé˜®ä¸€å³°çš„åšå®¢ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187// å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ–¹æ³•æœ‰ä¸€ä¸ªå‰æï¼Œå°±æ˜¯stateçš„å±æ€§åå¿…é¡»ä¸å­reduceråŒåconst reducer = combineReducers(&#123; doSomethingWithA, processB, c&#125;)// å¦‚æœä¸åŒåï¼Œåˆ™å¦‚ä¸‹const reducer = combineReducers(&#123; a: doSomethingWithA, b: processB, c: c&#125;)// ç­‰åŒäºfunction reducer(state = &#123;&#125;, action) &#123; return &#123; a: doSomethingWithA(state.a, action), b: processB(state.b, action), c: c(state.c, action) &#125;&#125;// ç„¶åä¸‹é¢æ˜¯ä¸€ä¸ªombineReducerså‡½æ•°çš„ç®€å•çš„å®ç°ï¼Œçœ‹å®Œäº†è¿™ä¸ªå†çœ‹æºç å§ã€‚const combineReducers = reducers =&gt; &#123; return (state = &#123;&#125;, action) =&gt; &#123; return Object.keys(reducers).reduce( (nextState, key) =&gt; &#123; nextState[key] = reducers[key](state[key], action); return nextState; &#125;, &#123;&#125; ); &#125;;&#125;;// å…¶å®è¿™ä¸ªç®€æ´ç‰ˆçš„combineReducersè¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“ç†è§£çš„ï¼Œä¸»è¦å°±æ˜¯å…ˆæ‹¿åˆ°reducersçš„keyï¼Œç„¶åé€šè¿‡reduceå‡½æ•°å°†åŸreducerçš„å„ä¸ªå‡½æ•°éå†ä¸€ä¸‹è¿”å›ä¸€ä¸ªæ–°çš„reducerså‡½æ•°ï¼Œå¾ˆç®€å•å§ï¼Œè‡³å°‘çœ‹åˆ°è¿™é‡Œï¼ŒcombineReducerså‡½æ•°çš„å¤§æ¦‚ä½œç”¨éƒ½æ˜¯å·²ç»æ˜ç™½äº†å§ï¼Œä¸‹é¢æˆ‘é—¨æ¥çœ‹çœ‹å…¶æºç ã€‚// å‰é¢è¿™ä¸‰ä¸ªå‡½æ•°æ˜¯å¯¹å„ä¸ªå‚æ•°çš„åˆæ³•æ€§è¿›è¡Œæ ¡éªŒï¼Œæ¯”å¦‚reducerï¼Œstateç­‰ã€‚function getUndefinedStateErrorMessage(key, action) &#123; var actionType = action &amp;&amp; action.type var actionName = actionType &amp;&amp; `&quot;$&#123;actionType.toString()&#125;&quot;` || &apos;an action&apos; return ( `Given action $&#123;actionName&#125;, reducer &quot;$&#123;key&#125;&quot; returned undefined. ` + `To ignore an action, you must explicitly return the previous state.` )&#125;function getUnexpectedStateShapeWarningMessage(inputState, reducers, action, unexpectedKeyCache) &#123; var reducerKeys = Object.keys(reducers) var argumentName = action &amp;&amp; action.type === ActionTypes.INIT ? &apos;preloadedState argument passed to createStore&apos; : &apos;previous state received by the reducer&apos; if (reducerKeys.length === 0) &#123; return ( &apos;Store does not have a valid reducer. Make sure the argument passed &apos; + &apos;to combineReducers is an object whose values are reducers.&apos; ) &#125; if (!isPlainObject(inputState)) &#123; return ( `The $&#123;argumentName&#125; has unexpected type of &quot;` + (&#123;&#125;).toString.call(inputState).match(/\\s([a-z|A-Z]+)/)[1] + `&quot;. Expected argument to be an object with the following ` + `keys: &quot;$&#123;reducerKeys.join(&apos;&quot;, &quot;&apos;)&#125;&quot;` ) &#125; var unexpectedKeys = Object.keys(inputState).filter(key =&gt; !reducers.hasOwnProperty(key) &amp;&amp; !unexpectedKeyCache[key] ) unexpectedKeys.forEach(key =&gt; &#123; unexpectedKeyCache[key] = true &#125;) if (unexpectedKeys.length &gt; 0) &#123; return ( `Unexpected $&#123;unexpectedKeys.length &gt; 1 ? &apos;keys&apos; : &apos;key&apos;&#125; ` + `&quot;$&#123;unexpectedKeys.join(&apos;&quot;, &quot;&apos;)&#125;&quot; found in $&#123;argumentName&#125;. ` + `Expected to find one of the known reducer keys instead: ` + `&quot;$&#123;reducerKeys.join(&apos;&quot;, &quot;&apos;)&#125;&quot;. Unexpected keys will be ignored.` ) &#125;&#125;function assertReducerSanity(reducers) &#123; Object.keys(reducers).forEach(key =&gt; &#123; var reducer = reducers[key] var initialState = reducer(undefined, &#123; type: ActionTypes.INIT &#125;) if (typeof initialState === &apos;undefined&apos;) &#123; throw new Error( `Reducer &quot;$&#123;key&#125;&quot; returned undefined during initialization. ` + `If the state passed to the reducer is undefined, you must ` + `explicitly return the initial state. The initial state may ` + `not be undefined.` ) &#125; var type = &apos;@@redux/PROBE_UNKNOWN_ACTION_&apos; + Math.random().toString(36).substring(7).split(&apos;&apos;).join(&apos;.&apos;) if (typeof reducer(undefined, &#123; type &#125;) === &apos;undefined&apos;) &#123; throw new Error( `Reducer &quot;$&#123;key&#125;&quot; returned undefined when probed with a random type. ` + `Don&apos;t try to handle $&#123;ActionTypes.INIT&#125; or other actions in &quot;redux/*&quot; ` + `namespace. They are considered private. Instead, you must return the ` + `current state for any unknown actions, unless it is undefined, ` + `in which case you must return the initial state, regardless of the ` + `action type. The initial state may not be undefined.` ) &#125; &#125;)&#125;// ä¸‹é¢æ­£å¼è¿›å…¥combineReducers.jsæ–‡ä»¶çš„ä¸»å‡½æ•°ï¼ŒcombineReducersï¼ˆè¿™å¥è¯æ€ä¹ˆè¿™ä¹ˆæ€ªï¼‰export default function combineReducers(reducers) &#123; // å¯ä»¥çœ‹åˆ°ï¼Œé¦–å…ˆæ˜¯è·å–è€çš„reducersçš„keyæ•°ç»„ var reducerKeys = Object.keys(reducers) var finalReducers = &#123;&#125; for (var i = 0; i &lt; reducerKeys.length; i++) &#123; var key = reducerKeys[i] // åˆ¤æ–­è€çš„reducerä¼ å…¥çš„keyæ‰€å¯¹åº”çš„valueæ˜¯å¦æ˜¯functionï¼Œå¦‚æœæ˜¯ï¼Œå°†è€çš„reducerä¸­çš„å¯¹è±¡æ”¾å…¥æ–°çš„finalReducerså¯¹è±¡ä¸­ã€‚ if (typeof reducers[key] === &apos;function&apos;) &#123; finalReducers[key] = reducers[key] &#125; &#125; var finalReducerKeys = Object.keys(finalReducers) // åˆ¤æ–­nodeç¯å¢ƒæ˜¯å¦ä¸ºç”Ÿäº§ç¯å¢ƒï¼Œä¹‹å‰å·²ç»è¯´è¿‡äº†ï¼Œåé¢å°±ä¸å†èµ˜è¿°äº†ã€‚ if (process.env.NODE_ENV !== &apos;production&apos;) &#123; var unexpectedKeyCache = &#123;&#125; &#125; // éªŒè¯finalReducersæ˜¯å¦åˆæ³•ã€‚ var sanityError try &#123; assertReducerSanity(finalReducers) &#125; catch (e) &#123; sanityError = e &#125; // è¿”å›æœ€ç»ˆç”Ÿæˆçš„reducerã€‚ return function combination(state = &#123;&#125;, action) &#123; if (sanityError) &#123; throw sanityError &#125; if (process.env.NODE_ENV !== &apos;production&apos;) &#123; var warningMessage = getUnexpectedStateShapeWarningMessage(state, finalReducers, action, unexpectedKeyCache) if (warningMessage) &#123; warning(warningMessage) &#125; &#125; var hasChanged = false var nextState = &#123;&#125; for (var i = 0; i &lt; finalReducerKeys.length; i++) &#123; var key = finalReducerKeys[i] var reducer = finalReducers[key] var previousStateForKey = state[key] var nextStateForKey = reducer(previousStateForKey, action) if (typeof nextStateForKey === &apos;undefined&apos;) &#123; var errorMessage = getUndefinedStateErrorMessage(key, action) throw new Error(errorMessage) &#125; nextState[key] = nextStateForKey hasChanged = hasChanged || nextStateForKey !== previousStateForKey &#125; // éå†ä¸€éçœ‹æ˜¯å¦æ”¹å˜ï¼Œç„¶åè¿”å›åŸæœ‰çŠ¶æ€å€¼æˆ–è€…æ–°çš„çŠ¶æ€å€¼ return hasChanged ? nextState : state &#125;&#125; compose.js123456789101112131415// composeå¯ä»¥æ¥å—ä¸€ç»„å‡½æ•°å‚æ•°ï¼Œä»å³åˆ°å·¦æ¥ç»„åˆå¤šä¸ªå‡½æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªç»„åˆå‡½æ•°ï¼ŒreduceRightå’Œreduceçš„å·®å¼‚å°±æ˜¯reduceRightæ˜¯ä»å³è¾¹å¼€å§‹éå†çš„ï¼Œè‡³äºåé¢çš„é€—å·ç®€å†™æ–¹å¼ï¼Œå¯ä»¥å‚è€ƒ[è¿™ä¸ªé—®é¢˜](https://segmentfault.com/q/1010000007320321)ã€‚export default function compose(...funcs) &#123; if (funcs.length === 0) &#123; return arg =&gt; arg &#125; if (funcs.length === 1) &#123; return funcs[0] &#125; const last = funcs[funcs.length - 1] const rest = funcs.slice(0, -1) return (...args) =&gt; rest.reduceRight((composed, f) =&gt; f(composed), last(...args))&#125; æ€»ç»“ï¼Ÿè¿™ä¸€æ¬¡çš„reduxæºç è§£è¯»å…ˆè®²åˆ°è¿™é‡Œå§ï¼Œæ„Ÿè§‰è¿™ä¸ªä¿¡æ¯é‡å·²ç»å¾ˆå¤§äº†ï¼Œè¿™äº›ä»£ç éƒ½æ˜¯æ¯”è¾ƒç²¾ç®€ä¸”è€¦åˆåº¦ä½ï¼Œæ²¡ä¾èµ–å…¶ä»–çš„ç¬¬ä¸‰æ–¹åº“ï¼Œä»…ä»…è¯»ä¸€éè¿˜æ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œé™¤äº†ä»£ç çš„ä¼˜ç§€ï¼Œä½œè€…çš„è®¾è®¡æ€æƒ³ä¹Ÿæ˜¯ååˆ†ä¼˜ç§€çš„ï¼Œæˆ‘è¿˜éœ€è¦ä¸æ–­çš„å­¦ä¹ æ‰èƒ½è¾¾åˆ°è¿™ä¸ªé«˜åº¦ï¼Œè€Œè‡³äºbindActionCreatorså’ŒapplyMiddlewareä¸¤ä¸ªæ–‡ä»¶æ²¡æœ‰è®²ï¼Œæˆ‘å‡†å¤‡ä¹‹åå†æ¥è®²ï¼Œå¤–é¢å¤©éƒ½é»‘äº†ï¼Œéå·¥ä½œæ—¥ä¸€ä¸ªäººåœ¨åŠå…¬å®¤åäº†ä¸€å¤©ï¼Œæ„Ÿè§‰å‘¨å›´éƒ½æ˜¯å¯’å†·ğŸ˜“ã€‚ã€‚ã€‚ 2017å¹´çš„ç¬¬ä¸€ç¯‡åšå®¢overã€‚","tags":[]},{"title":"D2æ€»ç»“ï¼ˆFusion Designï¼‰","date":"2016-12-18T07:43:05.000Z","path":"2016/12/18/D2æ€»ç»“ï¼ˆ1ï¼‰/","text":"è¿™å‘¨æœ«å»å‚åŠ äº†D2å‰ç«¯æŠ€æœ¯è®ºå›ï¼Œå¬äº†è¿™ä¹ˆå¤šåˆ†äº«ï¼Œå‘ç°æœ‰ä¸å°‘ä¸œè¥¿å¯ä»¥æ€»ç»“çš„ï¼Œå¯æ˜¯ç”±äºå½“å¤©ç¡®å®å¤ªç´¯ï¼Œæ‰€ä»¥æ²¡èƒ½åŠæ—¶æ•´ç†å‡ºæ€»ç»“æ¥ï¼Œåªå¥½ç°åœ¨æ¥æ…¢æ…¢å›æƒ³ï¼Œè¿˜å¥½å¬åˆ†äº«æ—¶è®°äº†ç¬”è®°çš„ã€‚ Fusionç®€ä»‹ï¼ï¼Work Smarter, Not Harderä¸Šé¢é‚£å¥è¯æ˜¯Fusionçš„ä»£è¡¨ã€‚åœ¨é¡µé¢å¼€å‘ä¸­ï¼Œä¸€ä¸ªå‰ç«¯å·¥ç¨‹å¸ˆæœ€è®¨åŒå¬åˆ°çš„è¯å°±æ˜¯ï¼Œâ€œäº§å“æˆ–è€…UIè¯´ï¼Œä½ çš„æŒ‰é’®é¢œè‰²ä¸å¥½çœ‹ï¼Œæ¢ä¸€ä¸‹ï¼›ä½ çš„è¿™ä¸ªå®½åº¦é«˜äº†ï¼Œæ”¹ä¸€ä¸‹ï¼›ä½ çš„é‚£ä¸ªè¾¹è·å®…äº†ï¼Œè°ƒæ•´ä¸€ä¸‹ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚â€ ä¸ç®¡åˆ«çš„å‰ç«¯æ€æ ·æƒ³çš„ï¼Œåæ­£æˆ‘æœ€è®¨åŒå¬åˆ°ç±»ä¼¼çš„è¯ï¼Œæ¯æ¬¡å¼€å‘å®Œäº†ï¼Œäº§å“å’ŒUIéªŒæ”¶æ—¶éƒ½ä¼šè¯´å¾ˆå¤šè¿™ç§è¯ï¼ˆå› ä¸ºæˆ‘åšçš„æ˜¯åå°ç³»ç»Ÿï¼Œæ²¡æœ‰UIç¨¿ï¼‰ï¼Œå¯¼è‡´ä¿®æ”¹è¿™äº›å°ç»†èŠ‚ä¹Ÿè¦æµªè´¹ä¸å°‘æ—¶é—´ï¼Œè™½ç„¶æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œä¸è¿‡çœŸçš„ä¸æƒ³åšè¿™äº›ä¸œè¥¿å•Šã€‚ã€‚ã€‚ è¿™å…¶å®å°±æ˜¯å‰ç«¯ä¸UIåä½œä¸­çš„æ²Ÿé€šæˆæœ¬ï¼ŒUIè¯´çš„ä¸€ç§æ ·å¼ï¼Œå’Œæˆ‘ä»¬å‰ç«¯æ‰€ç†è§£çš„ä¸€ç§æ ·å¼åœ¨æ²Ÿé€šäº¤æµä¸­äº§ç”Ÿäº†åå·®ï¼Œå¯¼è‡´æˆ‘ä»¬å¼€å‘å‡ºæ¥çš„ä¸œè¥¿å’Œæœ€åˆè®¾å®šçš„ä¸ä¸€æ ·ã€‚ è¯´åˆ°è¿™é‡Œï¼Œæˆ‘æƒ³å…ˆä¸¾å‡ ä¸ªå°ç¤ºä¾‹ã€‚ nodejsç°åœ¨ä¸ºä»€ä¹ˆèƒ½é‚£ä¹ˆç«ï¼Ÿå°±æ˜¯å› ä¸ºå®ƒæ‰“é€šäº†å‰ç«¯å·¥ç¨‹å¸ˆå’Œåç«¯å·¥ç¨‹å¸ˆå¼€å‘åä½œä¸­çš„éš”é˜‚ï¼Œç›´æ¥è®©å‰ç«¯æ¥å†™å‰ç«¯å’Œåç«¯ï¼Œæ²¡æœ‰äº†åä½œé—®é¢˜ï¼Œä¹Ÿæ²¡æœ‰äº†æ²Ÿé€šé—®é¢˜ï¼›reactNativeä¸ºä»€ä¹ˆç°åœ¨ä¹Ÿé‚£ä¹ˆç«ï¼Ÿæ˜¯å› ä¸ºå®ƒæ‰“é€šäº†ç§»åŠ¨ç«¯ï¼ˆH5ï¼ŒIOSï¼Œandroidï¼‰å„ä¸ªå²—ä½çš„å¼€å‘åä½œä¸æ²Ÿé€šã€‚nodejsçœŸçš„ç‰¹åˆ«å¥½å—ï¼Ÿæˆ‘ä¸çŸ¥é“ï¼Œæˆ‘åªçŸ¥é“ç°åœ¨åç«¯çš„ä¸»æµè¿˜æ˜¯javaï¼›rnæ˜¯ä¸æ˜¯ç‰¹åˆ«å¥½ï¼Œæˆ‘ä¸çŸ¥é“ï¼Œå› ä¸ºæˆ‘æ²¡ç”¨è¿‡ï¼Œå°±ç®—ä¸å¥½ï¼Œä½†æ˜¯è¿™ä¸€ç‚¹ä¹Ÿä¸å½±å“ä»–ä»¬çš„ä¼Ÿå¤§ï¼Œä»–ä»¬çš„å‰å®³ã€‚å°±å› ä¸ºä»–ä»¬è§£å†³äº†ä¸€äº›å¼€å‘ä¸­æ™®éçš„ç—›ç‚¹ï¼Œæ‰“é€šäº†å„ä¸ªå²—ä½ä¹‹é—´çš„é™åˆ¶ä¸éš”é˜‚ï¼Œå°†åä½œä¸æ²Ÿé€šæˆæœ¬ç›´æ¥å˜ä¸ºäº†0ï¼Œèƒ½ä¸ä¼Ÿå¤§ï¼Ÿ å›åˆ°æ­£é¢˜ä¸Šæ¥ï¼ŒFusionè§£å†³çš„ç—›ç‚¹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå°±æ˜¯å‰ç«¯å·¥ç¨‹å¸ˆå’ŒUIè®¾è®¡å¸ˆç›´æ¥çš„æ²Ÿé€šä¸åä½œé—®é¢˜ã€‚ è¿™æ˜¯Fusionå®˜æ–¹çš„ä¸€ä¸ªç®€ä»‹ï¼šFusion ä¸ºè®¾è®¡è€…ï¼Œå‰ç«¯å¼€å‘è€…æä¾›äº†ä¸€å¥—è½»æ¾æ„å»º DPL çš„è§£å†³æ–¹æ¡ˆï¼Œå°†ä¸€å¥—æ–°å“ç‰Œ DPL çš„æ„å»ºè¿‡ç¨‹ç¼©çŸ­åˆ°å‡ ä¸å¯è§çš„ç¨‹åº¦ã€‚ å¹¶åŸºäºæ­¤å»ºç«‹äº†ä»è®¾è®¡å¸ˆåˆ°å‰ç«¯ï¼Œè¦†ç›– DPL ä»è®¾è®¡ï¼Œå¼€å‘ï¼Œæ„å»ºï¼Œç¨¿ä»¶åˆ†å‘ï¼Œä»£ç å‘å¸ƒçš„ä¸€æ•´å¥—å®Œæ•´äº§å“é“¾ï¼Œç›®å‰å·²è¶‹äºæˆç†Ÿã€‚é€šè¿‡Fusionï¼Œè®¾è®¡å¸ˆå¯ä»¥ç›´æ¥æ›´æ”¹é¡µé¢ä¸Šç›¸å¯¹ç»„ä»¶çš„æ ·å¼ï¼Œæ¯”å¦‚æ›´æ”¹ä¸€ä¸ªæŒ‰é’®çš„é¢œè‰²ï¼Œæ²¡æœ‰ç¼–ç¨‹åŸºç¡€çš„è®¾è®¡å¸ˆåˆ†åˆ†é’Ÿå°±å¯ä»¥è§£å†³ï¼Œè€Œä¸éœ€è¦å‰ç«¯å·¥ç¨‹å¸ˆæ¥æ‰¾åˆ°é‚£ä¸ªæŒ‰é’®ï¼Œç„¶åæ›´æ”¹ä¸€ä¸‹styleé‡Œçš„colorã€‚ã€‚ã€‚ Fusionå°±æ˜¯ä¸€å¥—å“ç‰Œå¯é…ç½®çš„ä¸­å° DPL è®¾è®¡ç†è®ºï¼Œå®ƒé€šè¿‡ä¸­å°DPLå¯é…ç½®åŠŸèƒ½ï¼Œå®Œå®Œå…¨å…¨åšåˆ°äº†ä¸ç”¨å†™ä¸€è¡Œä»£ç ï¼Œå°±å¼€å‘å‡ºäº†ä¸€å¥—æ–°çš„ç»„ä»¶ã€‚ é€šè¿‡ä¸€ä¸ªæ‹–æ‹½å¹³å°å’Œéƒ¨åˆ†å¯é…ç½®çš„æ ·å¼å±æ€§ï¼Œå°±è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œæ˜¯ä¸æ˜¯å¾ˆå‰å®³å‘€ã€‚ ï¼ˆå…³äºæ›´åŠ è¯¦ç»†çš„ä»‹ç»ï¼Œå¯ä»¥å‚è€ƒç°åœºåˆ†äº«å‡ºæ¥çš„pptï¼‰ ç»­ï¼šFusionçš„ç›¸å…³pptå·²ç»æ‹¿åˆ°ï¼Œä¸€æ³¢ä¸‰æŠ˜å•Šï½ï½ï½ https://pan.baidu.com/s/1nuIPw2d","tags":[]},{"title":"reactâ€”â€”æ— çŠ¶æ€ç»„ä»¶å’Œé«˜é˜¶ç»„ä»¶","date":"2016-12-04T08:25:05.000Z","path":"2016/12/04/reactæ— çŠ¶æ€ç»„ä»¶å’Œé«˜é˜¶ç»„ä»¶/","text":"æ— çŠ¶æ€ç»„ä»¶å…ˆæ¥è¯´è¯´æ— çŠ¶æ€ç»„ä»¶å§ï¼Œé¡¾åæ€ä¹‰ï¼Œæ— çŠ¶æ€ç»„ä»¶å°±æ˜¯æŒ‡çš„æ²¡æœ‰çŠ¶æ€çš„ç»„ä»¶ï¼Œä¼—æ‰€å‘¨çŸ¥åœ¨reactä¸­ï¼ŒçŠ¶æ€æŒ‡çš„å°±æ˜¯stateï¼Œè€Œæ²¡æœ‰stateï¼Œä¼šæœ‰ä»€ä¹ˆå¥½å¤„å’Œåå¤„å‘¢ï¼Ÿ reactä¸­æ‰€æœ‰çš„æ•°æ®ï¼Œéƒ½æ˜¯é€šè¿‡stateå’Œpropsæ¥ä¿å­˜çš„ï¼Œstateä¸»è¦æ˜¯ç»„ä»¶å†…éƒ¨çš„æ•°æ®äº¤æµï¼Œå¯ä»¥è¿›è¡Œå„ç§è¯»å†™æ“ä½œï¼Œè€Œpropsä¸»è¦æ˜¯ç»„ä»¶é—´çš„æ•°æ®äº¤æµï¼Œä¸€èˆ¬é’ˆå¯¹propsä»…ä»…æ‰§è¡Œåªè¯»ï¼Œä¸ä¼šåšé¢å¤–çš„æ“ä½œã€‚æ‰€ä»¥è¯è¯´å›æ¥ï¼Œæ— çŠ¶æ€ç»„ä»¶ï¼Œæ²¡æœ‰stateï¼Œé‚£ä¹ˆå†…éƒ¨çš„é€»è¾‘å¿…å°†å¤§å¤§å‡å°‘ï¼Œç¼–å†™reactç»„ä»¶çš„æ–¹ä¾¿æ€§ä¹Ÿå°†å¤§å¤§æé«˜ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„æ— çŠ¶æ€ç»„ä»¶ï¼š 1234567function Hello(props&#123; return &lt;div&gt;Hello&#123;props.name&#125;&lt;/div&gt;&#125;ReactDOM.render(&lt;Hello name=&quot;world&quot; /&gt;, mountNode)// æœ€åä¸€å¥ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™ReactDOM.render(Hello(&#123;&quot;name&quot;:&quot;world&quot;&#125;), mountNode) é€šè¿‡è¿™ä¸ªç®€å•çš„ç¤ºä¾‹å¯ä»¥çœ‹åˆ°ï¼ŒåŸæœ¬éœ€è¦å†™çš„reactç±»å®šä¹‰ï¼ˆReact.createClassæˆ–è€…class Component extends React.Componentï¼‰æ¥åˆ›å»ºè‡ªå·±ç»„ä»¶çš„å®šä¹‰ï¼Œä½†æ˜¯ç”±äºè¿™ä»…ä»…æ˜¯ä¸€ä¸ªæ— çŠ¶æ€ç»„ä»¶ï¼ˆæ— çŠ¶æ€å‡½æ•°ï¼‰ï¼Œreactåœ¨æ¸²æŸ“çš„æ—¶å€™ä¹Ÿçœæ‰äº†å¥–reactç»„ä»¶ç±»å®ä¾‹åŒ–çš„è¿‡ç¨‹ã€‚ æ‰€ä»¥å¯¹äºä¸€äº›çº¯é™æ€å±•ç¤ºçš„åŠŸèƒ½æ¨¡å—ï¼Œå¯ä»¥è€ƒè™‘ä½œä¸ºæ— çŠ¶æ€ç»„ä»¶ï¼Œè€Œæ— çŠ¶æ€ç»„ä»¶ç”¨æ¥å®ç°æœåŠ¡ç«¯æ¸²æŸ“ä¹Ÿæ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ï¼Œåªè¦é¿å…å»è·å–domèŠ‚ç‚¹å°±å¯ä»¥äº†ã€‚ æ— çŠ¶æ€ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ— çŠ¶æ€ç»„ä»¶å°±å‰©äº†ä¸€ä¸ªrenderæ–¹æ³•ï¼Œå› æ­¤ä¹Ÿå°±æ²¡æœ‰å®ç°ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œä¾‹å¦‚componentDidMount, componentWillUnmountç­‰ã€‚é‚£åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å°±ç”¨åˆ°äº†é«˜é˜¶ç»„ä»¶ã€‚ é«˜é˜¶ç»„ä»¶é«˜é˜¶ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Ÿé€šè¿‡å‡½æ•°ï¼Œå‘ç°æœ‰çš„ç»„ä»¶ç±»æ·»åŠ é€»è¾‘ï¼Œå°±å«åšé«˜é˜¶ç»„ä»¶ã€‚ ä¹‹å‰ä¸Šé¢å·²ç»è¯´äº†ï¼Œæ— çŠ¶æ€ç»„ä»¶æ˜¯æ²¡æœ‰stateçš„ï¼Œæ‰€ä»¥é‡Œé¢åŸºæœ¬ä¹Ÿå°±æ²¡æœ‰ä»€ä¹ˆé€»è¾‘ï¼Œå¯æ˜¯å¦‚æœæˆ‘ç°åœ¨éœ€è¦æ·»åŠ é€»è¾‘äº†ï¼Œä¸”åˆæƒ³ç»§ç»­ä½¿ç”¨è¿™ä¸ªæ— çŠ¶æ€ç»„ä»¶ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿé‚£å°±å¯ä»¥ä½¿ç”¨é«˜é˜¶ç»„ä»¶ã€‚ å…ˆæ¥çœ‹çœ‹è¿™ä¸ªç¤ºä¾‹ï¼š 1234567891011121314function noId() &#123; return function(Comp) &#123; return class NoID extends Component &#123; render() &#123; const &#123;id, ...others&#125; = this.props; return ( &lt;Comp &#123;...others&#125;/&gt; ) &#125; &#125; &#125;&#125;const WithoutID = noId()(Comp); è¿™ä¸ªä¾‹å­å‘æˆ‘ä»¬å±•ç¤ºäº†é«˜é˜¶ç»„ä»¶çš„å·¥ä½œæ–¹å¼ï¼Œé€šè¿‡å‡½æ•°å’Œé—­åŒ…ç­‰æ–¹æ³•ï¼Œæ”¹å˜å·²æœ‰ç»„ä»¶çš„è¡Œä¸ºï¼Œç¤ºä¾‹é‡Œé¢æ”¹å˜äº†idå±æ€§ã€‚ ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸ºé«˜é˜¶ç»„ä»¶ï¼Œæ˜¯å› ä¸ºåœ¨reactä¸­ï¼Œè¿™ç§åµŒå¥—çš„é€»è¾‘å…³ç³»ä¼šåæ˜ åˆ°ç»„ä»¶æ ‘ä¸Šï¼Œå±‚å±‚åµŒå¥—å°±åƒé«˜é˜¶å‡½æ•°çš„function in functionä¸€æ ·ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºç»„ä»¶æ ‘è™½ç„¶åµŒå¥—äº†è®¸å¤šå±‚ï¼Œä½†æ˜¯å®é™…æ¸²æŸ“çš„æ— çŠ¶æ€ç»„ä»¶ä¸­çš„domç»“æ„å¹¶æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ”¾å¿ƒåœ°ä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼Œå“ªæ€•é‡å¤ä½¿ç”¨ï¼Œä¹Ÿä¸å¿…æ‹…å¿ƒå½±å“è¾“å‡ºçš„domç»“æ„ã€‚è€Œå€ŸåŠ©å‡½æ•°çš„è¡¨ç°èƒ½åŠ›ï¼Œé«˜é˜¶ç»„ä»¶çš„ç”¨é€”å‡ ä¹æ˜¯æ— ç©·å°½çš„ã€‚ é€‚é…å™¨æœ‰æ—¶å€™ä½ éœ€è¦æ›¿æ¢ä¸€äº›å·²æœ‰çš„ç»„ä»¶ï¼Œè€Œæ–°ç»„ä»¶æ¥å—çš„å‚æ•°å’ŒåŸç»„ä»¶å¹¶ä¸å®Œå…¨ä¸€æ ·. ä½ å¯ä»¥è€ƒè™‘ä¿®æ”¹æ‰€æœ‰åŸç»„ä»¶çš„ä»£ç æ¥ä¿è¯ä¼ å…¥æ­£ç¡®çš„å‚æ•°â€”â€”so badã€‚ ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼ŒæŠŠæ–°ç»„ä»¶åšä¸€å±‚å°è£…ï¼š 12345678class ListAdapter extends Component &#123; mapProps(props) &#123; return &#123;/* new props */&#125; &#125; render() &#123; return &lt;NewList &#123;...mapProps(this.props)&#125; /&gt; &#125;&#125; å¦‚æœæœ‰åä¸ªç»„ä»¶éœ€è¦é€‚é…å‘¢ï¼Ÿå½“ç„¶ï¼Œæ¯ä¸ªç»„ä»¶å†™åéä¹Ÿä¸æ˜¯ä¸è¡Œï¼Œä¸è¿‡ï¼Œé«˜é˜¶ç»„ä»¶æˆ–è®¸ä¼šç»™ä½ ä¸€ä¸ªæ›´å¥½çš„ç­”æ¡ˆï¼š 1234567891011function mapProps(mapFn) &#123; return function(Comp) &#123; return class extends Component &#123; render() &#123; return &lt;Comp &#123;...mapFn(this.props)&#125;/&gt; &#125; &#125; &#125; &#125;const ListAdapter = mapProps(mapPropsForNewList)(NewList); å€ŸåŠ©é«˜é˜¶ç»„ä»¶ï¼Œå…³æ³¨ç‚¹è¢«åˆ†ç¦»å¾—è¶³å¤Ÿå½»åº•ï¼Œä½ ä¸éœ€è¦è€ƒè™‘ç»„ä»¶çš„æ¸²æŸ“ï¼Œä½ åªéœ€è¦è€ƒè™‘å±æ€§çš„mapå°±å¤Ÿäº†ã€‚ å¤„ç†å‰¯ä½œç”¨åœ¨ç»„ä»¶ä¸­ï¼Œå¾€å¾€æœ‰å¾ˆå¤šçš„çŠ¶æ€å’Œå‰¯ä½œç”¨è¦å¤„ç†ï¼Œæœ€å¸¸è§çš„æƒ…å†µå°±æ˜¯å¼‚æ­¥äº†ã€‚ å‡è®¾æˆ‘ä»¬éœ€è¦å¼‚æ­¥åŠ è½½ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨ï¼Œé€šå¸¸çš„ä»£ç ä¼šæ˜¯è¿™æ ·çš„ï¼š 1234567891011121314151617181920class UserList extends Component &#123; constructor(props) &#123; super(); this.state = &#123; list: [] &#125; &#125; componentDidMount() &#123; loadUsers() .then(data=&gt; this.setState(&#123;list: data.userList&#125;) ) &#125; render() &#123; return ( &lt;List list=&#123;this.state.list&#125; /&gt; ) &#125; /* other bussiness logics */&#125; åœ¨å®é™…æƒ…å†µä¸­ï¼Œä»¥ä¸Šä»£ç å¾€å¾€è¿˜ä¼šå’Œå…¶ä»–ä¸€äº›ä¸šåŠ¡å‡½æ•°æ··æ‚åœ¨ä¸€èµ·ï¼Œå¦‚æœå†æ¥ä¸€ä¸ªæˆ–å¤šä¸ªå…¶ä»–çš„åˆ—è¡¨å‘¢ï¼Œä¸ä»…ä»£ç ä¼šé‡å¤ï¼Œå¤§é‡æœ‰çŠ¶æ€å’Œå‰¯ä½œç”¨çš„ç»„ä»¶ä¹Ÿä½¿å¾—ç»„ä»¶éš¾ä»¥æµ‹è¯•ã€‚æˆ–è®¸ä½ ä¼šè€ƒè™‘ä½¿ç”¨ä¸€äº›æ•°æ®ç®¡ç†å·¥å…·ï¼Œæ¯”å¦‚fluxæˆ–reduxï¼Œæ˜¯çš„ï¼Œå½“ç„¶å¯ä»¥ï¼Œå¯æ˜¯è¿™å°±åƒå¤§ç‚®æ‰“èšŠå­ï¼Œæ€é¸¡ç”¨ç‰›åˆ€ã€‚æ‰€ä»¥å›åˆ°è¿™ä¸ªé—®é¢˜ä¸Šæ¥ï¼Œæˆ‘ä»¬åªæ˜¯æƒ³åšä¸€ä¸ªå¼‚æ­¥çš„åˆ—è¡¨ï¼Œä»…æ­¤è€Œå·²ã€‚ ä½¿ç”¨é«˜é˜¶å‡½æ•°è¯•è¯•ï¼š 123456789101112131415161718192021222324252627function connectPromise(&#123;promiseLoader, mapResultToProps&#125;) &#123; return Comp=&gt; &#123; return class AsyncComponent extends Component &#123; constructor(props) &#123; super(); this.state = &#123; result: undefined &#125; &#125; componentDidMount() &#123; promiseLoader() .then(result=&gt; this.setState(&#123;result&#125;)) &#125; render() &#123; return ( &lt;Comp &#123;...mapResultToProps(props)&#125; &#123;...this.props&#125;/&gt; ) &#125; &#125; &#125;&#125;const UserList = connectPromise(&#123; promiseLoader: loadUsers, mapResultToProps: result=&gt; (&#123;list: result.userList&#125;)&#125;)(List); //List can be a pure component å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ ·ä¸ä»…å¤§é‡å‡å°‘äº†é‡å¤çš„ä»£ç ï¼Œè¿˜æŠŠæ•£è½åœ¨å„å¤„çš„å¼‚æ­¥é€»è¾‘å°è£…è¿›äº†å¯ä»¥å•ç‹¬ç®¡ç†å’Œæµ‹è¯•çš„å‡½æ•°ä¸­ï¼Œåœ¨å®é™…ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œåªéœ€è¦æŒ‰ç…§â€œçº¯ç»„ä»¶ï¼‹é…ç½®â€å°±å¯ä»¥å®ç°ç›¸åŒçš„åŠŸèƒ½ï¼Œè€Œæ— è®ºæ˜¯çº¯ç»„ä»¶è¿˜æ˜¯é…ç½®ï¼Œéƒ½æ˜¯å¯¹å•å…ƒæµ‹è¯•å‹å¥½çš„ï¼Œè‡³å°‘æ¯”å¼‚æ­¥ç»„ä»¶å‹å¥½å¤šäº†å§ã€‚","tags":[]},{"title":"ä»æºç çœ‹reactç”Ÿå‘½å‘¨æœŸ","date":"2016-11-08T04:22:04.000Z","path":"2016/11/08/reactç”Ÿå‘½å‘¨æœŸæºç è§£è¯»/","text":"Reactçš„ä¸»è¦æ€æƒ³ï¼Œå°±æ˜¯é€šè¿‡æ„å»ºå¯å¤ç”¨çš„ç»„ä»¶æ¥æ„å»ºé¡µé¢ï¼Œè€Œæ¯ä¸€ä¸ªç»„ä»¶ï¼Œå°±æ˜¯ä¸€ä¸ªæœ‰é™çš„çŠ¶æ€æœºï¼Œé€šè¿‡çŠ¶æ€æ§åˆ¶ç»„ä»¶ä¸åŒçš„æ¸²æŸ“ï¼Œä»è€Œå¾—åˆ°ä¸åŒçš„ç•Œé¢æ•ˆæœã€‚æ¯ä¸ªç»„ä»¶éƒ½æœ‰ç”Ÿå‘½å‘¨æœŸï¼Œå®ƒè§„å®šäº†ç»„ä»¶çš„ä¸€äº›è‡ªå¸¦æ–¹æ³•éœ€è¦åœ¨å“ªä¸ªé˜¶æ®µè¿›è¡Œæ‰§è¡Œä»¥åŠè¾“å‡ºå¯¹åº”çš„ç»“æœã€‚ æœ‰é™çŠ¶æ€æœºï¼Œè¡¨ç¤ºæœ‰é™ä¸ªçŠ¶æ€ï¼Œä»¥åŠåœ¨è¿™äº›çŠ¶æ€ä¹‹é—´çš„æ•°æ®è½¬ç§»å’ŒåŠ¨ä½œæ–¹æ³•çš„æ‰§è¡Œçš„è¡Œä¸ºæ¨¡å‹ï¼Œä¸€èˆ¬é€šè¿‡çŠ¶æ€ã€äº‹ä»¶ã€è½¬æ¢å’ŒåŠ¨ä½œæ¥æè¿°æœ‰é™çŠ¶æ€æœºã€‚ä¾‹å¦‚é¡µé¢ä¸Šçš„éƒ½ä¸ªä¸œè¥¿æœ‰æ˜¾ç¤ºå’Œéšè—ä¸¤ç§æƒ…å†µï¼Œé‚£ä¹ˆä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬ä¼šè®¾è®¡ä¸¤ä¸ªæ–¹æ³•ï¼šshow()å’Œhide()æ¥å®ç°æ˜¾ç¤ºä¸éšè—çš„åˆ‡æ¢ï¼Œè€Œreactåªéœ€è¦è®¾ç½®æŸä¸€ä¸ªçŠ¶æ€ä¸ºtrueæˆ–falseï¼Œå°±å¯ä»¥å®ç°è¿™ä¸ªç»„ä»¶çš„éšè—å’Œæ˜¾ç¤ºè½¬æ¢äº†ã€‚åŒæ—¶ï¼Œreactè¿˜å¼•å…¥äº†ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸè¿™ä¸ªæ¦‚å¿µï¼Œé€šè¿‡å®ƒå°±å¯ä»¥å®ç°ç»„ä»¶çš„çŠ¶æ€æœºæ§åˆ¶ï¼Œä»è€Œè¾¾åˆ°â€œç”Ÿå‘½å‘¨æœŸï¼çŠ¶æ€ï¼ç»„ä»¶â€çš„å’Œè°ç”»é¢ã€‚ ç”Ÿå‘½å‘¨æœŸä¹‹å‰ä¸€ç¯‡åšå®¢å°±å·²ç»è¯´åˆ°äº†ä¸€ä¸‹ç”Ÿå‘½å‘¨æœŸï¼Œæˆ‘åœ¨è¿™é‡Œå†èµ˜è¿°ä¸€ä¸‹å§ï¼Œreactç»„ä»¶è‡ªå¸¦çš„ä¸€äº›å‡½æ•°æ–¹æ³•ï¼Œæ¯”å¦‚getDefaultPropsã€getInitialStateç­‰ï¼Œä¼šåœ¨ä»€ä¹ˆæ—¶å€™æ‰§è¡Œã€‚ å½“é¦–æ¬¡è£…è½½ç»„ä»¶æ—¶ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œ getDefaultPropsã€getInitialStateã€componentWillMountã€render å’Œ componentDidMountï¼› å½“å¸è½½ç»„ä»¶æ—¶ï¼Œæ‰§è¡Œ componentWillUnmountï¼› å½“é‡æ–°è£…è½½ç»„ä»¶æ—¶ï¼Œæ­¤æ—¶æŒ‰é¡ºåºæ‰§è¡Œ getInitialStateã€componentWillMountã€render å’Œ componentDidMountï¼Œä½†å¹¶ä¸æ‰§è¡Œ getDefaultPropsï¼› å½“å†æ¬¡æ¸²æŸ“ç»„ä»¶æ—¶ï¼Œç»„ä»¶æ¥å—åˆ°æ›´æ–°çŠ¶æ€ï¼Œæ­¤æ—¶æŒ‰é¡ºåºæ‰§è¡Œ componentWillReceivePropsã€shouldComponentUpdateã€componentWillUpdateã€render å’Œ componentDidUpdate. ç„¶åå…·ä½“çš„çŠ¶æ€ã€å±æ€§æ”¹å˜ï¼Œä¼šè§¦å‘ä»€ä¹ˆæ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹ä¸¤å¼ å›¾ï¼Œç”±äºè¿™ç¯‡åšå®¢é‡ç‚¹ä¸åœ¨äºæ­¤ï¼Œæ‰€ä»¥å°±ä¸ç»†ç»†è®²è§£äº†ã€‚ ç–‘é—®ï¼š ä¸ºä»€ä¹ˆreactä¼šæŒ‰ç…§è¿™æ ·çš„æ–¹å¼æ¥ï¼Œè¿™æ ·çš„é¡ºåºæ¥æ‰§è¡Œç”Ÿå‘½å‘¨æœŸï¼Ÿ ä¸ºä»€ä¹ˆreactå¤šæ¬¡renderæ—¶ï¼Œä¼šæ‰§è¡Œç”Ÿå‘½å‘¨æœŸçš„ä¸åŒé˜¶æ®µã€‚ ä¸ºä»€ä¹ˆgetDefaultPropsåªæ‰§è¡Œäº†ä¸€æ¬¡ï¼Ÿ reactç”Ÿå‘½å‘¨æœŸè¯¦è§£reactç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¸»è¦é€šè¿‡ä¸‰ç§çŠ¶æ€æ¥ç®¡ç†ï¼Œåˆ†åˆ«æ˜¯MOUNTINGã€RECEIVE_PROPSã€UNMOUNTINGï¼Œè€Œå…¶ä»–çš„æ–¹æ³•ï¼Œä¾‹å¦‚getDefaultPropsã€getInitialStateï¼Œè¿˜åŒ…æ‹¬è‡ªå·±å®šä¹‰çš„ä¸€äº›æ–¹æ³•ç­‰ï¼Œéƒ½æ˜¯é€šè¿‡è¿™ä¸‰ä¸ªçŠ¶æ€æ¥ç®¡ç†çš„ï¼Œè¿™ä¸‰ä¸ªçŠ¶æ€ä¼šè´Ÿè´£é€šçŸ¥å¯¹åº”çš„ç»„ä»¶å½“å‰æ‰€å¤„çš„çŠ¶æ€ï¼Œåº”è¯¥æ‰§è¡Œç”Ÿå‘½å‘¨æœŸä¸­çš„å“ªä¸ªæ­¥éª¤ï¼Œæ¯”å¦‚æ˜¯å¦å¯ä»¥æ›´æ–°stateï¼Œæ˜¯å¦èƒ½è°ƒç”¨è‡ªå®šä¹‰å‡½æ•°ç­‰ã€‚åœ¨è¿™ä¸‰ç§çŠ¶æ€ä¸­ï¼ŒMOUNTINGæŒ‡çš„æ˜¯åŠ è½½ç»„ä»¶ï¼ŒRECEIVE_PROPSæŒ‡çš„æ˜¯æ›´æ–°ç»„ä»¶ï¼ŒUNMOUNTINGæŒ‡çš„æ˜¯å¸è½½ç»„ä»¶ï¼Œè€Œæ¯ç§æƒ…å†µï¼Œæ¯”å¦‚è¯´åŠ è½½ç»„ä»¶ï¼ˆmountComponentï¼‰ï¼Œéƒ½ä¼šæœ‰ä¸¤ç§æ–¹æ³•ï¼Œwillå’Œdidï¼ŒwillæŒ‡çš„æ˜¯ä¹‹å‰ï¼Œæ¯”å¦‚è¯´åŠ è½½ä¹‹å‰ï¼Œæ›´æ–°ä¹‹å‰ï¼Œè€ŒdidæŒ‡çš„æ˜¯ä¹‹åï¼Œè¡¨ç¤ºåŠ è½½ä¹‹åï¼Œæ›´æ–°ä¹‹åã€‚ creatClassåˆ›å»ºç»„ä»¶è¿™æ˜¯æœ€reactç»„ä»¶ä¸­çš„å…¥å£æ–¹æ³•ï¼Œè´Ÿè´£ç®¡ç†ç”Ÿå‘½å‘¨æœŸä¸­çš„getDefaultPropsã€‚getDefaultPropsæ–¹æ³•åœ¨reactç”Ÿå‘½å‘¨æœŸä¸­åªæ‰§è¡Œä¸€æ¬¡ï¼Œé‚£å°±æ˜¯åœ¨é¦–æ¬¡åŠ è½½ç»„ä»¶åˆå§‹åŒ–çš„æ—¶å€™æ‰§è¡Œã€‚é€šè¿‡creatClassåˆ›å»ºç»„ä»¶ï¼Œåˆ©ç”¨åŸå‹ç»§æ‰¿ReactCompositeBaseçˆ¶ç±»ï¼Œç„¶åæŒ‰é¡ºåºåˆå¹¶mixinsï¼Œè®¾ç½®åˆå§‹åŒ–defaultPropsï¼Œåˆ›å»ºReactElementå…ƒç´ ï¼Œå…·ä½“ä¿¡æ¯çœ‹çœ‹ä¸‹é¢çš„æºç ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051// ReactCompositeComponent çš„åŸºç±»var ReactCompositeComponentBase = function() &#123;&#125;; // å°† Mixin åˆå¹¶åˆ° ReactCompositeComponentBase çš„åŸå‹ä¸Š assign( ReactCompositeComponentBase.prototype, ReactComponent.Mixin, ReactOwner.Mixin, ReactPropTransferer.Mixin, ReactCompositeComponentMixin );var ReactCompositeComponent = &#123; LifeCycle: CompositeLifeCycle, Base: ReactCompositeComponentBase, // åˆ›å»ºç»„ä»¶ createClass: function(spec) &#123; // æ„é€ å‡½æ•° var Constructor = function(props, context) &#123; this.props = props; this.context = context; this.state = null; var initialState = this.getInitialState ? this.getInitialState() : null; this.state = initialState; &#125;; // åŸå‹ç»§æ‰¿çˆ¶ç±» Constructor.prototype = new ReactCompositeComponentBase(); Constructor.prototype.constructor = Constructor; // åˆå¹¶ mixins injectedMixins.forEach( mixSpecIntoComponent.bind(null, Constructor) ); mixSpecIntoComponent(Constructor, spec); // mixins åˆå¹¶åè£…è½½ defaultProps (Reactæ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ getDefaultProps åªæ‰§è¡Œä¸€æ¬¡) if (Constructor.getDefaultProps) &#123; Constructor.defaultProps = Constructor.getDefaultProps(); &#125; for (var methodName in ReactCompositeComponentInterface) &#123; if (!Constructor.prototype[methodName]) &#123; Constructor.prototype[methodName] = null; &#125; &#125; return ReactElement.createFactory(Constructor); &#125;&#125; æ‰€ä»¥è¿™å°±è§£é‡Šäº†ï¼Œä¸ºä»€ä¹ˆgetDefaultPropsä¼šåœ¨reactç»„ä»¶ä¸­å¾ˆæ—©çš„å°±è¢«è°ƒç”¨ï¼Œä¸”åªè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œå› ä¸ºgetDefaultPropsæ˜¯é€šè¿‡Constructoræ¥è¿›è¡Œç®¡ç†çš„ï¼Œæ‰€ä»¥æ˜¯åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­æœ€å…ˆå¼€å§‹æ‰§è¡Œã€‚ çŠ¶æ€ä¸€ï¼šMOUNTINGmountComponentè´Ÿè´£ç®¡ç†ç”Ÿå‘½å‘¨æœŸä¸­çš„getInitialStateã€componentWillMountã€renderã€componentDidMountæ–¹æ³•ã€‚ mountComponentä¸»è¦åšäº†ä»¥ä¸‹ä¸€äº›äº‹ã€‚ é¦–å…ˆé€šè¿‡mountComponentè£…è½½ç»„ä»¶ï¼Œæ­¤æ—¶å°†çŠ¶æ€æ”¹ä¸ºMOUNTINGï¼Œé€šè¿‡geiInitalStateè·å–åˆå§‹åŒ–çš„stateï¼Œåˆå§‹åŒ–æ›´æ–°é˜Ÿåˆ—ä¸ºnullã€‚ ç„¶åä¼šåˆ¤æ–­componentWillMountæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™æ‰§è¡ŒcomponentWillMountï¼Œè‹¥æ­¤æ—¶ä½¿ç”¨äº†setStateæ–¹æ³•ï¼Œåˆ™ä¸ä¼šå‡ºå‘re-renderï¼Œè€Œæ˜¯ä¼šåˆå¹¶æ›´æ–°é˜Ÿåˆ—ï¼Œå’Œåˆå§‹åŒ–çš„renderä¸€èµ·æ‰§è¡Œã€‚ åˆ°æ­¤æ—¶ï¼Œå·²ç»å®Œæˆäº†MOUNTINGçš„å·¥ä½œï¼Œå°†æ›´æ–°çŠ¶æ€æ”¹ä¸ºNULLï¼Œå¦‚æœåé¢å†ä½¿ç”¨setStateæ–¹æ³•ï¼Œåˆ™ä¼šæ›´æ”¹æ›´æ–°çŠ¶æ€ï¼Œç„¶åå‡ºå‘renderå‡½æ•°é‡æ–°æ¸²æŸ“ã€‚ mountComponentæœ¬è´¨ä¸Šæ˜¯é€šè¿‡é€’å½’çš„æ–¹æ³•æ¥æ¸²æŸ“çš„å†…å®¹ï¼Œæ‰€ä»¥å¦‚æœä¸€ä¸ªç»„ä»¶ä¸­åŒ…å«äº†å¦å¤–çš„å­ç»„ä»¶çš„è¯ï¼Œæ€ä¼šå‘ç°ï¼Œçˆ¶ç»„ä»¶ä¸­çš„componentWillMountæ€»æ˜¯ä¼šåœ¨å­ç»„ä»¶ä¸­çš„componentWillMountä¹‹å‰è°ƒç”¨ï¼Œè€Œçˆ¶ç»„ä»¶çš„componentDidMountæ€»æ˜¯ä¼šåœ¨å­ç»„ä»¶çš„componentDidMountåé¢è°ƒç”¨ã€‚ æœ€åå½“åˆå§‹åŒ–æ¸²æŸ“å®Œæˆåï¼Œè‹¥å­˜åœ¨componentDidMountï¼Œåˆ™å‡ºè§¦å‘ã€‚ è¿™æ®µæµç¨‹çš„æºç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950// è£…è½½ç»„ä»¶mountComponent: function(rootID, transaction, mountDepth) &#123; // å½“å‰çŠ¶æ€ä¸º MOUNTING this._compositeLifeCycleState = CompositeLifeCycle.MOUNTING; // å½“å‰å…ƒç´ å¯¹åº”çš„ä¸Šä¸‹æ–‡ this.context = this._processContext(this._currentElement._context); // å½“å‰å…ƒç´ å¯¹åº”çš„ props this.props = this._processProps(this.props); // è·å–åˆå§‹åŒ– state this.state = this.getInitialState(); // åˆå§‹åŒ–æ›´æ–°é˜Ÿåˆ— this._pendingState = null; this._pendingForceUpdate = false; // componentWillMount è°ƒç”¨setstateï¼Œä¸ä¼šè§¦å‘rerenderè€Œæ˜¯è‡ªåŠ¨æå‰åˆå¹¶ if (this.componentWillMount) &#123; this.componentWillMount(); if (this._pendingState) &#123; this.state = this._pendingState; this._pendingState = null; &#125; &#125; // å¾—åˆ° _currentElement å¯¹åº”çš„ component ç±»å®ä¾‹ this._renderedComponent = instantiateReactComponent( this._renderValidatedComponent(), this._currentElement.type ); // å®Œæˆ MOUNTINGï¼Œæ›´æ–° state this._compositeLifeCycleState = null; // render é€’å½’æ¸²æŸ“ var markup = this._renderedComponent.mountComponent( rootID, transaction, mountDepth + 1 ); // å¦‚æœå­˜åœ¨ this.componentDidMountï¼Œåˆ™æ¸²æŸ“å®Œæˆåè§¦å‘ if (this.componentDidMount) &#123; transaction.getReactMountReady().enqueue(this.componentDidMount, this); &#125; return markup;&#125; è¯¦ç»†æµç¨‹å›¾å¦‚ä¸‹ï¼š çŠ¶æ€äºŒï¼šRECEIVE_PROPSupdateComponentè´Ÿè´£ç®¡ç†reactç”Ÿå‘½å‘¨æœŸä¸­çš„componentWillReceivePropsã€shouldComponentUpdateã€componentWillUpadteã€renderã€compoentDidUpdateç­‰æ–¹æ³•ã€‚ åœ¨æœ‰ç»„ä»¶æ›´æ–°æ—¶ï¼Œreactä¼šé€šè¿‡updateComponentæ¥æ›´æ–°ç»„ä»¶ï¼Œå¦‚æœå‰åçš„å…ƒç´ ä¸ä¸€è‡´ï¼Œåˆ™è¯´æ˜éœ€è¦è¿›è¡Œç»„ä»¶æ›´æ–°ï¼Œæ­¤æ—¶ä¼šå°†çŠ¶æ€æ”¹ä¸ºRECEIVE_PROPSã€‚ åœ¨è¿›è¡Œç»„ä»¶æ›´æ–°çš„æ—¶å€™ï¼Œreacté¦–å…ˆä¼šæ£€æŸ¥æœ‰æ²¡æœ‰componentWillReceivePropsï¼Œå¦‚æœæœ‰ï¼Œåˆ™æ‰§è¡Œæ­¤å‡½æ•°ï¼Œä¸”componentWillReceivePropså‡½æ•°ä¸­è°ƒç”¨setStateæ˜¯ä¸ä¼šé‡å¤è§¦å‘renderå‡½æ•°çš„ï¼Œè€Œæ˜¯ä¼šè¿›è¡Œrenderåˆå¹¶ï¼Œåˆ°è¿™ä¸ªæ—¶åˆ»ï¼ŒRECEIVE_PROPSçš„å·¥ä½œå°±å·²ç»åšå®Œäº†ï¼Œç„¶åå°†çŠ¶æ€æ”¹ä¸ºNULLï¼ŒåŒæ—¶stateä¹Ÿå°†è¿›è¡Œæ›´æ–°æ“ä½œï¼Œæ­¤æ—¶è°ƒç”¨this.stateï¼Œå¯ä»¥è·å¾—æ›´æ–°åçš„stateã€‚ ç„¶åä¼šè°ƒç”¨shouldComponentUpdateæ¥ä½œä¸ºæœ€åçš„åˆ¤æ–­ï¼Œåˆ¤æ–­ç»„ä»¶æ˜¯å¦æ›´æ–°ï¼Œreturn trueåˆ™ä¼šæ›´æ–°ï¼Œå¦åˆ™ä¸æ›´æ–°ï¼›ä¹‹å‰å·²ç»è¯´è¿‡äº†ï¼Œreacté‡Œçš„ç»„ä»¶æ˜¯é€šè¿‡é€’å½’æ¥æ›´æ–°æ¸²æŸ“çš„ï¼Œè€Œç”±äºé€’å½’çš„ç‰¹æ€§ï¼Œæ‰€ä»¥çˆ¶ç»„ä»¶çš„componentWillUpdateä¼šåœ¨å­ç»„ä»¶componentWillUpdateä¹‹å‰æ‰§è¡Œï¼Œçˆ¶ç»„ä»¶çš„componentDidUpdateä¼šåœ¨å­ç»„ä»¶componentDidUpdateä¹‹åæ‰§è¡Œã€‚æ³¨æ„ï¼šç¦æ­¢åœ¨shouldComponentUpdateå’ŒcomponentWillUpdateä¸­è°ƒç”¨setStateï¼Œä¼šé€ æˆå¾ªç¯è°ƒç”¨ï¼Œç›´è‡³è€—å…‰æµè§ˆå™¨å†…å­˜åå´©æºƒã€‚ updateComponentçš„å…·ä½“æµç¨‹å›¾å¦‚ä¸‹ï¼š ä¸‹é¢æ˜¯å…·ä½“æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960// æ›´æ–°ç»„ä»¶updateComponent: function(transaction, prevParentElement, nextParentElement) &#123; var prevContext = this.context; var prevProps = this.props; var nextContext = prevContext; var nextProps = prevProps; if (prevParentElement !== nextParentElement) &#123; nextContext = this._processContext(nextParentElement._context); nextProps = this._processProps(nextParentElement.props); // å½“å‰çŠ¶æ€ä¸º RECEIVING_PROPS this._compositeLifeCycleState = CompositeLifeCycle.RECEIVING_PROPS; // å¦‚æœå­˜åœ¨ componentWillReceivePropsï¼Œåˆ™æ‰§è¡Œ if (this.componentWillReceiveProps) &#123; this.componentWillReceiveProps(nextProps, nextContext); &#125; &#125; // è®¾ç½®çŠ¶æ€ä¸º nullï¼Œæ›´æ–° state this._compositeLifeCycleState = null; var nextState = this._pendingState || this.state; this._pendingState = null; var shouldUpdate = this._pendingForceUpdate || !this.shouldComponentUpdate || this.shouldComponentUpdate(nextProps, nextState, nextContext); if (!shouldUpdate) &#123; // å¦‚æœç¡®å®šç»„ä»¶ä¸æ›´æ–°ï¼Œä»ç„¶è¦è®¾ç½® props å’Œ state this._currentElement = nextParentElement; this.props = nextProps; this.state = nextState; this.context = nextContext; this._owner = nextParentElement._owner; return; &#125; this._pendingForceUpdate = false; ...... // å¦‚æœå­˜åœ¨ componentWillUpdateï¼Œåˆ™è§¦å‘ if (this.componentWillUpdate) &#123; this.componentWillUpdate(nextProps, nextState, nextContext); &#125; // render é€’å½’æ¸²æŸ“ var nextMarkup = this._renderedComponent.mountComponent( thisID, transaction, this._mountDepth + 1 ); // å¦‚æœå­˜åœ¨ componentDidUpdateï¼Œåˆ™è§¦å‘ if (this.componentDidUpdate) &#123; transaction.getReactMountReady().enqueue( this.componentDidUpdate.bind(this, prevProps, prevState, prevContext), this ); &#125;&#125;, çŠ¶æ€ä¸‰ï¼šUNMOUNTINGunmountComponent è´Ÿè´£ç®¡ç†ç”Ÿå‘½å‘¨æœŸä¸­çš„ componentWillUnmountã€‚ é¦–å…ˆå°†çŠ¶æ€è®¾ç½®ä¸º UNMOUNTINGï¼Œè‹¥å­˜åœ¨ componentWillUnmountï¼Œåˆ™æ‰§è¡Œï¼›å¦‚æœæ­¤æ—¶åœ¨ componentWillUnmount ä¸­è°ƒç”¨ setStateï¼Œæ˜¯ä¸ä¼šè§¦å‘ reRenderã€‚æ›´æ–°çŠ¶æ€ä¸º NULLï¼Œå®Œæˆç»„ä»¶å¸è½½æ“ä½œã€‚ å…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011121314151617// å¸è½½ç»„ä»¶unmountComponent: function() &#123; // è®¾ç½®çŠ¶æ€ä¸º UNMOUNTING this._compositeLifeCycleState = CompositeLifeCycle.UNMOUNTING; // å¦‚æœå­˜åœ¨ componentWillUnmountï¼Œåˆ™è§¦å‘ if (this.componentWillUnmount) &#123; this.componentWillUnmount(); &#125; // æ›´æ–°çŠ¶æ€ä¸º null this._compositeLifeCycleState = null; this._renderedComponent.unmountComponent(); this._renderedComponent = null; ReactComponent.Mixin.unmountComponent.call(this);&#125; setStateæ›´æ–°æœºåˆ¶è¯´èµ·setStateï¼Œæƒ³å¿…ç”¨è¿‡reactçš„éƒ½ä¼šçŸ¥é“å§ï¼Œä¸è¿‡setStateçš„æ›´æ–°æœºåˆ¶ï¼Œä½ çœŸçš„çŸ¥é“å—ï¼Ÿ å½“ä½ è°ƒç”¨setStateçš„æ—¶å€™ï¼Œä¼šå¯¹stateä»¥åŠ_pendingStateæ›´æ–°é˜Ÿåˆ—è¿›è¡Œåˆå¹¶æ“ä½œï¼Œä½†æ˜¯ï¼ŒçœŸæ­£æ›´æ–°stateçš„å¹•åé»‘æ‰‹å…¶å®æ˜¯replaceStateã€‚replaceStateä¼šå…ˆåˆ¤æ–­å½“å‰çŠ¶æ€æ˜¯å¦æ˜¯MOUNTINGï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™ä¼šç«‹å³è°ƒç”¨ReactUpdates.enqueueUpdateæ¥æ‰§è¡Œæ›´æ–°ã€‚ å½“çŠ¶æ€ä¸ä¸ºMOUNTINGå’ŒRECEIVEPROPSçš„æ—¶å€™ï¼ŒperformUpdateIfNecessary ä¼šè·å– _pendingElementã€_pendingStateã€_pendingForceUpdateï¼Œå¹¶è°ƒç”¨ updateComponent è¿›è¡Œç»„ä»¶æ›´æ–°ã€‚ å¦‚æœåœ¨ shouldComponentUpdate æˆ– componentWillUpdate ä¸­è°ƒç”¨ setStateï¼Œæ­¤æ—¶çš„çŠ¶æ€å·²ç»ä» RECEIVING_PROPS -&gt; NULLï¼Œåˆ™ performUpdateIfNecessary å°±ä¼šè°ƒç”¨ updateComponent è¿›è¡Œç»„ä»¶æ›´æ–°ï¼Œä½† updateComponent åˆä¼šè°ƒç”¨ shouldComponentUpdate å’Œ componentWillUpdateï¼Œå› æ­¤é€ æˆå¾ªç¯è°ƒç”¨ï¼Œä½¿å¾—æµè§ˆå™¨å†…å­˜å æ»¡åå´©æºƒã€‚äº§ç”Ÿå¦‚ä¸‹å›¾çš„è¿™ç§æ­»å¾ªç¯ï¼š setStateå…·ä½“æºç å¦‚ä¸‹æ‰€ç¤ºï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546// æ›´æ–° statesetState: function(partialState, callback) &#123; // åˆå¹¶ _pendingState this.replaceState( assign(&#123;&#125;, this._pendingState || this.state, partialState), callback );&#125;,// æ›´æ–° statereplaceState: function(completeState, callback) &#123; validateLifeCycleOnReplaceState(this); // æ›´æ–°é˜Ÿåˆ— this._pendingState = completeState; // åˆ¤æ–­çŠ¶æ€æ˜¯å¦ä¸º MOUNTINGï¼Œå¦‚æœä¸æ˜¯ï¼Œå³å¯æ‰§è¡Œæ›´æ–° if (this._compositeLifeCycleState !== CompositeLifeCycle.MOUNTING) &#123; ReactUpdates.enqueueUpdate(this, callback); &#125;&#125;,// å¦‚æœå­˜åœ¨ _pendingElementã€_pendingStateã€_pendingForceUpdateï¼Œåˆ™æ›´æ–°ç»„ä»¶performUpdateIfNecessary: function(transaction) &#123; var compositeLifeCycleState = this._compositeLifeCycleState; // å½“çŠ¶æ€ä¸º MOUNTING æˆ– RECEIVING_PROPSæ—¶ï¼Œåˆ™ä¸æ›´æ–° if (compositeLifeCycleState === CompositeLifeCycle.MOUNTING || compositeLifeCycleState === CompositeLifeCycle.RECEIVING_PROPS) &#123; return; &#125; var prevElement = this._currentElement; var nextElement = prevElement; if (this._pendingElement != null) &#123; nextElement = this._pendingElement; this._pendingElement = null; &#125; // è°ƒç”¨ updateComponent this.updateComponent( transaction, prevElement, nextElement );&#125; æ€»ç»“ï¼š React é€šè¿‡ä¸‰ç§çŠ¶æ€ï¼šMOUNTINGã€RECEIVE_PROPSã€UNMOUNTINGï¼Œç®¡ç†æ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„æ‰§è¡Œé¡ºåºï¼› setState ä¼šå…ˆè¿›è¡Œ _pendingState æ›´æ–°é˜Ÿåˆ—çš„åˆå¹¶æ“ä½œï¼Œä¸ä¼šç«‹åˆ» reRenderï¼Œå› æ­¤æ˜¯å¼‚æ­¥æ“ä½œï¼Œä¸”é€šè¿‡åˆ¤æ–­çŠ¶æ€ï¼ˆMOUNTINGã€RECEIVE_PROPSï¼‰æ¥æ§åˆ¶ reRender çš„æ—¶æœºï¼› ä¸å»ºè®®åœ¨ getDefaultPropsã€getInitialStateã€shouldComponentUpdateã€componentWillUpdateã€render å’Œ componentWillUnmount ä¸­è°ƒç”¨ setStateï¼Œç‰¹åˆ«æ³¨æ„ï¼šä¸èƒ½åœ¨ shouldComponentUpdate å’Œ componentWillUpdate ä¸­è°ƒç”¨ setStateï¼Œä¼šå¯¼è‡´å¾ªç¯è°ƒç”¨ã€‚","tags":[]},{"title":"promise è¯¦è§£","date":"2016-10-10T12:54:51.000Z","path":"2016/10/10/promise/","text":"è™½ç„¶ä¹‹å‰å†™äº†javascriptå¼‚æ­¥ç¼–ç¨‹ï¼Œä¸è¿‡æˆ‘å‘ç°å‘¨å›´çš„éƒ¨åˆ†å°ä¼™ä¼´ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬æˆ‘ï¼Œå¯¹promiseçš„è®¤è¯†è¿˜æ˜¯åªåœç•™åœ¨åŸºç¡€æ˜¯ä½¿ç”¨ï¼Œç±»ä¼¼äºajaxè¿™ç§çš„ä½¿ç”¨ï¼Œæˆ–è€…ä¼šç”¨promise.then()ï¼Œå¯¹äºåŸç”Ÿçš„Promiseå¯¹è±¡åªäº†è§£ä¸€ç‚¹ç”šè‡³ä¸äº†è§£ï¼Œæˆ‘ä¹Ÿæ˜¯æ¨¡æ¨¡ç³Šç³Šåœ°äº†è§£ï¼Œæ‰€ä»¥å‡†å¤‡å†™ä¸€ç¯‡å…³äºpromiseçš„åšå®¢ï¼Œé¡ºä¾¿ä¹Ÿå€Ÿæ­¤æœºä¼šä¸€ä¸¾å‡»ç ´promiseï¼Œä¸æƒ³å†æå¾—æ¨¡æ¨¡ç³Šç³Šçš„äº†ï¼Œå½»åº•å¾—è§£å†³æ‰è¿™ä¸ªä¸œè¥¿ã€‚ åœ¨å»å¹´ï¼Œå‡†ç¡®çš„è¯´æ˜¯åœ¨2015å¹´6æœˆï¼ˆæˆ‘ä¸“é—¨æŸ¥äº†çš„ï¼Œè‚¯å®šæ²¡æœ‰é”™ï¼‰ï¼ŒECMAScript6çš„æ­£å¼ç‰ˆå‘å¸ƒäº†ã€‚ECMAScript æ˜¯ JavaScript è¯­è¨€çš„å›½é™…æ ‡å‡†ï¼ŒJavaScript æ˜¯ ECMAScript çš„å®ç°ã€‚ES6 çš„ç›®æ ‡ï¼Œæ˜¯ä½¿å¾— JavaScript è¯­è¨€å¯ä»¥ç”¨æ¥ç¼–å†™å¤§å‹çš„å¤æ‚çš„åº”ç”¨ç¨‹åºï¼Œæˆä¸ºä¼ä¸šçº§å¼€å‘è¯­è¨€ã€‚ ES6çš„æ”¹å˜è¿˜æ˜¯ç®—ä¸å°çš„ï¼Œå…¶ä¸­å°±åŒ…å«äº†æä¾›Promiseå¯¹è±¡ã€‚ Promiseæ˜¯ä»€ä¹ˆï¼Ÿé¦–å…ˆï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„ä½œç”¨æ˜¯ç”¨æ¥è¿›è¡Œå¼‚æ­¥æ“ä½œï¼Œä»£è¡¨ç€æŸä¸ªå¼‚æ­¥è¿›è¡Œçš„äº‹ä»¶çš„ç»“æœã€‚ Promiseå¯¹è±¡æœ‰ä»¥ä¸‹ä¸¤ä¸ªç‰¹ç‚¹ï¼š ï¼ˆ1ï¼‰ï¼Œå¯¹è±¡çš„çŠ¶æ€ä¸å—å¤–ç•Œçš„å½±çº¿ã€‚Promiseå¯¹è±¡ä»£è¡¨ä¸€ä¸ªå¼‚æ­¥çš„æ“ä½œï¼Œå®ƒåŒ…å«äº†ä¸‰ç§çŠ¶æ€ï¼Œåˆ†åˆ«æ˜¯ï¼šPendingï¼ˆè¿›è¡Œä¸­ï¼‰ï¼ŒResolveï¼ˆå·²å®Œæˆï¼‰ï¼ŒRejectï¼ˆå·²å¤±è´¥ï¼‰ã€‚è€Œå¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œå†³å®šäº†å®ƒå°†ä¼šè¾“å‡ºå“ªä¸€ç§çŠ¶æ€ï¼Œä»»ä½•å…¶å®ƒæ“ä½œéƒ½æ— æ³•æ”¹å˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™ä¹Ÿæ˜¯Promiseåå­—çš„ç”±æ¥ï¼Œä¹Ÿå°±æ˜¯æ‰¿è¯ºçš„æ„æ€ï¼Œä»£è¡¨ä¸€å®šä¼šå»åšã€‚ ï¼ˆ2ï¼‰ï¼Œä¸€æ—¦çŠ¶æ€æ”¹å˜ï¼Œå°±ä¸ä¼šå†å˜ã€‚è™½ç„¶Promiseä¸å—å¤–ç•Œå½±å“çŠ¶æ€ï¼Œä¸è¿‡çŠ¶æ€æ˜¯ä¼šåœ¨å†…éƒ¨è¿›è¡Œæ”¹å˜çš„ï¼Œå®ƒæœ‰ä¸¤ç§æ”¹å˜çŠ¶æ€çš„å¯èƒ½ï¼Œä¸€ç§æ˜¯ä»è¿›è¡Œä¸­å˜ä¸ºå·²å®Œæˆï¼ˆPending to Resolveï¼‰ï¼Œå¦ä¸€ç§æ˜¯ä»è¿›è¡Œä¸­å˜ä¸ºå·²å¤±è´¥ï¼ˆPending to Rejectï¼‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒçŠ¶æ€ä¸ä¼šå†å‘ç”Ÿå…¶å®ƒçš„å˜åŒ–ã€‚ æœ‰äº† Promise å¯¹è±¡ï¼Œå°±å¯ä»¥å°†å¼‚æ­¥æ“ä½œä»¥åŒæ­¥æ“ä½œçš„æµç¨‹è¡¨è¾¾å‡ºæ¥ï¼Œé¿å…äº†å±‚å±‚åµŒå¥—çš„å›è°ƒå‡½æ•°ã€‚æ­¤å¤–ï¼ŒPromise å¯¹è±¡æä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œä½¿å¾—æ§åˆ¶å¼‚æ­¥æ“ä½œæ›´åŠ å®¹æ˜“ã€‚ CODEâ€œtalk is cheap,show me the codeâ€. è¿™æ˜¯ç¨‹åºå‘˜ç•Œæ¯”è¾ƒå¸¸è§çš„ä¸€å¥è¯ï¼Œä¸Šé¢å¾ˆå¤šæ¦‚å¿µå•Šè¿™äº›æ­»çŸ¥è¯†è®²è§£å®Œäº†ï¼Œä¸‹é¢æ‰å¼€å§‹è¿›å…¥æ­£é¢˜ï¼Œå¼€å§‹ä»£ç æ¼”ç¤ºã€‚ ç”±äºPromiseå·²ç»æ˜¯JSåŸç”Ÿå¯¹è±¡äº†ï¼Œæ‰€ä»¥ç›´æ¥æ‰“å¼€æµè§ˆå™¨çš„æ§åˆ¶å°ï¼Œè¾“å…¥Promiseï¼Œå°±å¯ä»¥çœ‹åˆ°ä¸€ä¸ªfunction Promiseï¼Œå¦‚æœæŠ¥é”™çš„è¯ï¼Œè¯´æ˜ä½ çš„æµè§ˆå™¨è¯¥å‡çº§äº†ã€‚ 1234567var promise = new Promise(function(resolve, reject) &#123; if (/* å¼‚æ­¥æ“ä½œæˆåŠŸ */)&#123; resolve(value); &#125; else &#123; reject(error); &#125;&#125;); å¦‚ä¸Šé¢çš„åŸºæœ¬ä»£ç æ‰€ç¤ºï¼ŒPromiseæ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯resolveå’Œrejectæ–¹æ³•ï¼Œå¦‚æœå¼‚æ­¥æ“ä½œæˆåŠŸäº†ï¼Œåˆ™è°ƒç”¨resolveæ–¹æ³•ï¼Œå°†Promiseå¯¹è±¡çš„çŠ¶æ€ä»Pendingæ”¹ä¸ºResolveï¼Œå¦‚æœå¼‚æ­¥æ“ä½œå¤±è´¥ï¼Œåˆ™è°ƒç”¨rejectæ–¹æ³•ï¼Œå°†Promiseå¯¹è±¡çš„çŠ¶æ€ä»Pendingæ”¹ä¸ºRejectã€‚è¿™æ˜¯promiseæœ€åŸºæœ¬çš„ä½¿ç”¨æ–¹æ³•ã€‚ promiseçš„ç¥å¥‡ä¹‹å¤„åœ¨äºç»™äº†æˆ‘ä»¬returnå’Œthrowï¼Œæ¯ä¸ªpromiseéƒ½ä¼šæä¾›ä¸€ä¸ªthenå‡½æ•°å’Œä¸€ä¸ªcatchå‡½æ•°ï¼Œå®é™…ä¸Šæ˜¯then(null,â€¦)å‡½æ•°ã€‚åŸºæœ¬ä»£ç å¦‚ä¸‹ï¼š 1234promiseOne.then(function(value)&#123; alert(value); // è¿™ä¸ªvalueæ˜¯promiseOneä¸­resolveä¼ é€’å‡ºæ¥çš„å€¼ã€‚ // do something&#125;); åœ¨è¿™ä¸ªthenå‡½æ•°é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥åšä¸‰ä»¶äº‹ï¼Œ1ï¼Œreturn å¦ä¸€ä¸ªpromiseï¼›2ï¼Œreturn ä¸€ä¸ªåŒæ­¥çš„å€¼ï¼›3ï¼Œthrow ä¸€ä¸ªåŒæ­¥å¼‚å¸¸ï¼Œâ€˜ throw new Error(â€˜â€™) â€™ã€‚ ä¸‹é¢æ˜¯ä¸€äº›Promiseçš„åŸºæœ¬APIã€‚ 1234561,Promise.resolve()2,Promise.reject()3,Promise.prototype.then()4,Promise.prototype.catch()5,Promise.all([functionOne,functionTwo,...]) // æ‰€æœ‰çš„å®Œæˆ6,Promise.race([functionOne,functionTwo,...]) // ç«é€Ÿï¼Œå®Œæˆä¸€ä¸ªå³å¯ Promise.resolveå’ŒPromise.rejectæ˜¯Promiseçš„é™æ€æ–¹æ³•ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š 1234567891011121314Promise.resolve(&quot;value&quot;).then(function(v) &#123; console.log(v,1); &#125;, function(v) &#123; // ä¸ä¼šè¢«è°ƒç”¨console.log(v,2);&#125;);// è¿™æ—¶æ§åˆ¶å°ä¼šè¾“å‡º value,1Promise.resolve(&quot;value&quot;).then(function(v) &#123; console.log(v,1); &#125;, function(v) &#123; console.log(v,2);&#125;);// è¿™æ—¶æ§åˆ¶å°ä¼šè¾“å‡º value,2 ä¹Ÿå°±æ˜¯è¯´ï¼ŒPromise.resolveé‡Œä¼ å…¥çš„å‚æ•°æˆ–è€…promiseå¯¹è±¡ï¼Œä¼šè¢«thenæ–¹æ³•æ¥æ”¶ï¼ŒPromise.rejecté‡Œä¼ å…¥çš„å‚æ•°æˆ–è€…promiseå¯¹è±¡ï¼Œä¼šè¢«catchæ–¹æ³•æ¥æ”¶ï¼Œè¿™ä¸€ç‚¹åœ¨ä¸Šé¢çš„new Promise((resolve,reject)=&gt;{if(â€¦){resolve(v)}else{reject(v)}})å·²ç»è®²è¿‡äº†ï¼Œæ„æ€æ˜¯ä¸€æ ·çš„ï¼Œä¸åŒä¹‹å¤„åœ¨äºä½¿ç”¨çš„æ–¹å¼ä¸åŒï¼Œä¸‹é¢çš„æ–¹æ³•æ˜¯ç›´æ¥è°ƒç”¨çš„promiseé‡Œçš„é™æ€æ–¹æ³•ï¼Œè€Œæ²¡æœ‰ç”¨åˆ°promiseè¿™ä¸ªæ„é€ å‡½æ•°ã€‚ é™¤äº†è¿”å›åŸºæœ¬æ•°æ®å¤–ï¼Œä¸€ä¸ªpromiseé‡Œé¢ä¹Ÿå¯ä»¥è¿”å›å¦ä¸€ä¸ªpromiseå¯¹è±¡ã€‚ 123456var original = Promise.resolve(true);var cast = Promise.resolve(original);cast.then(function(v) &#123; console.log(v); &#125;);// æ§åˆ¶å°ä¼šè¾“å‡º true æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨promiseä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œè¿™é‡Œæœ‰åŒæ­¥ä»£ç å¼‚å¸¸å’Œå¼‚æ­¥ä»£ç å¼‚å¸¸ä¸¤ç§ã€‚ è¿™æ˜¯åŒæ­¥ä»£ç å¼‚å¸¸ï¼Œç›´æ¥è°ƒç”¨promiseçš„rejectæ–¹æ³•ï¼Œä¼ å…¥ä¸€ä¸ªerrorå°±å¥½äº†ï¼š 1Promise.reject(new Error(&quot;ä»€ä¹ˆé¬¼&quot;)); ä¸‹é¢æ˜¯å¼‚æ­¥ä»£ç å¼‚å¸¸ï¼š 12345new Promise(function (resolve, reject) &#123; throw new Error(&apos;æ‚²å‰§äº†ï¼Œåˆå‡º bug äº†&apos;); &#125;).catch(function(err)&#123; console.log(err); &#125;); å¦‚æœæœ‰å¤šä¸ªcallbackå‡½æ•°è¿ç»­å›è°ƒï¼Œå¯ä»¥åˆ†åˆ«å†™æˆpromiseçš„çŠ¶æ€ï¼Œç„¶ååœ¨æ¯ä¸€ä¸ªpromiseå¯¹è±¡ä¸­returnä¸‹ä¸€ä¸ªpromiseï¼Œfor example: 123456789101112131415161718192021222324252627282930313233343536373839var p1 = new Promise((resolve,reject)=&gt;&#123; resolve(1);&#125;);var p2 = new Promise((resolve,reject)=&gt;&#123; resolve(p1);&#125;);var p3 = new Promise((resolve,reject)=&gt;&#123; resolve(p2);&#125;);p3.then(function(v) &#123; console.log(v); // true&#125;);// ä¸Šé¢æ˜¯promiseé“¾å¼è°ƒç”¨çš„ä¸€ç§æƒ…å†µï¼Œä¸‹é¢æ˜¯å¦ä¸€ç§æƒ…å†µï¼Œå…¶æ ¸å¿ƒåŸå› éƒ½æ˜¯å·®ä¸å¤šçš„ã€‚var p1 = (resolve,reject)=&gt;&#123; resolve(1);&#125;var p2 = (resolve,reject)=&gt;&#123; resolve(2);&#125;var p3 = (resolve,reject)=&gt;&#123; resolve(3);&#125;new Promise(p3).then(function(v) &#123; console.log(v); return new Promise(p2).then((v)=&gt;&#123; console.log(v) return new Promise(p1).then((v)=&gt;&#123; console.log(v) &#125;) &#125;)&#125;)","tags":[]},{"title":"javascriptå¼‚æ­¥ç¼–ç¨‹ï¼ˆç»­ï¼‰","date":"2016-09-20T11:49:07.000Z","path":"2016/09/20/javascriptå¼‚æ­¥ç¼–ç¨‹ï¼ˆç»­ï¼‰/","text":"ä¹‹å‰é‚£ç¯‡æ–‡ç« è®²è§£äº†javascriptå¼‚æ­¥å¼ç¼–ç¨‹çš„å‡ ä¸ªæ–¹æ³•ï¼Œæ¯”å¦‚æœ‰å›è°ƒå‡½æ•°ï¼Œpromiseï¼Œå‘å¸ƒï¼è®¢é˜…æ¨¡å¼ï¼Œgeneratorå‡½æ•°ç­‰ï¼Œæ¯ä¸€ç§æ–¹å¼ï¼Œåœ¨å…¶å¹¿æ³›ä½¿ç”¨çš„æ—¶æœŸï¼Œéƒ½æ˜¯å¾ˆå®Œå–„çš„ä¸€ç§æ–¹å¼ï¼Œä¸è¿‡ç”±äºæ—¶ä»£çš„è¿›æ­¥ï¼ŒæŠ€æœ¯çš„å‘å±•ï¼Œç¼ºç‚¹æ€»ä¼šæš´éœ²å‡ºæ¥ï¼Œæ›´å¥½æ›´å®Œå–„çš„æ–¹æ³•ä¹Ÿä¼šè¢«åˆ›é€ å‡ºæ¥ã€‚ è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘å°±æƒ³æ¥è¯´è¯´asyncå‡½æ•°ã€‚ ES7æ„è§å¾é›†ç¨¿ä¸­æä¾›äº†asyncå‡½æ•°ï¼Œè¿™æ˜¯ä»€ä¹ˆï¼Ÿå…¶å®å¯ä»¥ç”¨ä¸€å¥è¯æ¥æ¦‚æ‹¬ï¼Œasyncå‡½æ•°å°±æ˜¯Generatorå‡½æ•°çš„è¯­æ³•ç³–ã€‚ æˆ‘ä»¬ä»Generatorå‡½æ•°å¼€å§‹ï¼Œä»£ç å¦‚ä¸‹ã€‚ 123456789101112131415161718192021222324252627// è¿™æ˜¯é‡‡ç”¨fsæ¨¡å—æ¥å¼‚æ­¥è¯»å–æ–‡ä»¶var fs = require(&apos;fs&apos;);var readFile = function (fileName) &#123; return new Promise(function (resolve, reject) &#123; fs.readFile(fileName, function(error, data) &#123; if (error) reject(error); resolve(data); &#125;); &#125;);&#125;;// è¿™æ˜¯ä½¿ç”¨generatorå‡½æ•°çš„æ–¹æ³•ï¼Œä¾æ¬¡è¯»å–ä¸¤ä¸ªæ–‡ä»¶var gen = function* ()&#123; var f1 = yield readFile(&apos;/etc/fstab&apos;); var f2 = yield readFile(&apos;/etc/shells&apos;); console.log(f1.toString()); console.log(f2.toString());&#125;;// ä¸‹é¢æ˜¯asyncå‡½æ•°çš„å†™æ³•var asyncReadFile = async function ()&#123; var f1 = await readFile(&apos;/etc/fstab&apos;); var f2 = await readFile(&apos;/etc/shells&apos;); console.log(f1.toString()); console.log(f2.toString());&#125;; å…¶å®ä¸€æ¯”è¾ƒï¼Œå·®å¼‚å¾ˆæ˜æ˜¾ï¼Œasyncå‡½æ•°å°±æ˜¯å°†generatorå‡½æ•°çš„æ˜Ÿå·æ›¿æ¢æˆäº†asyncï¼Œå°†yieldæ›¿æ¢æˆäº†awaitã€‚ ä»…æ­¤è€Œå·²ï¼ä»…æ­¤è€Œå·²ï¼Ÿ è™½ç„¶åŠ å…¥äº†æ¯”è¾ƒå¥½çœ‹çš„è¯­æ³•ç³–ï¼Œä¸è¿‡ä¸€ä¸ªæ–°çš„æ–¹æ³•å¦‚æœåªæ˜¯æ¯”è€çš„æ–¹æ³•å‘½åå¥½å¬ï¼Œæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿä¸‹é¢æˆ‘æ¥è¯´ä¸€ä¸‹asyncå‡½æ•°å’Œgeneratorå‡½æ•°çš„ä¸»è¦åŒºåˆ«å§ã€‚ æ›´å¥½çš„è¯­ä¹‰ã€‚æ—¢ç„¶éƒ½çœ‹å‡ºæ¥äº†ï¼Œé‚£æœ€æ˜æ˜¾çš„å½“ç„¶æ˜¯æ ‡å¿—ç¬¦æ¢äº†ï¼Œä¹Ÿå°±æ˜¯æ›´åŠ è¯­ä¹‰åŒ–äº†ï¼Œawaitå’Œasyncæ¯”æ˜Ÿå·è·Ÿyieldæ›´åŠ è®©äººå¥½ç†è§£ã€‚ æ›´å¥½çš„é€‚ç”¨æ€§ã€‚generatorå‡½æ•°çš„æ‰§è¡Œå¿…é¡»ä¾é æ‰§è¡Œå™¨ï¼Œæˆ–è€…äººä¸ºçš„å¤šæ¬¡è°ƒç”¨nextæ–¹æ³•æ‰èƒ½ç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œè€Œasyncæ˜¯è‡ªå¸¦æ‰§è¡Œå™¨çš„ï¼Œè¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæ„æ€å°±æ˜¯ä½ å†ä¹Ÿä¸ç”¨ç®¡ä»€ä¹ˆnextäº†ï¼Œä¹Ÿä¸ç”¨ç®¡æ€ä¹ˆå¼‚æ­¥æ‰§è¡Œäº†ï¼Œä½ å®Œå®Œå…¨å…¨å°±å¯ä»¥æŠŠasyncå‡½æ•°å°±å½“åšæ™®é€šçš„å‡½æ•°æ¥çœ‹æ¥ï¼Œå½“ä½ æƒ³æ‰§è¡Œçš„æ—¶å€™ï¼Œåªéœ€è¦ä¸€å¥var result = async();å°±å¯ä»¥äº†ï¼Œå¥¹ä¼šè‡ªåŠ¨è°ƒç”¨asyncå‡½æ•°å¹¶ä¸”è‡ªåŠ¨æ‰§è¡Œï¼Œè¾“å‡ºæœ€åç»“æœï¼Œä½ ç°åœ¨å¯ä»¥å°†ä»€ä¹ˆnextæ–¹æ³•å•Šï¼Œcoæ¨¡å—è¿™äº›å…¨éƒ¨æ”¾ä¸€è¾¹äº†ã€‚ è¿”å›å€¼æ˜¯promiseã€‚asyncå‡½æ•°çš„è¿”å›å€¼æ˜¯promiseå¯¹è±¡ï¼Œè¿™æ¯”generatorå‡½æ•°çš„è¿”å›ä¸€ä¸ªIteratorå¯¹è±¡æ–¹ä¾¿å¤šäº†ï¼Œä½ å¯ä»¥ä½¿ç”¨promiseé‡Œçš„thenæ–¹æ³•æ¥è¿›è¡Œä¸‹ä¸€æ­¥çš„æ“ä½œã€‚è€Œasyncå‡½æ•°å®Œå…¨å¯ä»¥çœ‹ä½œæ˜¯å¤šä¸ªå¼‚æ­¥çš„æ“ä½œï¼ŒåŒ…è£…æˆäº†ä¸€ä¸ªpromiseå¯¹è±¡ï¼Œè€Œawaitå°±æ˜¯thenæ–¹æ³•çš„è¯­æ³•ç³–ã€‚ ä¸‹é¢æ˜¯ä¸€äº›asyncå‡½æ•°çš„å…·ä½“ä½¿ç”¨ç¤ºä¾‹ã€‚ 1ï¼Œä¸‹é¢ä»£ç ä¸­ï¼Œå‡½æ•°fä¸­returnçš„æ•°æ®ï¼Œä¼šè¢«promiseçš„thenæ–¹æ³•çš„å›è°ƒå‡½æ•°è·å–åˆ°ï¼Œæ‰€ä»¥thenæ–¹æ³•å›è°ƒå‡½æ•°é‡Œçš„å‚æ•°vå°±æ˜¯æŒ‡ä»£çš„få‡½æ•°çš„returnçš„æ•°æ®ï¼Œæ‰€ä»¥æ§åˆ¶å°æ‰ä¼šæ‰“å°å‡ºhello world 123456async function f() &#123; return &apos;hello world&apos;;&#125;f().then(v =&gt; console.log(v))// æ‰“å¼€æ§åˆ¶å°ï¼Œä½ å°±ä¼šçœ‹è§æœ‰ä¸€å¥hello worldï¼ˆå‰ææ˜¯ä½ çš„æµè§ˆå™¨æ”¯æŒasyncï¼‰ 2ï¼Œasyncå‡½æ•°å†…éƒ¨æŠ›å‡ºé”™è¯¯ï¼Œä¼šå¯¼è‡´è¿”å›çš„promiseå¯¹è±¡å˜ä¸ºrejectçŠ¶æ€ï¼ŒæŠ›å‡ºçš„é”™è¯¯å¯¹è±¡ï¼Œä¼šè¢«catchæ–¹æ³•çš„å›è°ƒå‡½æ•°æ•æ‰åˆ°ã€‚ 123456789async function f() &#123; throw new Error(&apos;å‡ºé”™äº†&apos;);&#125;f().then( v =&gt; console.log(v), e =&gt; console.log(e))// Error: å‡ºé”™äº† 3ï¼Œasyncå‡½æ•°è¿”å›çš„promiseå¯¹è±¡ï¼Œå¿…é¡»è¦ç­‰åˆ°å†…éƒ¨awaitå‘½ä»¤çš„promiseå¯¹è±¡æ‰§è¡Œå®Œï¼Œæ‰ä¼šå‘ç”ŸçŠ¶æ€çš„æ”¹å˜ï¼Œæ¢å¥è¯è¯´ï¼Œä¹Ÿå°±æ˜¯asyncå‡½æ•°å†…éƒ¨çš„awaitå‘½ä»¤æ‰§è¡Œå®Œäº†ï¼Œæ‰ä¼šæ‰§è¡Œthenæ–¹æ³•çš„å›è°ƒå‡½æ•°ã€‚å¦‚ä¸‹é¢çš„ä¾‹å­ã€‚ 1234567async function getTitle(url) &#123; let response = await fetch(url); let html = await response.text(); return html.match(/&lt;title&gt;([\\s\\S]+)&lt;\\/title&gt;/i)[1];&#125;getTitle(&apos;https://tc39.github.io/ecma262/&apos;).then(console.log)// &quot;ECMAScript 2017 Language Specification&quot; 4ï¼Œåœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œawaitåé¢åº”è¯¥æ˜¯ä¸€ä¸ªpromiseå¯¹è±¡ï¼Œå¦‚æœä¸æ˜¯ï¼Œé‚£ä¹ˆä¼šè¢«è½¬å˜ä¸ºä¸€ä¸ªç«‹å³resolveçš„promiseå¯¹è±¡ã€‚ 123456async function f() &#123; return await 123;&#125;f().then(v =&gt; console.log(v))// 123ï¼Œè¿™é‡Œawaitåé¢çš„123è™½ç„¶ä¸æ˜¯promiseå¯¹è±¡ï¼Œä¸è¿‡å®ƒä¼šè½¬å˜ä¸ºpromiseå¯¹è±¡å¹¶ç«‹å³è¢«resolveï¼Œæ‰€ä»¥åœ¨åé¢çš„thenæ–¹æ³•çš„å›è°ƒå‡½æ•°é‡Œï¼Œä¾ç„¶å¯ä»¥æ­£å¸¸çš„è¿è¡Œã€‚ 5ï¼Œasyncå‡½æ•°è¿”å›çš„promiseå¯¹è±¡ï¼Œå¦‚æœå˜ä¸ºäº†rejectçŠ¶æ€ï¼Œåˆ™rejectçš„å‚æ•°ä¼šè¢«catchæ–¹æ³•çš„å›è°ƒå‡½æ•°æ¥æ”¶åˆ°ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š 12345678async function f() &#123; await Promise.reject(&apos;å‡ºé”™äº†&apos;);&#125;f().then(v =&gt; console.log(v)).catch(e =&gt; console.log(e))// å‡ºé”™äº†ã€‚ä¸Šé¢çš„awaitå‰é¢æ²¡æœ‰returnè¯­å¥ï¼Œä½†æ˜¯rejectçŠ¶æ€çš„å‚æ•°ä¾ç„¶ä¼ å…¥äº†catchæ–¹æ³•çš„å›è°ƒå‡½æ•°é‡Œï¼Œæ‰€ä»¥è¯´è¿™é‡Œæœ‰æ²¡æœ‰returnéƒ½æ˜¯ä¸å½±å“çš„ï¼Œä¸è¿‡ä¸ºäº†ç»Ÿä¸€ä¸è§„èŒƒï¼Œè¿˜æ˜¯å»ºè®®åŠ ä¸Šã€‚ 6ï¼Œåªæœ‰ç¨‹åºå‘ç°äº†ä¸€ä¸ªpromiseå‡½æ•°çš„çŠ¶æ€å˜ä¸ºäº†rejectï¼Œé‚£ä¹ˆåé¢çš„ä»£ç å°†ä¸ä¼šæ‰§è¡Œã€‚ 123456789101112131415161718192021222324252627282930313233async function f() &#123; await Promise.reject(&apos;å‡ºé”™äº†&apos;); await Promise.resolve(&apos;hello world&apos;); // è¿™å¥å°†ä¸ä¼šæ‰§è¡Œ&#125;// æ‰€ä»¥ä¸ºäº†é¿å…è¿™ç§æƒ…å†µå‘ç”Ÿï¼Œå¯ä»¥å°†ç¬¬ä¸€ä¸ªawaitæ”¾åœ¨try...catch...è¯­å¥ä¸­ï¼Œè¿™æ ·ä»£ç çš„æ‰§è¡Œå°±ä¸ä¼šè¢«ä¸­æ–­ã€‚async function f() &#123; try &#123; await Promise.reject(&apos;å‡ºé”™äº†&apos;); &#125; catch(e) &#123; &#125; return await Promise.resolve(&apos;hello world&apos;);&#125;f().then(v =&gt; console.log(v))// hello world// å¦ä¸€ç§è§£å†³åŠæ³•å°±æ˜¯åœ¨awaitåé¢çš„promiseå¯¹è±¡åŠ ä¸Šä¸€ä¸ªcatchæ–¹æ³•ï¼Œæ¥å¤„ç†å‰é¢å¯èƒ½ä¼šå‡ºç°çš„é”™è¯¯ï¼Œä»£ç å¦‚ä¸‹ã€‚async function f() &#123; await Promise.reject(&apos;å‡ºé”™äº†&apos;) .catch(e =&gt; console.log(e)); return await Promise.resolve(&apos;hello world&apos;);&#125;f().then(v =&gt; console.log(v))// å‡ºé”™äº†// hello world// å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å¤šä¸ªawaitå‘½ä»¤æ”¾è¿›catchæ–¹æ³•é‡Œï¼Œè¿™æ®µä»£ç å°±çœç•¥äº†ã€‚ã€‚ã€‚ 7ï¼Œå¦‚æœawaitåé¢çš„å¼‚æ­¥æ“ä½œå‡ºé”™ï¼Œé‚£ä¹ˆå°±ç­‰åŒäºpromiseå¯¹è±¡çŠ¶æ€å˜ä¸ºrejectã€‚ 12345678910async function f() &#123; await new Promise(function (resolve, reject) &#123; throw new Error(&apos;å‡ºé”™äº†&apos;); &#125;);&#125;f().then(v =&gt; console.log(v)).catch(e =&gt; console.log(e))// Errorï¼šå‡ºé”™äº† ä¸Šé¢è¯´äº†é‚£ä¹ˆå¤šçš„ç¤ºä¾‹ï¼Œéƒ½æ˜¯æ¯”è¾ƒç‰‡é¢çš„è®²è§£ä½¿ç”¨ä¸­çš„æ³¨æ„äº‹é¡¹ï¼Œå®Œæ•´çš„ç¤ºä¾‹æ¥è®²è§£asyncå‡½æ•°çš„ä½¿ç”¨æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä¸‹é¢ä¼šä¸»è¦è®²asyncå‡½æ•°çš„ä½¿ç”¨ã€‚ 1ï¼Œä¸Šé¢ä»£ç æ˜¯ä¸€ä¸ªè·å–è‚¡ç¥¨æŠ¥ä»·çš„å‡½æ•°ï¼Œå‡½æ•°å‰é¢çš„asyncå…³é”®å­—ï¼Œè¡¨æ˜è¯¥å‡½æ•°å†…éƒ¨æœ‰å¼‚æ­¥æ“ä½œã€‚è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œä¼šç«‹å³è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ã€‚ 12345678910async function getStockPriceByName(name) &#123; var symbol = await getStockSymbol(name); var stockPrice = await getStockPrice(symbol); return stockPrice;&#125;getStockPriceByName(&apos;goog&apos;).then(function (result) &#123; console.log(result);&#125;);// æœ€åæ‰“å°å‡ºçš„è¿™ä¸ªresultå°±æ˜¯getStockPriceByNameå‡½æ•°ä¸­returnçš„stockPriceã€‚ 2ï¼Œä¸‹é¢ä»£ç æŒ‡å®š50æ¯«ç§’ä»¥åï¼Œè¾“å‡ºâ€hello worldâ€ã€‚ 123456789101112function timeout(ms) &#123; return new Promise((resolve) =&gt; &#123; setTimeout(resolve, ms); &#125;);&#125;async function asyncPrint(value, ms) &#123; await timeout(ms); console.log(value)&#125;asyncPrint(&apos;hello world&apos;, 50); åä¸€å›½åº†èŠ‚æ¥å…¬å¸åŸºæœ¬æ²¡äººï¼ŒåèƒŒä¹Ÿæ„Ÿåˆ°ä¸€é˜µé˜µå‡‰é£ï¼Œè¿™ç¯‡åšå®¢å°±å…ˆè®²åˆ°è¿™é‡Œå§ï¼Œæœ‰ä»€ä¹ˆå®Œå–„çš„åœ°æ–¹åé¢æˆ‘ä¼šå†ç»§ç»­è¡¥å……çš„ã€‚","tags":[]},{"title":"javascriptå¼‚æ­¥ç¼–ç¨‹","date":"2016-09-09T12:29:36.000Z","path":"2016/09/09/javascriptå¼‚æ­¥ç¼–ç¨‹/","text":"æœ€è¿‘nodejsçœ‹å¾—æœ‰ç‚¹å¤šï¼Œæ„Ÿè§‰æ»¡è„‘å­éƒ½æ˜¯æ–‡ä»¶å¤„ç†ï¼Œå¼‚æ­¥ç¼–ç¨‹ï¼Œbufferç­‰ï¼Œå‘ç°å­¦nodeå­¦å¤šäº†ï¼Œå‰ç«¯ç”¨åˆ°çš„javascriptä¹Ÿä¼šæ›´åŠ è±ç„¶å¼€æœ—ï¼Œç‰¹åˆ«æ˜¯å»–é›ªå³°å’Œé˜®ä¸€å³°è€å¸ˆçš„åšå®¢ï¼Œç»™äº†æˆ‘ä¸å°çš„å¸®åŠ©ã€‚æˆ‘æƒ³ä»nodejså¼€å§‹è¯´èµ·ï¼Œæ¯•ç«Ÿè¿™æ‰æ˜¯ç¼–ç¨‹çš„æ ¸å¿ƒï¼Œç°åœ¨å‘ç°å‰ç«¯ç”¨çš„jsåªæ˜¯ç†Ÿç»ƒè¿ç”¨onclickäº‹ä»¶ç­‰ï¼Œè‡ªå·±ä»¥å‰è¿˜æ˜¯åªæ¥è§¦åˆ°äº†çš®æ¯›å•Šã€‚ å›åˆ°ä¸»é¢˜ï¼Œæ®ä¼ å½“åˆRyan Dahlé€‰æ‹©jsæ¥ä½œä¸ºåå°è¯­è¨€æ—¶ï¼Œä¸»è¦å°±æ˜¯çœ‹é‡äº†jsçš„å•çº¿ç¨‹ï¼ŒåŒæ­¥è¿è¡Œï¼Œé€‚åˆä¸€äº›é«˜å¹¶å‘çš„åœºæ™¯ï¼Œè¿™å°±ä»ä¾§é¢è¯´æ˜äº†jsè¿™é—¨è¯­è¨€çš„ç‰¹æ€§ï¼šåŒæ­¥ï¼Œå•çº¿ç¨‹ã€‚é‚£ä¹ˆå¯ä»¥å¤šçº¿ç¨‹å¼‚æ­¥ç¼–ç¨‹å—ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯è‚¯å®šï¼Œé‚£ä¹ˆï¼Œjså¼‚æ­¥ç¼–ç¨‹æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Œè¿™å‡ ç§æ–¹æ³•å„è‡ªçš„ä¼˜ç¼ºç‚¹åˆå¦‚ä½•å‘¢ï¼Ÿ è¯´åˆ°è¿™é‡Œï¼Œæˆ‘åˆæƒ³è§£é‡Šä¸€ä¸‹åŒæ­¥ä¸å¼‚æ­¥ï¼Œç¬¬ä¸€æ¬¡å¬åˆ°è¿™ä¸¤ä¸ªè¯è¯­ï¼Œå°±è¦å¾—è¿½æº¯åˆ°å¤§å­¦çš„æ“ä½œç³»ç»Ÿè¯¾å ‚äº†ï¼ŒOSçš„è¿è¡Œæœºåˆ¶ï¼ˆè¿è¡Œæ¨¡å¼ï¼‰åˆ†ä¸ºåŒæ­¥ï¼ˆSynchronousï¼‰å’Œå¼‚æ­¥ï¼ˆAsynchronousï¼‰ã€‚ â€œåŒæ­¥æ¨¡å¼â€å°±æ˜¯ä¸Šä¸€æ®µçš„æ¨¡å¼ï¼Œåä¸€ä¸ªä»»åŠ¡ç­‰å¾…å‰ä¸€ä¸ªä»»åŠ¡ç»“æŸï¼Œç„¶åå†æ‰§è¡Œï¼Œç¨‹åºçš„æ‰§è¡Œé¡ºåºä¸ä»»åŠ¡çš„æ’åˆ—é¡ºåºæ˜¯ä¸€è‡´çš„ã€åŒæ­¥çš„ï¼›â€å¼‚æ­¥æ¨¡å¼â€åˆ™å®Œå…¨ä¸åŒï¼Œæ¯ä¸€ä¸ªä»»åŠ¡æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå›è°ƒå‡½æ•°ï¼ˆcallbackï¼‰ï¼Œå‰ä¸€ä¸ªä»»åŠ¡ç»“æŸåï¼Œä¸æ˜¯æ‰§è¡Œåä¸€ä¸ªä»»åŠ¡ï¼Œè€Œæ˜¯æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œåä¸€ä¸ªä»»åŠ¡åˆ™æ˜¯ä¸ç­‰å‰ä¸€ä¸ªä»»åŠ¡ç»“æŸå°±æ‰§è¡Œï¼Œæ‰€ä»¥ç¨‹åºçš„æ‰§è¡Œé¡ºåºä¸ä»»åŠ¡çš„æ’åˆ—é¡ºåºæ˜¯ä¸ä¸€è‡´çš„ã€å¼‚æ­¥çš„ã€‚â€å¼‚æ­¥æ¨¡å¼â€éå¸¸é‡è¦ã€‚åœ¨æµè§ˆå™¨ç«¯ï¼Œè€—æ—¶å¾ˆé•¿çš„æ“ä½œéƒ½åº”è¯¥å¼‚æ­¥æ‰§è¡Œï¼Œé¿å…æµè§ˆå™¨å¤±å»å“åº”ï¼Œæœ€å¥½çš„ä¾‹å­å°±æ˜¯Ajaxæ“ä½œã€‚åœ¨æœåŠ¡å™¨ç«¯ï¼Œâ€å¼‚æ­¥æ¨¡å¼â€ç”šè‡³æ˜¯å”¯ä¸€çš„æ¨¡å¼ï¼Œå› ä¸ºæ‰§è¡Œç¯å¢ƒæ˜¯å•çº¿ç¨‹çš„ï¼Œå¦‚æœå…è®¸åŒæ­¥æ‰§è¡Œæ‰€æœ‰httpè¯·æ±‚ï¼ŒæœåŠ¡å™¨æ€§èƒ½ä¼šæ€¥å‰§ä¸‹é™ï¼Œå¾ˆå¿«å°±ä¼šå¤±å»å“åº”ã€‚ æ‰€ä»¥é’ˆå¯¹jsçš„å¼‚æ­¥ç¼–ç¨‹æ–¹æ³•ï¼Œæˆ‘å‡†å¤‡è®²è§£å¦‚ä¸‹å‡ ä¸ªæ–¹æ³•ï¼š ä¸€ï¼Œå›è°ƒå‡½æ•°è¿™æ˜¯å¼‚æ­¥ç¼–ç¨‹æœ€æœ€æœ€åŸºæœ¬çš„æ–¹æ³•ï¼Œå‡ ä¹æ‰€æœ‰èƒ½å¼‚æ­¥ç¼–ç¨‹çš„è¯­è¨€éƒ½å¯ä»¥ç”¨åˆ°è¿™ä¸ªæ–¹æ³•ã€‚å›è°ƒå‡½æ•°çš„å…·ä½“æ„æ€æ˜¯ï¼Œå‡è®¾æœ‰ä¸¤ä¸ªå‡½æ•°ï¼Œaå’Œbï¼Œå‡½æ•°aåœ¨å‰båœ¨åï¼Œæ­£å¸¸æƒ…å†µçš„è¯ï¼Œç¨‹åºè¿è¡Œåˆ°äº†å‡½æ•°aï¼Œä¼šç­‰å¾…å…¶æ‰§è¡Œå®Œæ¯•ï¼Œç„¶åæ‹¿åˆ°å‡½æ•°açš„è¿è¡Œç»“æœï¼Œæ‰ä¼šç»§ç»­æ‰§è¡Œå‡½æ•°bï¼›é‚£ä¹ˆè¿™æ—¶ï¼Œé—®é¢˜å°±æ¥äº†ï¼Œå¦‚æœå‡½æ•°aè¿è¡Œä¸€ç§’ï¼Œæˆ‘å¯ä»¥ç­‰ï¼Œè¿è¡Œåç§’ï¼Œå°±éš¾ä»¥å¿å—äº†ï¼Œä¸‡ä¸€å‡½æ•°aå¡ä½äº†ï¼Œæ°¸è¿œæˆåŠŸä¸äº†ï¼Œä½ ä¼šç­‰åˆ°æµ·æ¯çŸ³çƒ‚å—ï¼Ÿå“ˆå“ˆå“ˆï¼Œé‚£æ€ä¹ˆåŠï¼Œæˆ‘ä¸‹é¢è¿˜æœ‰åƒåƒä¸‡ä¸‡è¡Œçš„ä»£ç å•Šï¼Œè¾›è¾›è‹¦è‹¦å†™äº†é‚£ä¹ˆä¹…ï¼Œè¿˜æ²¡è¿è¡Œåˆ°è¿™é‡Œï¼Œå°±ç»“æŸäº†ï¼Œé€—æˆ‘å•Šã€‚ã€‚ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå°±è¯¥å›è°ƒå‡½æ•°ä¸Šåœºäº†ï¼ŒæŠŠå‡½æ•°bå†™æˆå‡½æ•°açš„å›è°ƒå‡½æ•°ï¼Œåƒè¿™æ ·ï¼š 1234567891011121314// åŸæ¥çš„ä»£ç a();b();// é‡‡ç”¨å›è°ƒå‡½æ•°function a(b)&#123; setTimeout(function()&#123; // açš„ä»£ç  b() &#125;,1000);&#125; é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬æŠŠåŒæ­¥æ“ä½œå˜æˆäº†å¼‚æ­¥æ“ä½œï¼Œaä¸ä¼šå µå¡ç¨‹åºè¿è¡Œï¼Œç›¸å½“äºå…ˆæ‰§è¡Œç¨‹åºçš„ä¸»è¦é€»è¾‘ï¼Œå°†è€—æ—¶çš„æ“ä½œæ¨è¿Ÿæ‰§è¡Œã€‚ å›è°ƒå‡½æ•°çš„ä¼˜ç‚¹æ˜¯ç®€å•ã€å®¹æ˜“ç†è§£å’Œéƒ¨ç½²ï¼Œç¼ºç‚¹æ˜¯ä¸åˆ©äºä»£ç çš„é˜…è¯»å’Œç»´æŠ¤ï¼Œå„ä¸ªéƒ¨åˆ†ä¹‹é—´é«˜åº¦è€¦åˆï¼ˆCouplingï¼‰ï¼Œæµç¨‹ä¼šå¾ˆæ··ä¹±ï¼Œè€Œä¸”æ¯ä¸ªä»»åŠ¡åªèƒ½æŒ‡å®šä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚ é‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼Œå­¦ã€‚ã€‚ã€‚ä¸å¯¹ï¼Œè¿™ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿå¦‚æœå›è°ƒå‡½æ•°æ¯”è¾ƒå¤šä¼šæ€æ ·ï¼Ÿ 123456789101112// åœ¨å‰ä¸€ä¸ªåŠ¨ç”»æ‰§è¡Œå®Œæˆåï¼Œç´§æ¥ç€æ‰§è¡Œä¸‹ä¸€ä¸ªåŠ¨ç”»$(&apos;xx&apos;).animate(&#123;xxxx&#125;, function()&#123; $(&apos;xx&apos;).animate(&#123;xx&#125;,function()&#123; $(&apos;xx&apos;).animate(&#123;xx&#125;,function()&#123; $(&apos;xx&apos;).animate(&#123;xx&#125;,function()&#123; $(&apos;xx&apos;).animate(&#123;xx&#125;,function()&#123; ... &#125;,1000) &#125;,1000) &#125;,1000) &#125;,1000)&#125;,1000) æ˜¯ä¸æ˜¯è§‰å¾—å¾ˆå‚»ï¼Œä»£ç æ¯«æ— å¯è¯»æ€§è€Œè¨€ï¼Œä¸è¿‡ï¼Œè¿™æ˜¯æœ€åŸºæœ¬çš„jså¼‚æ­¥ç¼–ç¨‹çš„æ–¹æ³•ã€‚ äºŒã€promiseæœ‰äº†æœ€åŸºæœ¬çš„æ–¹æ³•ï¼Œå°±ä¼šæœ‰å¾ˆå¤šäººä¸æ»¡è¶³ï¼Œæƒ³åšå‡ºä¼˜åŒ–ï¼Œå†™ä¸ªç¬¬ä¸‰æ–¹åº“å•Šæˆ–è€…å‘å„ç§åŒ…ï¼Œå„ç§æ¨¡å—ä»€ä¹ˆçš„ã€‚ æœ€æœ‰åçš„ï¼Œè«è¿‡äºpromiseäº†ï¼Œåšä¸ºå‰ç«¯ï¼Œå¤§åé¼é¼çš„jQueryè‚¯å®šä¸ä¼šä¸çŸ¥é“å§ï¼Œè¯´èµ·jQueryï¼Œè¦è¯´çš„å°±å¤ªå¤šäº†ï¼Œèµ¶ç´§æ”¶ä½ã€‚jQueryé‡Œçš„ajaxæ–¹æ³•ï¼Œå°±æ˜¯å…¸å‹çš„å‚ç…§äº†promiseè®¾è®¡å‡ºæ¥çš„äº§ç‰©ï¼Œå…¶ä½¿ç”¨æ–¹æ³•æ˜¯ï¼š 12345$.ajax(&#123;// é…ç½®å‚æ•°&#125;).done(function(retData) &#123;...&#125;); è¿™æ˜¯ä¸€å¥—å…¸å‹çš„jQueryç‰ˆçš„ajaxåº”ç”¨æ–¹æ³•ï¼Œåé¢çš„doneï¼Œå°±æ˜¯æŒ‡çš„å‰é¢åšå®Œäº†ï¼Œè¿”å›ä¸€ä¸ªç»“æœretDataæ¥ï¼Œç„¶åå†æ‰§è¡Œå…¶å®ƒæ“ä½œã€‚ åœ¨es6ä¸­ï¼Œå·²ç»æ­£å¼å‡ºå°äº†promiseå¯¹è±¡ï¼Œå…¶åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š 123a().then(b).then(c)... æ˜¯ä¸æ˜¯ä¸€ä¸‹å­å°±ç®€æ´äº†å¾ˆå¤šï¼Ÿå½“ç„¶ï¼Œè¿™ä¸ªä¹Ÿä¸èƒ½è¯´æ˜¯å®Œç¾çš„å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆï¼Œåªèƒ½è¯´æ˜¯å®Œå–„ç½¢äº†ï¼Œå…¶ä¼˜ç‚¹ç¡®å®æ˜¯ç®€åŒ–äº†ä¸å°‘ä»£ç ï¼Œä¸è¿‡ä¹Ÿæœ‰ä¸è¶³çš„åœ°æ–¹ï¼Œé‚£å°±æ˜¯ç»´æŠ¤æ¯”è¾ƒéº»çƒ¦ï¼Œå› ä¸ºè¿™æ ·çš„è¯ï¼Œå¼‚æ­¥å¤šäº†ï¼Œä½ ä¸€çœ¼çœ‹è¿‡å»ï¼Œå°†ä¼šçœ‹åˆ°ä¸€å †çš„thenã€‚ã€‚ã€‚æ˜¯ä¸æ˜¯å¾ˆå°´å°¬å•Šï¼Œä»£ç çš„å¯è¯»æ€§ä¸€ä¸‹å­å°±é™ä½äº†ï¼Œä½ æ»¡è„‘å­çš„thenã€‚ ä¸‰ã€è§‚å¯Ÿè€…æ¨¡å¼è¯´èµ·è¿™ä¸ªï¼Œåˆè¦å›åˆ°å¤§å­¦çš„æ“ä½œç³»ç»Ÿè¯¾å ‚äº†ï¼Œç®—äº†ï¼Œä¸æµªè´¹æ—¶é—´äº†ï¼Œç›´æ¥è¿›å…¥æ­£é¢˜ã€‚ è§‚å¯Ÿè€…æ¨¡å¼ï¼Œä½ å¯ä»¥ç†è§£ä¸ºï¼Œå­˜åœ¨ä¸€ä¸ªâ€ä¿¡å·ä¸­å¿ƒâ€ï¼ŒæŸä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œå°±å‘ä¿¡å·ä¸­å¿ƒâ€å‘å¸ƒâ€ï¼ˆpublishï¼‰ä¸€ä¸ªä¿¡å·ï¼Œå…¶ä»–ä»»åŠ¡å¯ä»¥å‘ä¿¡å·ä¸­å¿ƒâ€è®¢é˜…â€ï¼ˆsubscribeï¼‰è¿™ä¸ªä¿¡å·ï¼Œä»è€ŒçŸ¥é“ä»€ä¹ˆæ—¶å€™è‡ªå·±å¯ä»¥å¼€å§‹æ‰§è¡Œã€‚ è¿™ä¸ªæ–¹å¼çš„å®ç°æœ‰å¾ˆå¤šçš„æ’ä»¶ï¼Œå°±æ‹¿æˆ‘ä»¬æœ€ç†Ÿçš„jQueryæ¥è¯´å¥½äº†ã€‚ 1234567891011// å‡½æ•°bè®¢é˜…doneä¿¡å·jQuery.subscribe(&quot;done&quot;, b);function a()&#123; setTimeout(function () &#123; // açš„ä»»åŠ¡ä»£ç  // aæ‰§è¡Œå®Œæ¯•åï¼Œå‘å¸ƒdoneä¿¡å·ï¼Œç„¶åbæ¥æ”¶åˆ°äº†doneä¿¡å·ï¼Œå°±å¼€å§‹æ‰§è¡Œbå‡½æ•° jQuery.publish(&quot;done&quot;); &#125;, 1000); &#125; // å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥å–æ¶ˆè®¢é˜…ä¿¡å·çš„äº‹ä»¶ï¼Œè¿™æ ·çš„è¯ï¼Œä»¥ådoneä¿¡å·å‘å¸ƒï¼Œbå‡½æ•°å°±ä¸ä¼šæ‰§è¡Œäº†ã€‚ // jQuery.unsubscribe(&quot;done&quot;, f2); è¿™ä¸ªä¹Ÿæœ‰ä¸€ç‚¹å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ï¼Œå°±æ˜¯å‘å¸ƒå’Œè®¢é˜…çš„æ¶ˆæ¯å¤ªå¤šæ—¶ï¼Œä¸å¥½ç®¡ç†ï¼Œäº‹ä»¶ä¼šå¤ªæ‚ä¹±ï¼Œæœ‰ä¸€ä¸ªæ•´ä½“ç®¡ç†äº‹ä»¶çš„ä¸­å¿ƒå°±æ›´å¥½äº†ã€‚ å››ã€generatorGeneratorå‡½æ•°æ˜¯åç¨‹åœ¨ES6çš„å®ç°ï¼Œæœ€å¤§ç‰¹ç‚¹å°±æ˜¯å¯ä»¥äº¤å‡ºå‡½æ•°çš„æ‰§è¡Œæƒï¼ˆå³æš‚åœæ‰§è¡Œï¼‰ã€‚å…¶æ ¸å¿ƒæ„æ€å°±æ˜¯ï¼Œä¸€æ®µä»£ç æ‰§è¡Œåˆ°æŸä¸ªèŠ‚ç‚¹æ—¶ï¼Œæš‚åœæ‰§è¡Œï¼Œç„¶åæ‰§è¡Œå¦ä¸€æ®µä»£ç ï¼Œæœ‰ç­‰äº†ä¼šï¼Œå†å›è¿‡å¤´æ¥æ‰§è¡Œç¬¬ä¸€æ®µä»£ç å‰©ä¸‹çš„éƒ¨åˆ†ï¼Œæ€»çš„æ¥è¯´å°±æ˜¯å‡ ä¸ªä»£ç ç‰‡æ®µäº¤æ›¿æ‰§è¡Œã€‚ è¯´åˆ°è¿™é‡Œæˆ‘è§‰å¾—ç°ç°åœ¨generatorå‡½æ•°å¹¶æ²¡æœ‰è¢«å¹¿æ³›çš„å¤§é¢ç§¯çš„è¿ç”¨ï¼Œæ‰€ä»¥å…ˆèŠ±ç‚¹æ—¶é—´æ¥ä»‹ç»ä¸‹generatorå‡½æ•°å§ã€‚talk is cheapï¼Œshow u the code. 1234567function* gen(x)&#123; var y = yield x + 2; return y;&#125;var g = gen(1);g.next() // &#123; value: 3, done: false &#125;g.next() // &#123; value: undefined, done: true &#125; ä¸Šé¢çš„ä»£ç ä¸­ï¼Œè°ƒç”¨generatorå‡½æ•°ï¼Œä¼šè¿”å›ä¸€ä¸ªå†…éƒ¨æŒ‡é’ˆï¼ˆä¹Ÿå«éå†å™¨ï¼‰ï¼Œå°±æ˜¯è¿™é‡Œçš„gï¼Œæ‰€ä»¥è¯´å½“ä½ ç›´æ¥è°ƒç”¨generatorå‡½æ•°çš„æ—¶å€™ï¼Œå®ƒå¹¶ä¸ä¼šç›´æ¥è¿”å›ç»“æœï¼Œè€Œé‡Œé¢çš„yieldå­—æ®µï¼Œå°±è¡¨ç¤ºå¼‚æ­¥æ“ä½œéœ€è¦æš‚åœçš„åœ°æ–¹ï¼Œé€šè¿‡gæŒ‡é’ˆè°ƒç”¨nextæ–¹æ³•ï¼ŒæŒ‡é’ˆå°±ä¼šå¼€å§‹å¼‚åŠ¨åˆ°ä¸‹ä¸€ä¸ªyieldï¼ˆæˆ–è€…returnï¼‰çš„åœ°æ–¹å»ï¼Œå¹¶ä¸”è¿”å›å½“æ—¶æš‚åœæ—¶æ‰€å¾—åˆ°çš„ç»“æœvalue,ä»¥åŠéå†çŠ¶æ€doneã€‚ ä¸‹é¢æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨generatorå‡½æ•°æ¥æ‰§è¡Œä¸€ä¸ªçœŸå®çš„å¼‚æ­¥ä»»åŠ¡ã€‚ 123456var fetch = require(&apos;node-fetch&apos;);function* gen()&#123; var url = &apos;https://api.github.com/users/github&apos;; var result = yield fetch(url); console.log(result.bio);&#125; è¿™é‡Œæˆ‘ä»¬é€šè¿‡å‘é€è¯·æ±‚ï¼Œç„¶åè¾“å‡ºè¯·æ±‚è¿”å›çš„ç»“æœï¼Œå»æ‰yieldå‘½ä»¤ï¼Œå°±å®Œå®Œå…¨å…¨æ˜¯åŒæ­¥çš„äº†ï¼Œæ‰€ä»¥è¿™ä¹Ÿæ˜¯yieldçš„ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ç‰¹ç‚¹ï¼Œå¯¹ä»£ç æ”¹åŠ¨å°ï¼Œä¿æŒä»£ç å¯è¯»æ€§ã€‚ã€‚ã€‚è¯è¯´å›æ¥ï¼Œç°åœ¨å£°æ˜äº†è¿™ä¸ªå‡½æ•°ï¼Œå¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š 1234567var g = gen();var result = g.next();result.value.then(function(data)&#123; return data.json();&#125;).then(function(data)&#123; g.next(data);&#125;); ä¸Šé¢ä»£ç ä¸­ï¼Œé¦–å…ˆæ‰§è¡ŒGeneratorå‡½æ•°ï¼Œè·å–éå†å™¨å¯¹è±¡ï¼Œç„¶åä½¿ç”¨next æ–¹æ³•ï¼ˆç¬¬äºŒè¡Œï¼‰ï¼Œæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„ç¬¬ä¸€é˜¶æ®µã€‚ç”±äºFetchæ¨¡å—è¿”å›çš„æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œå› æ­¤è¦ç”¨thenæ–¹æ³•è°ƒç”¨ä¸‹ä¸€ä¸ªnext æ–¹æ³•ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶ Generator å‡½æ•°å°†å¼‚æ­¥æ“ä½œè¡¨ç¤ºå¾—å¾ˆç®€æ´ï¼Œä½†æ˜¯æµç¨‹ç®¡ç†å´ä¸æ–¹ä¾¿ï¼ˆå³ä½•æ—¶æ‰§è¡Œç¬¬ä¸€é˜¶æ®µã€ä½•æ—¶æ‰§è¡Œç¬¬äºŒé˜¶æ®µï¼‰ã€‚ å‘ç°å·²ç»å†™äº†å¥½å¤šäº†ï¼Œçœ‹æ¥ä¸€æ¬¡æ€§å†™å®Œç¡®å®å¤ªç´¯å•Šï¼Œç•™ä¸‹ä¸€ä¸ªacyncå‡½æ•°ä¸‹æ¬¡å†å†™å§ã€‚","tags":[]},{"title":"vue.js ç»„ä»¶å¿«é€Ÿå…¥é—¨ï¼ˆä¸€ï¼‰","date":"2016-09-05T09:24:12.000Z","path":"2016/09/05/vue.js ç»„ä»¶å…¥é—¨ï¼ˆä¸€ï¼‰/","text":"å‰å‡ å¤©è¯»äº†ä¸€ç¯‡å¥½æ–‡ç« ï¼Œvueç»„ä»¶åŒ–ï¼Œè¿™ç¯‡ç®—æ˜¯æˆ‘è‡ªå·±æç‚¼å‡ºæ¥çš„çš„å½’çº³ä¸æ€»ç»“å§ã€‚ åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œä»¥å‰æˆ‘ä»¬ä¼šæŠŠå¸¸ç”¨çš„å…¬å…±çš„æ–¹æ³•ï¼ˆå‡½æ•°ï¼‰æå–å‡ºæ¥ï¼Œæ•´åˆä¸ºä¸€ä¸ªåº“ï¼Œæœ€æœ‰åçš„å½“å±jQäº†å§ï¼Œç„¶ååˆ°äº†reactå‡ºç°ï¼Œè¿™äº›ç±»åº“ä¸»è¦éƒ½æ˜¯é’ˆå¯¹viewå±‚è¿›è¡Œçš„æ“ä½œä¸å°è£…ï¼Œæˆ‘ä»¬åˆå¯ä»¥æŠŠviewå±‚é¢ä¸Šçš„ä¸€äº›ä¸œè¥¿æŠ½å‡ºæ¥è¿›è¡Œå°è£…å’Œæ•´ç†ï¼Œæ¯”å¦‚ä¸€ä¸ªtableï¼Œä¸€ä¸ªbuttonï¼Œä¸€ä¸ªdivç­‰ï¼Œä¹Ÿå¯ä»¥åƒæ›¾ç»æå–å‡½æ•°ä¸€æ ·æŠ½å‡ºæ¥ï¼Œå†™æˆå…¬ç”¨çš„ï¼Œåœ¨éœ€è¦ä½¿ç”¨çš„åœ°æ–¹ç›´æ¥å¼•å…¥å°±å¯ä»¥äº†ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥æ ¹æ®ä½ å®é™…è¿ç”¨çš„éœ€è¦è¿›è¡Œé€‚å½“çš„è‡ªå®šä¹‰é…ç½®ï¼Œè€Œè¿™äº›è¢«æŠ½å‡ºæ¥å…±ç”¨çš„tableï¼Œbuttonï¼Œdivè¿™äº›ï¼Œå°±å«åšç»„ä»¶ã€‚ ä¸Šé¢æ˜¯æˆ‘è‡ªå·±çæ‰¯çš„ï¼ŒåŸæ–‡ä½œè€…è®²å¾—æ¯”è¾ƒç¹çï¼Œæ‰€ä»¥æˆ‘å°±ç”¨è‡ªå·±çš„è¯­è¨€æ¥æ¦‚è¿°äº†ä¸€ä¸‹ï¼Œè™½ç„¶è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘è½¬è½½çš„ï¼Œä¸è¿‡æˆ‘ä¹Ÿå‚è€ƒäº†å…¶å®ƒçš„æ–‡ç« ï¼åšå®¢ï¼ŒçŸ¥è¯†ç‚¹çš„ç›¸ä¼¼åº¦æ¥è¿‘80%ï¼Œä½†æ˜¯è¯­è¨€åŸºæœ¬ä¸Šéƒ½æ˜¯æˆ‘è‡ªå·±é‡æ–°ç»„ç»‡çš„ï¼Œæ‰€ä»¥åŠ äº†å¾ˆå¤šè‡ªå·±çš„æƒ³æ³•å’Œæ€è€ƒï¼Œä¸‹é¢æˆ‘ä»¬å¼€å§‹è¿›å…¥æ­£é¢˜ã€‚ ###vueç»„ä»¶ï¼Œåˆ›å»ºä¸æ³¨å†Œçš„åŸºæœ¬æ­¥éª¤ã€‚ vueç»„ä»¶çš„ä½¿ç”¨ï¼Œæœ‰ä¸‰ä¸ªæ­¥éª¤ï¼Œåˆ†åˆ«æ˜¯åˆ›å»ºç»„ä»¶ï¼Œæ³¨å†Œç»„ä»¶å’Œä½¿ç”¨ç»„ä»¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ æˆ‘ä»¬å¯ä»¥ç”¨ä¸€æ®µä»£ç æ¥æ¼”ç¤ºè¿™ä¸‰ä¸ªæ­¥éª¤ï¼š 12345678910111213141516171819202122232425&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;body&gt; &lt;div id=&quot;app&quot;&gt; &lt;!-- 3. #appæ˜¯Vueå®ä¾‹æŒ‚è½½çš„å…ƒç´ ï¼Œåº”è¯¥åœ¨æŒ‚è½½å…ƒç´ èŒƒå›´å†…ä½¿ç”¨ç»„ä»¶--&gt; &lt;my-component&gt;&lt;/my-component&gt; &lt;/div&gt; &lt;/body&gt; &lt;script src=&quot;js/vue.js&quot;&gt;&lt;/script&gt; &lt;script&gt; // 1.åˆ›å»ºä¸€ä¸ªç»„ä»¶æ„é€ å™¨ var myComponent = Vue.extend(&#123; template: &apos;&lt;div&gt;This is my first component!&lt;/div&gt;&apos; &#125;) // 2.æ³¨å†Œç»„ä»¶ï¼Œå¹¶æŒ‡å®šç»„ä»¶çš„æ ‡ç­¾ï¼Œç»„ä»¶çš„HTMLæ ‡ç­¾ä¸º&lt;my-component&gt; Vue.component(&apos;my-component&apos;, myComponent) new Vue(&#123; el: &apos;#app&apos; &#125;); &lt;/script&gt;&lt;/html&gt; è¿è¡Œç»“æœå¾ˆç®€å•ï¼Œå°±æ˜¯ä¸€å¥â€œThis is my first component!â€ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨ç»„ä»¶å’Œä½¿ç”¨æ™®é€šçš„HTMLå…ƒç´ æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œä½ å¯ä»¥å°±æŠŠç»„ä»¶å½“åšä¸€ä¸ªHTMLå…ƒç´ æ¥ä½¿ç”¨ã€‚ è¦ç†è§£ç»„ä»¶çš„åˆ›å»ºå’Œæ³¨å†Œï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸‹å‡ ä¸ªæ­¥éª¤æ¥è¯¦ç»†è§£é‡Šï¼š Vue.extend()æ˜¯Vueæ„é€ å™¨çš„æ‰©å±•ï¼Œè°ƒç”¨Vue.extend()åˆ›å»ºçš„æ˜¯ä¸€ä¸ªç»„ä»¶æ„é€ å™¨ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„ç»„ä»¶å®ä¾‹ã€‚ Vue.extend()æ„é€ å™¨æœ‰ä¸€ä¸ªé€‰é¡¹å¯¹è±¡ï¼Œé€‰é¡¹å¯¹è±¡çš„templateå±æ€§ç”¨äºå®šä¹‰ç»„ä»¶è¦æ¸²æŸ“çš„HTMLã€‚ ä½¿ç”¨Vue.component()æ³¨å†Œç»„ä»¶æ—¶ï¼Œéœ€è¦æä¾›2ä¸ªå‚æ•°ï¼Œç¬¬1ä¸ªå‚æ•°æ—¶ç»„ä»¶çš„æ ‡ç­¾ï¼Œç¬¬2ä¸ªå‚æ•°æ˜¯ç»„ä»¶æ„é€ å™¨ã€‚ Vue.component()æ–¹æ³•å†…éƒ¨ä¼šè°ƒç”¨ç»„ä»¶æ„é€ å™¨ï¼Œåˆ›å»ºä¸€ä¸ªç»„ä»¶å®ä¾‹ã€‚ ç»„ä»¶åº”è¯¥æŒ‚è½½åˆ°æŸä¸ªVueå®ä¾‹ä¸‹ï¼Œå¦åˆ™å®ƒä¸ä¼šç”Ÿæ•ˆã€‚ æˆ‘ä»¬ä¸€å¥ä¸€å¥æ¥åˆ†æï¼Œå…ˆæ˜¯åˆ›å»ºä¸€ä¸ªç»„ä»¶ï¼Œä»£ç æ˜¯ 123myComponent = Vue.extend(&#123; template: &apos;&lt;div&gt;This is my first component!&lt;/div&gt;&apos;&#125;) åˆ›å»ºç»„ä»¶å¾ˆç®€å•ï¼Œç›´æ¥è°ƒç”¨vueæ„é€ å™¨çš„æ‰©å±•æ–¹æ³•å°±è¡Œäº†ï¼Œé‡Œé¢ä¼šä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡é‡Œé¢æœ‰ä¸ªtemplateå±æ€§ï¼Œå®ƒæŒ‡ä»£çš„æ˜¯è¿™ä¸ªç»„ä»¶çš„viewçš„å†…å®¹ï¼Œæ˜¯ä¸æ˜¯åƒreacté‡Œé¢çš„renderå‡½æ•°å•Šï¼Œå®ƒä¹Ÿæ˜¯returnçš„viewå†…å®¹ï¼Œå®ƒä»¬æœ‰å“ªäº›ä¸åŒå‘¢ï¼Ÿæ¯•ç«Ÿå­¦ä¹ çŸ¥è¯†è¦é’ˆå¯¹å„ç§ä¸åŒçš„ä½†æ˜¯æœ‰ç±»ä¼¼çš„çŸ¥è¯†ç‚¹æ¥è¿›è¡Œå½’çº³ï¼Œæ•´ç†å’Œç»¼åˆï¼Œæ‰èƒ½è¿›è¡Œèä¼šè´¯é€šçš„è¿ç”¨ã€‚æ¯•ç«Ÿå¤äººäº‘ï¼šå­¦è€Œæ—¶ä¹ ä¹‹ï¼Œä¸äº¦æ‚¦ä¹ï¼ å¥½äº†ï¼Œè¿™æ˜¯åˆ›å»ºï¼Œä¸‹é¢æ˜¯æ³¨å†Œäº†ï¼Œæ³¨å†Œä¹Ÿå¾ˆç®€å•ï¼Œä¸€å¥ä»£ç å°±æå®šäº†ï¼šVue.component(â€˜my-componentâ€™, myComponent);ï¼Œä½¿ç”¨Vue.componentæ–¹æ³•ï¼Œä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä½ æƒ³æ³¨å†Œçš„ç»„ä»¶åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä½ åˆ›å»ºçš„ç»„ä»¶åï¼Œæ˜¯ä¸æ˜¯æœ‰ç‚¹æ··æ·†ï¼Ÿå…ˆæ˜¯ä½ é€šè¿‡Vue.extendåˆ›å»ºäº†ä¸€ä¸ªç»„ä»¶ï¼Œåå­—å«myComponentï¼Œç„¶åä¸ºäº†åœ¨HTMLä¸­èƒ½å¤Ÿå½“åšæ ‡ç­¾æ¥ä½¿ç”¨ï¼Œä½ éœ€è¦ç»™ä½ åˆ›å»ºçš„è¿™ä¸ªç»„ä»¶æ³¨å†Œä¸€ä¸ªç»„ä»¶åï¼Œåå­—å«åšmy-componentï¼Œæ‰€ä»¥ä½ åœ¨HTMLå°±å¯ä»¥ç›´æ¥æŠŠä½ æ³¨å†Œçš„ç»„ä»¶åå½“åšHTMLæ ‡ç­¾æ¥ä½¿ç”¨ï¼Œåƒè¿™æ ·å°±å¯ä»¥äº†ã€‚ç°åœ¨ç»„ä»¶åˆ›å»ºå¥½äº†ï¼Œä¹Ÿæ³¨å†Œå¥½äº†ï¼Œå¯æ˜¯è¿˜ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œå› ä¸ºè¿˜éœ€è¦newä¸€ä¸ªVueå®ä¾‹ï¼Œæ‰èƒ½ä½¿ç”¨ï¼Œåƒè¿™æ · 123Vue(&#123; el: &apos;#app&apos;&#125;); ä¸€ä¸ªVueå®ä¾‹æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢çš„elå±æ€§æ˜¯ä½ ç»„ä»¶çš„æŒ‚è½½èŠ‚ç‚¹ï¼Œäºæ˜¯æˆ‘åˆæƒ…ä¸è‡ªç¦åœ°è”æƒ³åˆ°äº†reactï¼ŒReactDOM.render( dom , root)ï¼Œå°±åƒè¿™æ ·ï¼Œreactä¹Ÿæ˜¯å°†ä¸€ä¸ªviewç•Œé¢çš„è™šæ‹ŸdomæŒ‚è½½åˆ°ä¸€ä¸ªrootèŠ‚ç‚¹ä¸Šï¼Œè€Œè¿™é‡Œçš„VueåŒæ ·ï¼Œéœ€è¦å°†åˆšæ‰çš„ç»„ä»¶ä¹ŸæŒ‚è½½åˆ°æŸä¸ªèŠ‚ç‚¹ä¸‹ï¼Œè¿™ä¸¤è€…ä¹‹é—´çš„å¼‚åŒåé¢å†è¯´å§ï¼Œå…ˆè¯´ä¸€ç‚¹ä¸»è¦çš„ï¼Œvueé‡Œçš„èŠ‚ç‚¹æŒ‡çš„æ˜¯vueç»„ä»¶çš„ä½œç”¨åŸŸï¼Œè¿™ç‚¹æ˜¯å’Œreactå·®å¼‚æ¯”è¾ƒå¤§çš„ä¸€ç‚¹ï¼Œä½ å°†vueç»„ä»¶æŒ‚è½½åœ¨äº†æŸä¸ªèŠ‚ç‚¹ä¸‹ï¼Œæ„æ€æ˜¯è¿™ä¸ªç»„ä»¶åªæœ‰åœ¨è¿™ä¸ªèŠ‚ç‚¹èŒƒå›´å†…æ‰å¯ä»¥ä½¿ç”¨ï¼Œè‡³äºæ˜¯ä½¿ç”¨å¤šæ¬¡ï¼Œä½¿ç”¨ä¸€æ¬¡ï¼Œè¿˜æ˜¯ä¸€æ¬¡éƒ½ä¸ä½¿ç”¨ï¼Œéƒ½æ²¡é—®é¢˜ã€‚è€Œæˆ‘ä»¬è¿™ä¸ªå®ä¾‹ä¸Šï¼Œå°±æ˜¯æŒ‚è½½åœ¨äº†idä¸ºappçš„èŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªèŠ‚ç‚¹çš„èŒƒå›´å†…éƒ½å¯ä»¥ä½¿ç”¨çš„å½¢å¼ï¼Œæ¥è°ƒç”¨vueç»„ä»¶myComponentã€‚åŒç†ï¼Œå¦‚æœä½ æƒ³åœ¨å¤šä¸ªèŠ‚ç‚¹çš„ä½œç”¨åŸŸå†…ä½¿ç”¨æŸä¸ªvueç»„ä»¶çš„è¯ï¼Œé‚£ä½ å°±å¾—å¤šnewå‡ æ¬¡ï¼ŒæŠŠç»„ä»¶çš„æŒ‚è½½åˆ°å¤šä¸ªèŠ‚ç‚¹ä¸‹é¢å°±å¥½äº†ï¼Œè€Œå¦‚æœåœ¨æ²¡æœ‰å®ä¾‹åŒ–çš„ç»„ä»¶ä¸­éæ³•è°ƒç”¨æŸä¸ªvueç»„ä»¶ï¼Œå®ƒå°†ä¸èµ·ä»»ä½•ä½œç”¨ã€‚è¯¦ç»†æƒ…å†µå¯ä»¥çœ‹ä»¥ä¸‹ä»£ç ï¼š 123456789101112131415161718192021222324252627282930&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;body&gt; &lt;div id=&quot;app1&quot;&gt; &lt;my-component&gt;&lt;/my-component&gt; &lt;/div&gt; &lt;div id=&quot;app2&quot;&gt; &lt;my-component&gt;&lt;/my-component&gt; &lt;/div&gt; &lt;div id=&quot;app3&quot;&gt; &lt;!--è¯¥ç»„ä»¶ä¸ä¼šè¢«æ¸²æŸ“--&gt; &lt;my-component&gt;&lt;/my-component&gt; &lt;/div&gt; &lt;/body&gt; &lt;script&gt; var myComponent = Vue.extend(&#123; template: &apos;&lt;div&gt;This is a component!&lt;/div&gt;&apos; &#125;) Vue.component(&apos;my-component&apos;, myComponent) var app1 = new Vue(&#123; el: &apos;#app1&apos; &#125;); var app2 = new Vue(&#123; el: &apos;#app2&apos; &#125;) &lt;/script&gt;&lt;/html&gt; åœ¨ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåå«myComponentçš„vueç»„ä»¶ï¼Œç„¶åæ³¨å†Œäº†ä¸€ä¸ªåå«my-componentçš„ç»„ä»¶æ¥å½“åšHTMLæ ‡ç­¾ä½¿ç”¨ï¼Œæœ€åæˆ‘ä»¬å®ä¾‹åŒ–æ—¶ï¼Œåªåœ¨id=â€app1â€å’Œid=â€app2â€ä¸­æŒ‚è½½äº†è¿™ä¸ªvueç»„ä»¶ï¼Œè€Œåœ¨å®é™…ä½¿ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨id=â€app3â€ä¸­ä¹Ÿä½¿ç”¨äº†è¿™ä¸ªç»„ä»¶ï¼Œæ‰€ä»¥æœ€åï¼Œåªæœ‰id=â€app1â€å’Œid=â€app2â€çš„divä¸­ç»„ä»¶æˆåŠŸåœ°è¢«æ›¿æ¢æˆäº†â€œThis is a component!â€ï¼Œè€Œid=â€app3â€ä¸­çš„æ ‡ç­¾å°†ä¸ä¼šè¢«æ¸²æŸ“ã€‚å…·ä½“æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¥½äº†ï¼Œä¸€ä¸ªåŸºæœ¬çš„vueç»„ä»¶çš„ä¸€æ•´å¥—æµç¨‹åŸºæœ¬å°±å®Œå…¨æ˜¯è¿™æ ·äº†ï¼Œany problems elseï¼Ÿæˆ‘çŸ¥é“ï¼Œç°åœ¨è¿˜æœ‰å¾ˆå¤šçš„é—®é¢˜æ²¡æœ‰è§£å†³ï¼Œæ¯”å¦‚åˆ›å»ºç»„ä»¶ï¼Œæ³¨å†Œç»„ä»¶å’Œå®ä¾‹åŒ–æŒ‚è½½åˆ°æŸä¸ªèŠ‚ç‚¹ä¸‹ï¼Œæ•´ä½“æ­¥éª¤æ¯”è¾ƒç¹çï¼›æ³¨å†Œç»„ä»¶çš„æ—¶å€™å¯ä»¥å±€éƒ¨æ³¨å†Œå—ï¼›ç»„ä»¶å¯ä»¥åµŒå¥—å—ï¼Ÿå¦‚æœå¯ä»¥ï¼Œå¦‚ä½•åµŒå¥—ï¼›vueç»„ä»¶æ€ä¹ˆæ€ä¹ˆåšæˆå¯æ‰©å±•çš„ï¼Ÿåˆæ€æ ·å˜ä¸ºè‡ªå®šä¹‰é…ç½®å‘¢ï¼Ÿ æˆ‘ä¸‹ä¸€ç¯‡åšå®¢å†ç»†ç»†é“æ¥ã€‚","tags":[]},{"title":"expresså®ç°","date":"2016-09-03T08:25:56.000Z","path":"2016/09/03/node expresså®ç°/","text":"expressæ˜¯nodeé‡Œé¢ä¸€ä¸ªååˆ†å¸¸ç”¨çš„åº“ï¼Œç”¨å®ƒæ¥æ­å»ºæœåŠ¡å™¨ï¼Œäº‹åŠåŠŸå€ï¼Œä¸”å°å·§çµæ´»ï¼Œæœ‰è¶³å¤Ÿå¤šçš„ç‰¹æ€§ï¼Œç”¨æ¥è¿›è¡Œå„ç§ç½‘é¡µå¼€å‘ã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹expressçš„ä½¿ç”¨çš„ï¼Œæ¯•ç«ŸçŸ¥å·±çŸ¥å½¼ï¼Œç™¾æˆ˜ä¸æ®†ã€‚ 123456789101112131415161718192021//å¼•å…¥expressï¼Œç¡®ä¿ä½ çš„é¡¹ç›®ä¾èµ–äº†expressåº“ï¼Œå¦åˆ™çš„è¯å…ˆnpm installä¸€ä¸‹var express = require(&apos;express&apos;);//æ‰§è¡Œexpresså‡½æ•°ï¼Œvar app = express();// ä½¿ç”¨getæ–¹æ³•ï¼Œå½“è¯·æ±‚çš„è·¯ç”±æ˜¯helloæ—¶ï¼Œè¿”å›helloapp.get(&apos;/hello&apos;, function (req, res) &#123; res.send(&apos;hello&apos;);&#125;);// å½“è¯·æ±‚çš„è·¯ç”±æ˜¯worldæ—¶ï¼Œè¿”å›worldapp.get(&apos;/world&apos;, function (req, res) &#123; res.send(&apos;world&apos;);&#125;);// å½“è¯·æ±‚çš„è·¯ç”±æ˜¯å…¶å®ƒæ—¶ï¼Œè¿”å›â€œæ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„è·¯å¾„â€app.get(&apos;*&apos;, function (req, res) &#123; res.setHeader(&apos;content-type&apos;,&apos;text/plain;charset=utf8&apos;); res.end(&apos;æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„è·¯å¾„&apos;);&#125;);// æœ€åç›‘å¬ç«¯å£var server = app.listen(3000, function () &#123; console.log(&apos;æ­£åœ¨ç›‘å¬3000ç«¯å£&apos;);&#125;); ä¸Šé¢æˆ–è®¸å°±æ˜¯expressæœ€å¸¸è§ï¼Œä¹Ÿæ˜¯æœ€åŸºæœ¬çš„ä½¿ç”¨å§ï¼Œå¯åŠ¨äº†ä¸€ä¸ªæœåŠ¡å™¨å¹¶ä¸”ç›‘å¬3000ç«¯å£ï¼Œå¯¹/helloçš„è·¯ç”±è¿”å›â€œhelloâ€ï¼Œå¯¹/worldçš„è·¯ç”±è¿”å›â€œworldâ€ï¼Œå¯¹å…¶ä»–çš„è·¯ç”±è¿”å›â€œæ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„è·¯å¾„â€ã€‚ ç¤ºä¾‹çœ‹å®Œäº†ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å…·ä½“çš„å®ç°å§ï¼Œåœ¨è¿™ä¹‹å‰ï¼Œæˆ‘æƒ³è¯´ä¸€ä¸‹httpè¿™ä¸ªæ¨¡å—ï¼Œæ¯•ç«Ÿexpresså°±æ˜¯å¯¹httpè¿›è¡Œäº†ä¸€ä¸‹å°è£…ï¼Œæ—¢ç„¶æƒ³çœ‹çœ‹expressçš„å†…éƒ¨ï¼Œå½“ç„¶å°±ç¦»ä¸å¼€httpäº†ã€‚ 123456var http = require(&apos;http&apos;);http.createServer(function (request, response) &#123; response.writeHead(200, &#123;&apos;Content-Type&apos;: &apos;text/plain&apos;&#125;); response.end(&apos;Hello World\\n&apos;);&#125;).listen(3000, &apos;127.0.0.1&apos;);console.log(&apos;æ­£åœ¨ç›‘å¬3000ç«¯å£ã€‚&apos;); å°±ä¸Šé¢è¿™å‡ è¡Œï¼Œå°±å·²ç»æˆåŠŸåœ°å®ç°äº†ä¸€ä¸ªç®€å•çš„æœåŠ¡å™¨äº†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æ‹†ä¸€ä¸‹ã€‚1http.createServer(function(...)&#123;...&#125;).listen(3000); ç°åœ¨ï¼Œæˆ‘ä»¬å†å›è¿‡å¤´æ¥çœ‹çœ‹expressã€‚ 1234567891011121314151617181920// é¦–å…ˆï¼Œå£°æ˜expresså‡½æ•°var express = function () &#123;&#125;;// å®ƒçš„å†…éƒ¨åº”è¯¥æœ‰ä¸€ä¸ªappå‡½æ•°ï¼Œç”¨æ¥ä½œä¸ºå®ä¾‹ã€‚var express = function () &#123; var app = function(...)&#123;...&#125;&#125;;// è¿™ä¸ªå®ä¾‹è¿˜åº”è¯¥æœ‰å¾ˆå¤šçš„æ–¹æ³•ï¼Œæ¯”å¦‚getï¼Œlistenç­‰ã€‚ï¼ˆæœ¬æ¥æˆ‘æ˜¯æƒ³ç”¨es5çš„æ–¹å¼å†™çš„ï¼Œåæ¥å‘ç°å¥½ä¹…æ²¡ç”¨é‚£ç§æ–¹æ³•ï¼Œå†™functionå†™å¾—å¤ªç´¯äº†ã€‚ã€‚ã€‚ï¼‰var express = ()=&gt; &#123; var app = (req,res)=&gt;&#123;...&#125;; app.listen = (...)=&gt;&#123;...&#125;; app.get = (...)=&gt;&#123;...&#125;;&#125;;// æœ€åï¼Œä¸ºäº†èƒ½å¤Ÿå®Œæˆé“¾å¼è°ƒç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿”å›è¿™ä¸ªå®ä¾‹appï¼Œç„¶åexportsä¸€ä¸‹ï¼Œå°±å®Œæˆäº†ã€‚var express = ()=&gt; &#123; var app = (...)=&gt;&#123;...&#125;; app.listen = (...)=&gt;&#123;...&#125;; app.get = (...)=&gt;&#123;...&#125;; return app;&#125;;module.exports = exports = express; è¿™å°±æ˜¯expressåŸºæœ¬çš„æ¡†æ¶ï¼Œå¦‚æœåç»­æœ‰ä»€ä¹ˆæ‰©å±•çš„ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨é‡Œé¢å¢åŠ ä¸€ä¸ªå‡½æ•°å°±å¥½äº†ï¼Œ= (...)=>&#123;...&#125; ```ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥æ…¢æ…¢åˆ†æé‡Œé¢çš„æ„é€ ã€‚12å…ˆçœ‹ä¸€ä¸ªæœ€ç®€å•çš„å§ï¼Œlistenæ–¹æ³•ã€‚ app.listen = function (port) { require(â€˜httpâ€™).createServer(app).listen(port);};12æ˜¯ä¸æ˜¯å‘ç°äº†ä»€ä¹ˆï¼Ÿå†ä¸Šå»çœ‹ä¸€çœ¼httpï¼Œæ˜¯ä¸æ˜¯å¾ˆç›¸ä¼¼å•Šã€‚ã€‚ã€‚æ²¡é”™ï¼Œå°±æ˜¯è¿™æ ·çš„ã€‚ http.createServer(function(â€¦){â€¦}).listen(3000);``` è€Œä¸­é—´çš„appå‡½æ•°ï¼Œå¯¹åº”çš„å°±æ˜¯http.createServerçš„å‚æ•°äº†ã€‚æ„Ÿè§‰è¿™ä¸ªlistenå‡½æ•°åº”è¯¥ä¸éœ€è¦å¤šè®²ã€‚","tags":[]},{"title":"react, es5 or es6 ?","date":"2016-08-25T08:07:53.000Z","path":"2016/08/25/react es5è¿˜æ˜¯es6 ï¼Ÿ/","text":"éšç€es6çš„é€æ¸æ™®åŠï¼Œæ–°çš„è¯­æ³•ç³–ï¼Œå¯¹æˆ‘ä»¬ä»¥å‰å†™jsçš„ä¹ æƒ¯ä¹Ÿæœ‰ç€ä¸å°çš„å†²å‡»ï¼Œæ¯”å¦‚è¯´æˆ‘å¥½ä¹…éƒ½æ²¡å†™è¿‡functionè¿™ä¸ªè¯è¯­äº†ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯â€œ=&gt;â€ç®­å¤´å‡½æ•°ï¼Œvarä¹ŸåŸºæœ¬ä¸ç”¨äº†ï¼Œç°åœ¨ç”¨letï¼Œä»¥åŠå…¶ä»–ç­‰ç­‰ã€‚ ä½†æ˜¯å¯¹äºå†™reactï¼Œes5å’Œes6çš„å˜åŒ–ï¼Œè¿˜æ˜¯ç¨å¾®æœ‰ä¸€äº›ä¸åŒçš„ï¼Œâ€œtalk is cheap,show the codeâ€ã€‚ è¿™æ˜¯es5çš„å†™æ³•ï¼š 12345678910111213141516171819202122232425262728var InputControlES5 = React.createClass(&#123; defaultPropsï¼š&#123; initialValueï¼š&apos;&apos; &#125;, propTypesï¼š&#123; initialValueï¼šReact.PropTypes.string &#125;, // Set up initial state getInitialStateï¼šfunction() &#123; return &#123; textï¼šthis.props.initialValue || &apos;placeholder&apos; &#125;; &#125;, handleChangeï¼šfunction(event) &#123; this.setState(&#123; textï¼ševent.target.value &#125;); &#125;, renderï¼šfunction() &#123; return ( &lt;div&gt; Type somethingï¼š &lt;input onChange=&#123;this.handleChange&#125; value=&#123;this.state.text&#125; /&gt; &lt;/div&gt; ); &#125;&#125;); ä¸‹é¢æ˜¯es6çš„å†™æ³•ï¼š 1234567891011121314151617181920212223242526272829303132class InputControlES6 extends React.Component &#123; constructor(props) &#123; super(props); // Set up initial state this.state = &#123; textï¼šprops.initialValue || &apos;placeholder&apos; &#125;; // Functions must be bound manually with ES6 classes this.handleChange = this.handleChange.bind(this); &#125; handleChange(event) &#123; this.setState(&#123; textï¼ševent.target.value &#125;); &#125; render() &#123; return ( &lt;div&gt; Type somethingï¼š &lt;input onChange=&#123;this.handleChange&#125; value=&#123;this.state.text&#125; /&gt; &lt;/div&gt; ); &#125;&#125;InputControlES6.propTypes = &#123; initialValueï¼šReact.PropTypes.string&#125;;InputControlES6.defaultProps = &#123; initialValueï¼š&apos;&apos;&#125;; ä¸€ä¸‹æ˜¯ä¸€äº›å…³é”®çš„ä¸åŒç‚¹ï¼š åˆ›å»ºæ–¹å¼ä¸åŒes5æ˜¯é€šè¿‡creatClassæ¥åˆ›å»ºçš„reactç»„ä»¶ï¼Œè€Œes6æ˜¯é€šè¿‡class extendsæ¥åˆ›å»ºçš„ï¼Œæˆ–è®¸è¿™æ˜¯æœ€ç›´æ¥çš„å«©ä¸ªå‘ç°çš„å·®å¼‚å§ï¼Œæ¯•ç«Ÿè¿™åœ¨ç¬¬ä¸€è¡Œã€‚ å‡½æ•°çš„ç»‘å®šè¯è¯´ä»¥å‰ï¼Œæˆ‘ä¿®æ”¹è¿‡åˆ«äººç”¨es6å†™çš„reactä»£ç ï¼Œæˆ‘ä¹ æƒ¯åœ¨æ¯ä¸ªå‡½æ•°åé¢åŠ ä¸Šä¸€ä¸ªé€—å·ï¼Œç„¶åæˆ‘åœ¨renderå‡½æ•°ä¸­å¢åŠ äº†ä¸€ä¸ªäº‹ä»¶ï¼Œå¯¹åº”æ‰§è¡Œçš„å‡½æ•°æ˜¯this.xxxï¼Œç»“æœå‘¢ï¼ŸæŠ¥äº†ä¸€å †çš„é”™ï¼ˆåŒ…æ‹¬ä¹‹å‰çš„é€—å·ï¼‰ï¼Œâ€œthis.xxx is undefined.â€ï¼Œå½“æ—¶æˆ‘è¿˜ä¸çŸ¥é“es6ä¸es5çš„å·®å¼‚ï¼Œå½“æ—¶å°±ä¸€è„¸æ— è¾œçš„è¡¨æƒ…ï¼Œç„¶åæ²¡åŠæ³•ï¼Œæˆ‘æŠŠåˆ«äººçš„ä»£ç å…¨éƒ¨ç”¨es5é‡å†™äº†ä¸€éï¼Œå¹¶ä¸”å½“æ—¶è¡¨ç¤ºä»¥åéƒ½ä¼šä¸€ç›´ä½¿ç”¨es5çš„æ–¹å¼æ¥å†™reactã€‚å”‰ï¼Œäººçš„ä¸€ç”Ÿï¼Œè‡ªèº«çš„åŠªåŠ›å¾ˆé‡è¦ï¼Œä½†æ˜¯ä¹Ÿè¦è€ƒè™‘åˆ°å†å²çš„è¿›ç¨‹ã€‚ã€‚ã€‚äºæ˜¯æˆ‘ä¹Ÿå°±åšäº†ä¸€ç‚¹å¾®å°çš„å·¥ä½œï¼Œä¹Ÿå¼€å§‹é‡‡ç”¨es6çš„æ–¹å¼æ¥å†™reactäº†ã€‚ å¥½äº†ï¼Œè¯´å›æ­£é¢˜ï¼Œes5ä½¿ç”¨çš„æ˜¯creatClassçš„æ–¹å¼æ¥åˆ›å»ºreactç»„ä»¶ï¼Œæ¯ä¸€ä¸ªå‡½æ•°éƒ½ä¼šè‡ªåŠ¨è¢«reactç»‘å®šï¼Œæ‰€ä»¥å°±ä¸ä¼šæœ‰â€œthis.xxx is undefined.â€è¿™æ ·çš„æŠ¥é”™äº†ã€‚ä½†æ˜¯es6çš„classå°±ä¸åŒäº†ï¼Œä½ åœ¨renderå‡½æ•°é‡Œä½¿ç”¨åˆ°çš„this.xxxå‡½æ•°ï¼Œéƒ½éœ€è¦è‡ªå·±æ‰‹åŠ¨å»æ„é€ å‡½æ•°ä¸­ç»‘å®šå®ƒä»¬ï¼Œå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡æ’ä»¶æ¥è‡ªåŠ¨ç»‘å®šï¼Œè¿˜æœ‰ä¸€ç§æ–¹å¼å°±æ˜¯ä½ å¯ä»¥åœ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„åœ°æ–¹ï¼Œç›´æ¥å¢åŠ bind(this)æ¥è¿›è¡Œç»‘å®šï¼Œæ¯”å¦‚è¿™æ ·æ¥ç»‘å®šthisã€‚ ä¸Šé¢çš„å‡ ç§æ–¹å¼éƒ½å¯ä»¥ç»‘å®šthisï¼Œä¸è¿‡åœ¨æ€§èƒ½ä¸Šæ¥è¯´ï¼Œå´è¿˜æ˜¯æœ‰ä¸€å®šå·®è·çš„ã€‚é¦–å…ˆæ˜¯å¼•å…¥ç¬¬ä¸‰æ–¹åº“æ¥è‡ªåŠ¨ç»‘å®šï¼Œå¦‚æœæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤§å‹çš„é¡¹ç›®ï¼Œå¼•å…¥ä¸€ä¸ªæ¯”è¾ƒå°çš„åº“ï¼Œæ¥è§£å†³æ¯”è¾ƒå¤šæ¯”è¾ƒç¹ççš„bindçš„é—®é¢˜ï¼Œè¿˜æ˜¯å¯ä»¥çš„ï¼Œä¸è¿‡å‰ææ˜¯é¡¹ç›®æ¯”è¾ƒå¤§ï¼Œéœ€è¦åœ¨å¼•å…¥ç¬¬ä¸‰æ–¹åº“å’Œäººä¸ºç»‘å®šä¹‹é—´æƒè¡¡åˆ©å¼Šã€‚å‰©ä¸‹çš„æ–¹æ³•å°±æ˜¯åœ¨æ„é€ å‡½æ•°é‡Œç»‘å®šthisè¿˜æ˜¯åœ¨renderå‡½æ•°é‡Œç»‘å®šthisï¼Œå·¥ä½œé‡å…¶å®æ˜¯å·®ä¸å¤šçš„ï¼Œä½†æ˜¯è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸçš„é—®é¢˜ï¼Œæ„é€ å‡½æ•°ï¼Œåœ¨æ•´ä¸ªreactå£°æ˜å‘¨æœŸé‡Œï¼Œåªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œä½†æ˜¯renderå°±ä¸ä¸€æ ·äº†ï¼Œä»»ä½•ç»„ä»¶çš„ä»»ä½•å±æ€§æ”¹å˜æˆ–è€…çŠ¶æ€æ”¹å˜ï¼Œéƒ½å¯èƒ½å¤„ç½šrenderå‡½æ•°æ¥é‡æ–°æ¸²æŸ“ï¼Œæ‰€ä»¥renderå‡½æ•°ä¸€èˆ¬æ˜¯ä¼šæ‰§è¡Œå¤šæ¬¡çš„ï¼Œæ—¢ç„¶æ‰§è¡Œå¤šæ¬¡ï¼Œé‚£ä¹ˆé‡Œé¢çš„bind(this)è‡ªç„¶ä¹Ÿæ˜¯ä¼šæ‰§è¡Œå¤šæ¬¡ï¼Œè¿™ä¸åœ¨æ„é€ å‡½æ•°é‡Œåªæ‰§è¡Œä¸€æ¬¡æ¥æ¯”ï¼Œå½“ç„¶å°±ä¼šæ…¢ä¸€äº›ã€‚æœ‰æ²¡æœ‰æ›´å¥½çš„åŠæ³•å‘¢ï¼Ÿæˆ‘åœ¨æ–‡ç« å¼€å§‹å°±è¯´è¿‡äº†ï¼Œes6æœ‰ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„ç‰¹æ€§å°±æ˜¯ç®­å¤´å‡½æ•°ï¼Œå®ƒæ˜¯ä¼šè‡ªåŠ¨ç»‘å®šthisçš„ï¼Œä½ å¯ä»¥åœ¨å®šä¹‰å‡½æ•°çš„åœ°æ–¹ç›´æ¥ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œä»£ç å¦‚ä¸‹ï¼š 12345handleChange = (event) =&gt; &#123; this.setState(&#123; text: event.target.value &#125;);&#125; è¿™æ ·çš„è¯ï¼Œä¹Ÿå°±ä¸ç”¨è€ƒè™‘ç»‘å®šthisçš„äº‹æƒ…äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿å•Šã€‚ æ„é€ å‡½æ•°ä¸­çš„superes6çš„constructoréœ€è¦æ¥æ”¶propsï¼Œå¹¶ä¸”è°ƒç”¨super(props)ï¼Œè¿™æ˜¯ç›¸å¯¹äºes5æ‰€æ”¹å˜çš„ä¸€ç‚¹ï¼Œè¿™ä¸ªè®°ä½å°±è¡Œäº†ã€‚ åˆå§‹åŒ–stateåœ¨es5ä¸­ï¼Œreactç»„ä»¶åˆå§‹åŒ–çš„æ—¶å€™ä¼šæ‰§è¡Œä¸€ä¸ªgetinitialStateå‡½æ•°ï¼Œè€Œes6ä¸­å´ä¸æ˜¯è¿™æ ·ï¼Œåœ¨è°ƒç”¨superä¹‹åï¼Œä¼šç›´æ¥è®¾ç½®ä¸€ä¸ªthis.stateçš„å¯¹è±¡æ¥åˆå§‹åŒ–ï¼Œthis.state = {â€¦}ã€‚ getdefaultPropså’ŒpropTypeså’Œåˆå§‹åŒ–stateä¸€æ ·ï¼Œåœ¨es5ä¸­ï¼Œä¹Ÿæœ‰ä¸€ä¸ªå‡½æ•°æ¥å•ç‹¬åˆå§‹åŒ–propsï¼Œå°±æ˜¯getdefaultPropsï¼Œè€Œes6å°±æ˜¯ç”¨ä¸Šé¢çš„é‚£ä¸ªsuperæ–¹æ³•ï¼Œes5ä¸­å¯ä»¥ç›´æ¥åœ¨è¿™ä¸ªå‡½æ•°ä¸‹é¢æ¥ç€å†™propTypesæ¥é™å®šæ¥æ”¶çš„å‚æ•°çš„ç±»å‹ï¼Œè€Œes6å°±ä¸ä¸€æ ·äº†ï¼Œå®ƒå°†propTypesç›´æ¥æ”¾åœ¨äº†reactç»„ä»¶ä¹‹å¤–ï¼Œå› ä¸ºè¿™äº›å°†ä¼šæ˜¯ç±»æœ¬èº«çš„å±æ€§ï¼Œæ‰€ä»¥éœ€è¦æ”¾åœ¨ç±»çš„å¤–éƒ¨æ¥å•ç‹¬å®šä¹‰ã€‚es7æ˜“ç»åˆå°†å®šä¹‰å±æ€§æ”¹å›äº†ç±»çš„å†…éƒ¨ï¼Œä¸è¿‡è¿™ä¸ªè¿˜æ²¡æ™®åŠã€‚ 1234567891011class Person extends React.Component &#123; static propTypes = &#123; name: React.PropTypes.string, age: React.PropTypes.string &#125;; static defaultProps = &#123; name: &apos;&apos;, age: -1 &#125;; ...&#125; ç”¨å“ªä¸ªæ–¹æ³•æ‰å¥½ï¼ŸFacebookå·²ç»å£°æ˜äº†React.createClasså°†æœ€ç»ˆä¼šè¢«ES6çš„classesæ›¿ä»£ï¼Œä½†æ˜¯ä»–ä»¬ä¹Ÿè¯´â€œåœ¨æˆ‘ä»¬æ‰¾åˆ°å½“å‰mixinæ‰€ä½¿ç”¨çš„ä¾‹å­çš„æ›¿ä»£è€…ä»¥åŠåœ¨è¯­è¨€ä¸Šæ”¯æŒç±»å±æ€§çš„åˆå§‹åŒ–å™¨å‰ï¼Œæˆ‘ä»¬ä¸æ‰“ç®—åºŸå¼ƒReact.createClassâ€ã€‚ åœ¨ä»»ä½•å¯ä»¥ä½¿ç”¨æ— çŠ¶æ€å‡½æ•°å¼ç»„ä»¶çš„åœ°æ–¹ä½¿ç”¨å®ƒã€‚ç®€å•è€Œä¸”ä¼šå¼ºåˆ¶æ€§åœ°ç®€åŒ–ä½ çš„ç»„ä»¶ã€‚ å¯¹äºä¸€äº›éœ€è¦stateï¼Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•æˆ–æ˜¯é€šè¿‡refæ¥æ“ä½œæ½œåœ¨çš„DOMèŠ‚ç‚¹çš„å¤æ‚ç»„ä»¶æ¥è®²ï¼Œè¯·ä½¿ç”¨classã€‚ å°½ç®¡çŸ¥é“è¿™ä¸‰ç§å†™æ³•é£æ ¼å¾ˆæ£’ï¼Œä½†åœ¨StackOverflowæˆ–è€…å…¶ä»–åœ°æ–¹æŸ¥æ‰¾è§£å†³æ–¹æ¡ˆæ—¶å¯èƒ½ä»ä¼šçœ‹åˆ°ä¸€äº›æ··æ‚ç€ES5å’ŒES6å†™æ³•çš„ç­”æ¡ˆã€‚ES6é£æ ¼å·²ç»éå¸¸æµè¡Œäº†ï¼Œä½†è¿™ä¸ä¼šæ˜¯ä½ çœ‹åˆ°çš„å”¯ä¸€ä¸€ç§å†™æ³•ã€‚","tags":[]},{"title":"vue todoç¤ºä¾‹","date":"2016-08-21T09:03:14.000Z","path":"2016/08/21/vue todo/","text":"æœ€è¿‘æŠ½ç©ºçœ‹äº†ä¸‹vueï¼Œä¸€ä¸ªè½»é‡çº§çš„å‰ç«¯æ¡†æ¶ï¼ˆç±»åº“ï¼‰ï¼Œå®ƒé‡‡ç”¨çš„mvvmæ¨¡å¼ï¼Œä¸”æ•°æ®åŒå‘ç»‘å®šï¼Œåˆšå¥½å®˜æ–¹ç½‘ç«™ä¸Šæœ‰ä¸€ä¸ªtodoå®ä¾‹ï¼Œæˆ‘æ„Ÿè§‰å’Œreduxçš„todoå®ä¾‹å¾ˆç±»ä¼¼ï¼Œæ‰€ä»¥å‡†å¤‡å°†è¿™ä¸¤ä¸ªæ¡†æ¶çš„todoå®ä¾‹åˆ†åˆ«è§£è¯»ä¸€ä¸‹ï¼Œæ¥æ¯”è¾ƒä¸€ä¸‹ä¸ªä¸­å¼‚åŒã€‚ è¿™ä¸ªä»£ç å°±ä¸¤éƒ¨åˆ†ï¼Œå…ˆæ˜¯htmlï¼š123456789&lt;div id=&quot;app&quot;&gt; &lt;input v-model=&quot;newTodo&quot; v-on:keyup.enter=&quot;addTodo&quot;&gt; &lt;ul&gt; &lt;li v-for=&quot;todo in todos&quot;&gt; &lt;span&gt;&#123;&#123; todo.text &#125;&#125;&lt;/span&gt; &lt;button v-on:click=&quot;removeTodo($index)&quot;&gt;X&lt;/button&gt; &lt;/li&gt; &lt;/ul&gt;&lt;/div&gt; æ¥ä¸‹æ¥æ˜¯jsä»£ç ï¼š 123456789101112131415161718192021new Vue(&#123; el: &apos;#app&apos;, data: &#123; newTodo: &apos;&apos;, todos: [ &#123; text: &apos;Add some todos&apos; &#125; ] &#125;, methods: &#123; addTodo: function () &#123; var text = this.newTodo.trim() if (text) &#123; this.todos.push(&#123; text: text &#125;) this.newTodo = &apos;&apos; &#125; &#125;, removeTodo: function (index) &#123; this.todos.splice(index, 1) &#125; &#125;&#125;) æˆ‘ç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™æ®µä»£ç çš„æ—¶å€™è§‰å¾—æœ‰ç‚¹è¯§å¼‚ï¼Œå°±è¿™ä¹ˆç‚¹ä»£ç å°±å®ç°äº†ä¸€ä¸ªtodo listï¼Œæ¯”reactå°‘äº†å¥½å¤šï¼Œå¦‚æœæ˜¯reduxçš„todo listï¼Œåˆ«è¯´ä»£ç ï¼Œæ–‡ä»¶å¤¹æ•°é‡å°±å¯ä»¥è®©ä½ ä¸€åŒæ‰‹æ•°ä¸è¿‡æ¥ï¼Œè€Œè¿™vueä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸€å…±æ‰è¿™ä¹ˆç‚¹ä»£ç ï¼Œä¸‹é¢æ¥ä»”ç»†çœ‹çœ‹è¿™ä¸ªä»£ç å§ã€‚å…ˆçœ‹ä¸‹htmlä»£ç å§ï¼Œé™¤äº†åŸç”Ÿçš„htmlä»£ç å¤–ï¼Œè¿™é‡Œæœ‰å‡ ä¸ªvueç‰¹æœ‰çš„å±æ€§ï¼Œæ˜¾è€Œæ˜“è§ï¼Œæ‰€æœ‰ä»¥vå¼€å¤´çš„å±æ€§ï¼Œéƒ½æ˜¯vueç‰¹æœ‰çš„å±æ€§ï¼Œæ¯”å¦‚è¿™é‡Œçš„v-model=â€newTodoâ€ï¼Œv-on:keyup.enter=â€addTodoâ€ï¼Œv-for=â€todo in todosâ€ï¼Œv-on:click=â€removeTodo($index)â€ï¼Œä¸€å…±å°±è¿™å››ä¸ªå§ï¼Œè€Œå°±æ˜¯å­—ç¬¦ä¸²æ¨¡ç‰ˆäº†ï¼Œä»jsæ–‡ä»¶çš„æŸä¸ªå¯¹è±¡ä¸­è·å–æ•°æ®æ¥å¡«å……åˆ°é¡µé¢ä¸Šã€‚jsä»£ç ä¹Ÿå¾ˆå°‘ï¼Œä¼°è®¡ä¸€å…±æ‰åå¤šè¡Œï¼ŒæŠ›å»ä¸­é—´çš„å†…å®¹ä¸çœ‹ï¼Œå°±æˆäº†new Vue({})äº†ï¼Œå¾ˆæ˜¾ç„¶è¿™å°±æ˜¯newäº†ä¸€ä¸ªVueå®ä¾‹ï¼Œç®—æ˜¯åˆå§‹åŒ–ï¼Œç„¶åæˆ‘ä»¬å†æ¥å¯¹å†…å®¹ä¸€è¡Œä¸€è¡Œåœ°è§£è¯»ã€‚ 1el: &apos;#app&apos; å…ˆçœ‹ä¸€ä¸‹appåœ¨htmlæ–‡ä»¶é‡ŒæŒ‡ä»£çš„æ˜¯ä»€ä¹ˆï¼Œä¸€çœ‹ä¾¿çŸ¥ï¼Œappåœ¨è¿™é‡ŒæŒ‡ä»£çš„æ˜¯æœ€å¤–å±‚divçš„idï¼Œè€Œè¿™é‡Œçš„ï¼ƒåº”è¯¥ç±»ä¼¼äºjQueryé€‰æ‹©å™¨ä¸­çš„ç¬¦å·å§ï¼ˆæ‰€ä»¥æˆ‘çŒœæµ‹è¿™é‡Œä¹Ÿå¯ä»¥ç”¨â€œ.appâ€æ¥é€‰æ‹©classä¸ºappçš„å…ƒç´ æ¥ä½œä¸ºVueçš„å®¹å™¨ï¼‰ï¼Œå‰é¢çš„elåº”è¯¥æŒ‡çš„æ˜¯elementå§ã€‚å†çœ‹ä¸‹é¢ï¼š 123456data: &#123; newTodo: &apos;&apos;, todos: [ &#123; text: &apos;Add some todos&apos; &#125; ] &#125; è¿™ä¸ªdataå¾ˆæ˜æ˜¾è¯´æ˜äº†è¿™é‡Œé¢è£…çš„æ˜¯æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œä¸€å…±æœ‰ä¸¤æ¡æ•°æ®ï¼Œä¸€æ¡æ˜¯newTodoçš„æ•°æ®ï¼Œç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼Œå¦ä¸€æ¡æ˜¯todosæ•°æ®ï¼Œç±»å‹æ˜¯æ•°ç»„å¯¹è±¡ï¼Œç„¶åæˆ‘ä»¬ç°åœ¨å†è¿”å›htmlä¸­ï¼ŒæŸ¥çœ‹é‚£é‡Œç”¨åˆ°äº†è¿™ä¸¤æ¡æ•°æ®çš„ï¼Œå¯ä»¥çœ‹åˆ°v-model=â€newTodoâ€ï¼Œæ‰€ä»¥æˆ‘ä»¬æš‚æ—¶å¯ä»¥çŸ¥é“å…·æœ‰v-modelå±æ€§çš„è¿™ä¸ªinputè¾“å…¥æ¡†å’ŒnewTodoè¿™æ¡æ•°æ®ç»‘å®šäº†èµ·æ¥ï¼Œè‡³äºæ˜¯å•å‘ç»‘å®šè¿˜æ˜¯åŒå‘ç»‘å®šè¿˜æ˜¯ä»…ä»…æ˜¯åˆå§‹åŒ–çš„æ—¶å€™ç»‘å®šä¸€æ¬¡ï¼Œæˆ‘ä»¬ç°åœ¨è¿˜ä¸çŸ¥é“ï¼Œæ¥ç€çœ‹ä¸‹é¢çš„todosï¼Œv-for=â€todo in todosâ€ï¼Œå¯ä»¥æ˜ç™½çš„çŸ¥é“ï¼Œè¿™æ˜¯ä¸ªforéå†ï¼Œç±»ä¼¼äºfor(i in object)ä¸€æ ·ï¼Œè€Œè¿™é‡Œçš„æ„æ€å°±ç±»ä¼¼äºåœ¨todosè¿™ä¸ªæ•°ç»„ä¸­éå†ä¸€ä¸‹ï¼Œç„¶ååœ¨liæ ‡ç­¾å†…å¯¹éå†åˆ°çš„æ•°æ®è¿›è¡Œæ“ä½œï¼Œä¸‹é¢å°±ç”¨åˆ°äº†å­—ç¬¦ä¸²æ¨¡ç‰ˆï¼Œå°†éœ€è¦çš„æ•°æ®æå–å‡ºæ¥å°±å¥½äº†ã€‚ç»§ç»­å¾€ä¸‹é¢çœ‹ï¼š 123456789101112methods: &#123; addTodo: function () &#123; var text = this.newTodo.trim() if (text) &#123; this.todos.push(&#123; text: text &#125;) this.newTodo = &apos;&apos; &#125; &#125;, removeTodo: function (index) &#123; this.todos.splice(index, 1) &#125;&#125; è¿™éƒ¨åˆ†æ˜¯methodsï¼ŒæŒ‰ç…§å­—é¢æ„æ€æ¥çœ‹ï¼Œå«åšæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯jsä¸­çš„å‡½æ•°ï¼ˆfunctionï¼‰ï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢ä¸€å…±åŒ…å«äº†ä¸¤ä¸ªfunctionï¼Œä¸€ä¸ªæ˜¯addTodoï¼Œå¦ä¸€ä¸ªæ˜¯removeTodoï¼Œå›é¡¾htmlæ–‡ä»¶ï¼Œå¯ä»¥çŸ¥é“è°ƒç”¨è¿™ä¸¤ä¸ªå‡½æ•°æ–¹æ³•çš„åœ°æ–¹åˆ†åˆ«æ˜¯v-on:keyup.enterå’Œv-on:clickï¼Œå‰ä¸€ä¸ªå°±æ˜¯ç±»ä¼¼äºåŸç”Ÿçš„onKeyupæ–¹æ³•ï¼Œè€Œç¬¬äºŒä¸ªå°±æ˜¯onClickäº†ï¼Œä¸è¿‡keyupåé¢è·Ÿäº†enterï¼Œè¯´æ˜è¿™ä¸ªkeyupæ–¹æ³•æ˜¯å’Œenterå¥ç»‘å®šçš„ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥è¿›å…¥è¿™ä¸¤ä¸ªå‡½æ•°å†…éƒ¨çœ‹çœ‹ï¼Œçœ‹å®ƒå…·ä½“çš„å®ç°æ–¹æ³•ã€‚ 1234567addTodo: function () &#123; var text = this.newTodo.trim() if (text) &#123; this.todos.push(&#123; text: text &#125;) this.newTodo = &apos;&apos; &#125;&#125; è¿™ä¸ªå‡½æ•°ä¸­ä¸»è¦æ˜¯åœ¨é’ˆå¯¹this.newTodoè¿›è¡Œæ“ä½œï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ï¼ŒnewTodoè¿™æ¡æ•°æ®æ˜¯å’Œv-modelè¿™ä¸ªå±æ€§ç»‘åœ¨ä¸€èµ·çš„ï¼Œç„¶åè¿™ä¸ªå±æ€§åˆæ˜¯å’Œinputè¾“å…¥æ¡†ç»‘å®šåœ¨ä¸€èµ·çš„ï¼Œæ‰€ä»¥å¯ä»¥è¡¨æ˜è¿™é‡Œçš„this.newTodoæŒ‡çš„å°±æ˜¯inputè¾“å…¥æ¡†é‡Œçš„å€¼ï¼Œç„¶åå†å°†å…¶å»é™¤é¦–å°¾ç©ºæ ¼ï¼Œpushè¿›todosåˆ—è¡¨ï¼Œæœ€åå†æ¸…ç©ºè¾“å…¥æ¡†ã€‚è€Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹å¦ä¸€ä¸ªå‡½æ•°ï¼š 123removeTodo: function (index) &#123; this.todos.splice(index, 1)&#125; è¿™ä¸ªå‡½æ•°æ›´ç®€å•ï¼Œå°±ä¸€å¥è¯ï¼Œæ‰§è¡Œä¸€ä¸ªæ•°ç»„æ“ä½œï¼Œåˆ é™¤æ•°ç»„çš„æŸä¸€é¡¹ï¼Œè€Œè¿™ä¸ªå‡½æ•°çš„è°ƒç”¨åœ¨è¿™é‡Œï¼šv-on:click=â€removeTodo($index)â€ï¼Œå¯ä»¥çœ‹åˆ°åœ¨è°ƒç”¨çš„æ—¶å€™ä¼ å…¥äº†ä¸€ä¸ªå‚æ•°$indexï¼Œè¿™æŒ‡çš„æ˜¯å¯¹åº”çš„liæ ‡ç­¾çš„indexï¼Œç„¶åå½“ç‚¹å‡»çš„æ—¶å€™ï¼Œå°±å¯ä»¥é€šè¿‡indexæ¥åˆ é™¤è¿™ä¸ªliæ ‡ç­¾äº†ã€‚ è¯´äº†è¿™ä¹ˆå¤šï¼Œæˆ‘çŸ¥é“ï¼Œç†å·¥ç§‘çš„ä¸œè¥¿è®²å†å¤šçš„é“ç†éƒ½æ˜¯ååˆ†æŠ½è±¡çš„ï¼Œæ‰€ä»¥æœ€åæˆ‘è¿˜æ˜¯ä¸Šå‡ å¼ å›¾å§ï¼Œä¸ºäº†èƒ½å¤Ÿæ›´å¥½çš„ç†è§£ã€‚ å›¾1è¿™æ˜¯åˆå§‹åŒ–çš„æ—¶å€™ï¼Œä¸€åˆ‡éƒ½ä¸ºç©ºã€‚ å›¾2ç„¶åæˆ‘åœ¨è¾“å…¥æ¡†é‡Œè¾“å…¥æ•°æ®ï¼ŒæŒ‰ä¸‹enteré”®ã€‚ å›¾3å¯ä»¥çœ‹åˆ°ï¼Œä¸‹é¢åˆ—è¡¨ä¸­å¤šäº†ä¸€æ¡æ•°æ®ï¼Œæ˜¯æˆ‘åˆšæ‰è¾“å…¥çš„æ•°æ®ã€‚ å›¾4ç„¶åæˆ‘åˆè¾“å…¥äº†å‡ æ¡æ•°æ®ï¼Œä¸€å…±ä¸‰æ¡ã€‚ å›¾5æœ€åæˆ‘åˆ é™¤å…¶ä¸­ä¸€æ¡ï¼Œå°±åˆ é™¤ç¬¬äºŒæ¡å§ï¼Œç‚¹å‡»å³è¾¹çš„é‚£ä¸ªå°å‰å°±å¯ä»¥äº†ï¼Œå¯ä»¥çœ‹åˆ°è¿™æ¡å°±è¢«åˆ äº†ï¼Œå…¶ä»–çš„æ•°æ®ä¸å˜ã€‚","tags":[]},{"title":"hexoåšå®¢å¢åŠ æœç´¢åŠŸèƒ½","date":"2016-08-19T13:42:59.000Z","path":"2016/08/19/hexo-search/","text":"æœ€è¿‘åœ¨ç”¨åœ¨æŸä¸ªé¡¹ç›®ä¸Šå¢åŠ ä¸€ä¸ªæœç´¢æ¡†ï¼Œåç«¯ç”¨nodeï¼‹mongodbå®ç°ï¼Œæœ¬æ¥ä»¥ä¸ºæŒºç®€å•çš„ï¼Œå°±ç”¨nodeçˆ¬ä¸€ä¸‹é¡µé¢titleå’Œhrefï¼Œç„¶åæ”¾è¿›mongodbä¸­ï¼Œå†é€šè¿‡å‰ç«¯å‘è¯·æ±‚ä¼ æ•°æ®è¿‡æ¥æŸ¥æ‰¾ï¼Œç„¶ånodeå†åœ¨mongodbä¸­æŸ¥æ‰¾ï¼Œå°†æ•°æ®è¿”å›å‰ç«¯ã€‚ è¿™æ˜¯ç†æƒ³æƒ…å†µä¸‹çš„åšæ³•ï¼Œå¯æ˜¯ç°å®å¾€å¾€å……æ»¡äº†æ›²æŠ˜,ä¸‹é¢æˆ‘æ¥ç®€å•ä»‹ç»ä¸‹è¿™ä¸ªé¡¹ç›®ï¼Œç„¶åè¯´ä¸€ä¸‹é—®é¢˜å§ã€‚ è¿™æ˜¯ä¸ªå†…ç½‘é¡¹ç›®ï¼Œæ‰€ä»¥çˆ¬è™«çˆ¬ä¸è¿›å»ï¼Œå¥½åœ¨æœ‰ä¸€ä¸ªç›®å½•é¡µï¼Œå°†æ‰€æœ‰é¡µé¢çš„titleå’Œhrefæ•´ç†äº†èµ·æ¥ï¼Œä¸è¿‡è¯»å–è¿™ä¸ªæ–‡ä»¶ä¹Ÿä¸æ˜¯ç®€å•çš„äº‹ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯ç±»ä¼¼äºjsonæ ¼å¼çš„æ–‡ä»¶ï¼Œä½†æ˜¯å´æ²¡æœ‰ä»»ä½•çš„ç¬¦å·ï¼Œå…¨æ˜¯æ±‰å­—ï¼Œè€Œæˆ‘ä»¬å­˜å‚¨çš„æ—¶å€™æ˜¯éœ€è¦åˆ†å±‚æ¬¡çš„ï¼Œè¿™æ ·åˆ©äºæŸ¥æ‰¾ï¼Œé‡‡ç”¨nodeçš„FSæ¨¡å—å¯ä»¥å¾ˆå®¹æ˜“åœ°è¯»å–åˆ°æ–‡ä»¶çš„å†…å®¹ï¼Œä½†æ˜¯ä»…ä»…æ˜¯è¯»å–ï¼Œç›´æ¥å­˜å‚¨çš„è¯ä¼šå¯¼è‡´æ²¡æœ‰å±‚æ¬¡æ„Ÿï¼Œæ‰€ä»¥æˆ‘å°±æŠŠè¿™ä¸ªæ–‡ä»¶å¤åˆ¶äº†ä¸€ä»½å‡ºæ¥ï¼Œé€šè¿‡äººå·¥ç»´æŠ¤çš„æ–¹å¼å°†å…¶å˜ä¸ºjsonæ ¼å¼ï¼Œç„¶åå°±å¾ˆå¥½æ“ä½œäº†ï¼Œä¸è¿‡éœ€è¦äººå·¥ç»´æŠ¤ä¸æ›´æ–°ï¼Œä¸ç®—æ˜¯æœ€å¥½çš„åŠæ³•ï¼Œä½†æ˜¯é‚£ä¸ªæ–‡ä»¶ä¹‹å‰ä¹Ÿæ˜¯äººå·¥ç»´æŠ¤çš„ï¼ˆè™½ç„¶æˆ‘ä¸çŸ¥é“æ˜¯è°ç»´æŠ¤ï¼Œå¦åˆ™å¯ä»¥å«ä»–ä¸€èµ·ç»´æŠ¤ä¸‹ï¼‰ã€‚ è¿™æ˜¯ä¸ªhexoåšå®¢ç³»ç»Ÿï¼Œçº¯é™æ€å±•ç¤ºçš„ï¼Œæ‰€æœ‰é¡µé¢å‡æ˜¯é€šè¿‡é€šè¿‡hexoçš„æ¡†æ¶ï¼Œæ‰§è¡Œhexo gå‘½ä»¤çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨å°†mdæ–‡ä»¶è§£ææˆhtmlï¼ˆcssï¼‰ï¼Œç„¶åå†é€šè¿‡æ‰§è¡Œhexo serverå‘½ä»¤ï¼Œå¼€ä¸€ä¸ªhexoçš„æœåŠ¡å™¨ï¼ŒæŠŠæ‰€æœ‰çš„é¡µé¢é€šè¿‡æœåŠ¡ç«¯æ¸²æŸ“åˆ°æµè§ˆå™¨ï¼›å› æ­¤ï¼Œæˆ‘å¢åŠ çš„è¿™ä¸ªæœç´¢æ¡†çš„åŠŸèƒ½ï¼Œé™¤äº†éœ€è¦è‡ªå·±å†™æœåŠ¡å™¨å’Œæ•°æ®åº“å¤–ï¼Œè¿˜å¿…é¡»æŠŠè¿™ä¸ªé¡¹ç›®å•ç‹¬éƒ¨ç½²ï¼Œå› ä¸ºhexoçš„æºç ä¸Šå¹¶æ²¡æœ‰é’ˆå¯¹æœåŠ¡å™¨çš„æ‰©å±•æ–¹æ³•ï¼ˆè¿™ä¸€ç‚¹æ˜¯@å—çƒ›å¸®æˆ‘ä¸€èµ·çœ‹çš„ï¼Œæ¯•ç«Ÿæˆ‘ä¹‹å‰å¯¹hexoçš„äº†è§£åªæ˜¯ä¼šç”¨è€Œå·²ï¼Œå¹¶æ²¡æœ‰åœ¨å®ƒçš„æºç ä¸Šè¿›è¡Œæ·±å…¥ç ”ç©¶ï¼‰ï¼Œå› æ­¤ï¼Œè¿™å°±æˆä¸ºäº†ä¸¤ä¸ªé¡¹ç›®ï¼Œç„¶åæŠŠè¿™ä¸¤ä¸ªé¡¹ç›®éƒ¨ç½²åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå†é€šè¿‡é…ç½®nginxæœåŠ¡ï¼Œå°†æœç´¢æ¡†ä»å‰ç«¯å‘æ¥çš„è¯·æ±‚æ˜ å°„åˆ°nodeæœåŠ¡å™¨ç›‘å¬çš„é‚£ä¸ªç«¯å£ï¼Œè¿™æ ·å°±å½¢æˆäº†å‰åç«¯æ•°æ®çš„äº¤äº’ï¼Œè¿™é‡Œå‡ºç°äº†ä¸€ä¸ªæ¯”è¾ƒå¥‡æ€ªçš„é—®é¢˜ï¼Œæˆ‘åœ¨æˆ‘è‡ªå·±ç”µè„‘ä¸Šå‘é€è¯·æ±‚æ—¶ï¼Œè¯·æ±‚èƒ½å¤ŸæˆåŠŸå‘å‡ºå»ï¼Œå¯å°±æ˜¯æ¥æ”¶ä¸åˆ°è¿”å›çš„å†…å®¹ï¼Œç„¶åæˆ‘ä»å¦ä¸€å°ç”µè„‘é€šè¿‡èŠ±ç“¶ä»£ç†è¯·æ±‚åˆ°æˆ‘æœ¬åœ°æ¥æµ‹è¯•æ¥å£ï¼Œå´å‘ç°æ˜¯æ­£å¸¸çš„ï¼Œæœ€åå‘ç°æ˜¯ä¸¤ä¸ªé¡¹ç›®ä¹‹é—´çš„è¯·æ±‚è·¨åŸŸäº†ã€‚ è§£å†³è·¨åŸŸï¼Œå¯ä»¥é€‰æ‹©å°†é¡¹ç›®éƒ¨ç½²åœ¨æœåŠ¡å™¨ï¼Œç„¶åå†æµ‹è¯•ï¼Œä¸è¿‡è¿™å°±æ¯”è¾ƒéº»çƒ¦äº†ï¼Œä¿®æ”¹bugæ¯”è¾ƒè›‹ç–¼ï¼Œæˆ–è€…ä½¿ç”¨ä»£ç†ï¼Œå°†è¯·æ±‚ä»£ç†åˆ°å¦ä¸€ä¸ªåŸŸæ¥ï¼Œè¿™æ ·ä¿®æ”¹bugä¹Ÿæ¯”è¾ƒç®€å•ï¼Œç°åœ¨å¼€å§‹å‘è¯·æ±‚äº†ï¼Œå‘ç°æŸ¥æ‰¾ç»“æœæ˜¯æ²¡æœ‰æ•°æ®ï¼Œæ²¡å…³ç³»ï¼Œæˆ‘åˆšåˆšåªæ˜¯éšä¾¿è¾“å…¥çš„ä¸€ä¸ªè¯ï¼Œç°åœ¨æˆ‘è¾“å…¥ä¸€ä¸ªæ•°æ®åº“é‡Œå­˜åœ¨çš„è¯é‡æ–°å‘é€è¯·æ±‚ï¼Œä¸è¿‡é—®é¢˜å°±å‡ºæ¥äº†ï¼Œè¿˜æ˜¯æ²¡æœ‰æ•°æ®ï¼Œæ€ä¹ˆå¯èƒ½å•Šï¼Œæ•°æ®åº“é‡Œç¡®å®æœ‰è¿™ä¸ªæ•°æ®å•Šï¼Œæ€ä¹ˆä¼šæŸ¥ä¸åˆ°ï¼Œäºæ˜¯æˆ‘æ¢äº†å‡ ä¸ªæ•°æ®åº“é‡Œå­˜åœ¨çš„è¯ï¼Œå†åå¤æŸ¥æ‰¾ï¼Œç»“æœå¤§å¤šéƒ½æ˜¯ä¸å­˜åœ¨ï¼Œå”¯ä¸€å­˜åœ¨çš„ä¸€ä¸ªæ˜¯ä¸€ä¸ªè‹±æ–‡å•è¯ï¼Œç„¶åæˆ‘å°±æŸ¥çœ‹è¯·æ±‚ï¼Œå‘ç°åœ°å€æ²¡é”™ï¼Œå‚æ•°å‘¢ï¼Ÿå‚æ•°æ€ä¹ˆè‡ªåŠ¨ç»™æˆ‘è½¬ç äº†ï¼Œæˆ‘å°±å¥½å¥‡äº†ï¼Œç„¶åæˆ‘å†å»åå°å°†è¿™ä¸ªè·å–åˆ°çš„è¯·æ±‚å‚æ•°ï¼Œå¯¹æ¯”äº†ä¸€ä¸‹æ¥æ”¶åˆ°å„ç§å‚æ•°çš„æƒ…å†µï¼Œå‘ç°æ±‰å­—ä¼šè‡ªåŠ¨è½¬ç ï¼Œæ•°å­—å’Œè‹±æ–‡å•è¯ä¼šä¿æŒä¸å˜ï¼Œä½†æ˜¯å½“æŸ¥è¯¢çš„å­—ç¬¦ä¸²ä¸­é—´å‡ºç°ç©ºæ ¼çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨å˜ä¸ºåŠ å·æ¥å¡«å……ç©ºæ ¼ï¼Œæ‰€ä»¥ï¼Œåªæœ‰æ— ç©ºæ ¼çš„æ•°å­—æˆ–è‹±è¯­å­—æ¯æ‰å¯ä»¥ç›´æ¥æŸ¥æ‰¾åˆ°ç»“æœï¼Œå¦åˆ™çš„è¯éƒ½éœ€è¦äººå·¥å†è¿›è¡Œä¸€æ¬¡è½¬ç ï¼Œå°†å…¶è½¬è¿‡æ¥ï¼Œå”‰ï¼Œæ¯•ç«Ÿç¬¬ä¸€æ¬¡å†™æœåŠ¡å™¨ï¼Œè¿™äº›éƒ½éœ€è¦é è‡ªå·±ç‹¬è‡ªæ‘¸ç´¢ã€‚ æ¥ä¸‹æ¥æ˜¯mongodbçš„äº‹æƒ…ã€‚ä¹‹å‰ä½¿ç”¨ç™¾åº¦æœç´¢è¿˜æ˜¯è°·æ­Œæœç´¢ï¼Œæˆ‘éƒ½æ²¡å‘ç°ä»€ä¹ˆå¤§çš„é—®é¢˜ï¼ˆå¯èƒ½æ˜¯æˆ‘æœç´¢çš„é—®é¢˜å¤ªå‚»äº†ï¼‰ï¼Œè¿™æ¬¡æŸ¥è¯¢mongodbå’Œmongooseçš„ç›¸å…³èµ„æ–™ï¼Œå‘ç°ç™¾åº¦æœç´¢å‡ºæ¥çš„éƒ½æ˜¯ä»¥ä¸€äº›åšå®¢ï¼Œç™¾åº¦çŸ¥é“çš„å›ç­”ä¸ºä¸»ï¼Œä¸”å„ä¸ªåšå®¢ä¹‹é—´ç›¸äº’æŠ„è¢­ä¹Ÿæ˜¯å¤Ÿæ— èŠçš„ï¼Œä»…ä»…åªæ˜¯åšåˆ°äº†åˆ¶é€ è€Œä¸æ˜¯åˆ›é€ ã€‚ç„¶åæˆ‘å°±å»è°·æ­Œé‡‡ç”¨è‹±æ–‡æœç´¢ï¼Œstackoverflowï¼Œå®˜æ–¹ç½‘ç«™ç­‰éƒ½æ˜¯æ’åœ¨å¾ˆå‰é¢çš„ï¼ˆä¸çŸ¥é“ç™¾åº¦ä¸ºä»€ä¹ˆæŠŠäººå®¶å®˜ç½‘æ’åœ¨å¾ˆåé¢ï¼‰ï¼Œç®—äº†ï¼Œä¸åæ§½äº†ã€‚mongodbè¿™ç§éå…³ç³»å‹è½»é‡çº§æ•°æ®åº“ï¼Œä½¿ç”¨èµ·æ¥æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œå¢åˆ æŸ¥æ”¹çš„apiéƒ½æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œæ ¹æ®æ‰€ç¤ºèŒƒçš„ä¾‹å­åŠ¨æ‰‹ç¨å¾®å†™ä¸€ä¸‹å°±ä¼šç”¨äº†ï¼Œä¸è¿‡å¯¹äºç¬¬ä¸€æ¬¡ä½¿ç”¨çš„æˆ‘æ¥è¯´ï¼Œè¿˜æ˜¯é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼šå­˜å‚¨çš„æ—¶å€™ï¼Œmongodbä¼šè‡ªåŠ¨ç»™ä½ åŠ ä¸Šä¸‹åˆ’çº¿idï¼Œæˆ‘ä¼°è®¡æ˜¯ä¸ºäº†åŒºåˆ†å­˜å‚¨ç©ºé—´ï¼Œå¯æ˜¯è¿™å°±ä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå½“æˆ‘å­˜å‚¨äº†ä¸€æ¡æ•°æ®è¿‡åï¼Œå†å‚¨å­˜ä¸€æ¡ç›¸åŒçš„æ•°æ®è¿›å»ï¼Œæ˜¯å¯ä»¥å­˜å‚¨è¿›å»çš„ï¼Œå› ä¸ºå®ƒä»¬çš„ä¸‹åˆ’çº¿idä¸åŒï¼Œè¿™æ˜¾ç„¶ä¸å¯¹å•Šï¼Œæˆ‘å¦åˆ™æˆ‘ä¸€æŸ¥æ‰¾ï¼Œå´æ‰¾åˆ°å¾ˆå¤šæ¡æ•°æ®ï¼Œä»”ç»†ä¸€çœ‹å´å‘ç°è¿™ä¹ˆå¤šæ¡æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä¸æ˜¯å¾ˆæç¬‘å—ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©äº†ç»™æ¯æ¡æ•°æ®åŠ ä¸Šä¸€ä¸ªindexä½œä¸ºå”¯ä¸€æ ‡å¿—ç¬¦ï¼Œç„¶åå†åœ¨æ¯æ¬¡å¯åŠ¨çš„æ—¶å€™ï¼Œå»è¯»å–æ–‡ä»¶å­˜å‚¨è¿›æ•°æ®åº“é‡Œï¼Œå­˜è¿›å»ä¹‹å‰ä¼šå…ˆå»æ•°æ®åº“é‡Œé€šè¿‡è¿™ä¸ªindexå”¯ä¸€æ ‡å¿—ç¬¦æŸ¥æ‰¾ä¸€éï¼Œå¦‚æœæŸ¥è¯¢ç»“æœä¸ºç©ºï¼Œæˆ‘æ‰ä¼šæŠŠè¿™æ¡æ•°æ®å­˜è¿›å»ï¼Œå¦åˆ™å°±ä¸å­˜ã€‚å…¶å®å§ï¼Œæ¯æ¬¡å­˜å‚¨çš„æ—¶å€™ä¼šäººä¸ºçš„è‡ªåŠ¨æŸ¥æ‰¾ï¼Œç›¸å½“äºéå†äº†ä¸€éæ•°æ®åº“ï¼Œå¦‚æœæ˜¯åœ¨æ­£å¸¸çš„ç¨å¾®å¤§ä¸€ç‚¹çš„é¡¹ç›®æ¥è¯´ï¼Œè¿™æ˜¯ååˆ†ååˆ†ååˆ†å½±å“æ€§èƒ½çš„ï¼Œç”±äºæˆ‘è¿™é‡Œæ˜¯ä¸ªå¾ˆå°çš„é¡¹ç›®ï¼Œæ‰€ä»¥æ‰å¯ä»¥è¿›è¡Œè¿™ç§æ–¹å¼æŸ¥è¯¢ï¼›å…¶æ¬¡æ˜¯mongoæŸ¥æ‰¾çš„æ—¶å€™ï¼Œé»˜è®¤çš„æ–¹å¼æ˜¯ç²¾ç¡®åŒ¹é…ï¼Œä¸æ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢ï¼Œè¿™æ€ä¹ˆåŠå‘¢ï¼Œéš¾é“éœ€è¦æˆ‘åœ¨æŸ¥è¯¢çš„æ—¶å€™å†éå†ä¸€éæ•°æ®åº“ï¼Œä½¿ç”¨indexOfæ¥æŸ¥è¯¢ï¼Ÿæˆ‘æ„Ÿåˆ°å¾ˆå¯ç¬‘ï¼Œå› ä¸ºä½ è¿™ä¹ˆå‚»çš„æ–¹æ³•åœ¨å®é™…ä¸­æ˜¯è‚¯å®šè¡Œä¸é€šçš„ï¼Œå†è¯´äº†ï¼Œå°±ç®—å¯ä»¥ï¼Œé‚£ä¹ˆå¤§å°å†™çš„æ¨¡ç³ŠæŸ¥è¯¢æ€ä¹ˆåŠï¼Ÿéš¾é“è¦æˆ‘åˆ¤æ–­ä¸‹æœ‰æ²¡æœ‰è‹±æ–‡å­—æ¯ç„¶ååˆ†åˆ«ç”¨ç”¨å¤§å†™å’Œå°å†™éƒ½æ¥éå†ä¸€ä¸‹ï¼Ÿè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨æ­£åˆ™äº†ï¼Œå°†æŸ¥è¯¢çš„å­—ç¬¦ä¸²æ”¹å˜ä¸ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œè¿™æ ·çš„è¯åœ¨æ•°æ®åº“é‡Œå®ƒä¼šè‡ªåŠ¨çš„å»åŒ¹é…æ‰€æœ‰é€‚åˆçš„ç»“æœã€‚","tags":[]},{"title":"redux åº—é“ºè£…ä¿®","date":"2016-07-28T06:33:08.000Z","path":"2016/07/28/react demo/","text":"æœ€è¿‘åœ¨åšåº—é“ºè£…ä¿®ï¼Œå¾ˆå¾ˆå¾ˆéº»çƒ¦çš„ä¸€ä¸ªé¡¹ç›®ï¼Œåˆšå¥½é‡Œé¢ç”¨åˆ°äº†reduxï¼Œæˆ‘å‘ç°åº—é“ºè£…ä¿®ç®€åŒ–ä¸€ä¸‹çš„è¯ï¼Œç®€ç›´æ˜¯reduxçš„ååˆ†å¥½çš„ä¸€ä¸ªç¤ºä¾‹å•Šï¼Œæ¯”å®˜ç½‘ä¸Šç®€å•çš„ç¤ºä¾‹è¦éš¾ï¼Œåˆæ¯”éš¾çš„ç®€å•ï¼Œè€Œä¸”æ¡ç†ç»“æ„ä»€ä¹ˆçš„åˆå¾ˆæ¸…æ¥šï¼ŒæŒºä¸é”™çš„å•Šã€‚ æˆ‘å…ˆä¸Šå›¾å§ã€‚å›¾1å›¾2å›¾3å›¾4å›¾5å›¾6å›¾7å›¾8 å¥½å§ï¼Œè¿™å›¾æˆªçš„ä¹Ÿæ˜¯å¤Ÿå¤§çš„ï¼Œå°†å°±çœ‹çœ‹å§ã€‚ã€‚ã€‚ç”±å›¾1å¯ä»¥çœ‹åˆ°ï¼Œé¡µé¢ä¸€å…±åˆ†ä¸ºå››éƒ¨åˆ†ï¼šå·¦ï¼Œä¸­ä¸Šï¼Œä¸­ä¸‹ï¼Œå³ï¼Œä¹Ÿå°±æ˜¯æ°›å›´å››ä¸ªç»„ä»¶ï¼šLeftï¼ŒTopï¼ŒCenterï¼ŒRightã€‚æ¥ä¸‹æ¥æˆ‘è¯´ä¸€ä¸‹äº¤äº’ï¼Œå¦‚å›¾2æ‰€ç¤ºï¼›æˆ‘åœ¨å·¦è¾¹çš„è¾“å…¥æ¡†ä¸­è¾“å…¥ä¸œè¥¿ï¼Œç„¶åç‚¹å‡»å¢åŠ ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œåˆšåˆšæ–°å¢çš„æ•°æ®ç«‹é©¬åœ¨å³è¾¹ä¸‹é¢éƒ¨åˆ†æ˜¾ç¤ºäº†å‡ºæ¥ï¼Œå±•ç¤ºçš„æ˜¯åˆšæ‰æ–°å¢çš„æ•°æ®å’Œä¸€ä¸ªåˆ é™¤æŒ‰é’®ï¼Œå¦‚å›¾3æ‰€ç¤ºï¼›è‹¥ä½ ç‚¹å‡»å±•ç¤ºçš„æ•°æ®ï¼Œé‚£ä¹ˆåœ¨å³è¾¹ï¼Œä¹Ÿå°±æ˜¯ç¼–è¾‘ç»„ä»¶ä¸­ä¼šå‡ºç°ä¸€ä¸ªè¾“å…¥æ¡†å’Œç¼–è¾‘æŒ‰é’®ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œå¯¹åˆšåˆšç‚¹å‡»çš„æ•°æ®è¿›è¡Œä¿®æ”¹ç„¶åä¿å­˜ï¼Œå¦‚å›¾4ï¼Œå›¾5æ‰€ç¤ºï¼›ä¿å­˜è¿‡åå°±å¯ä»¥çœ‹åˆ°ä¸­é—´çš„æ˜¾ç¤ºæ¨¡å—å¯¹æ•°æ®è¿›è¡Œäº†æ›´æ–°ï¼Œå¦‚å›¾6æ‰€ç¤ºï¼›æ¥ä¸‹æ¥æ˜¯ä¸­é—´ä¸Šæ–¹çš„ä¿å­˜æ¨¡å—ï¼Œä½ ç‚¹å‡»ä¿å­˜æŒ‰é’®ï¼Œè¿™ä¸ªæ¨¡å—åŒæ ·ä¹Ÿèƒ½å–åˆ°å½“å‰çš„æ•°æ®ï¼Œè¿™é‡Œå°±ç”¨ä¸€ä¸ªå¼¹çª—ä»£æ›¿å¥½äº†ï¼Œå¦‚å›¾7æ‰€ç¤ºï¼›æœ€åå°±æ˜¯åˆ é™¤æŒ‰é’®ï¼Œç‚¹å‡»ååˆ æ‰å½“å‰è¿™ä¸€è¡Œçš„æ•°æ®ï¼Œå¦‚å›¾8æ‰€ç¤ºã€‚ å¥½ç´¯ï¼Œè¯´äº†è¿™ä¹ˆå¤šï¼Œå£éƒ½å¹²äº†ã€‚å…¶å®å§ï¼Œä¸€ä¸¤å¥è¯å°±å¯ä»¥è¯´å®Œçš„ï¼šåœ¨è¿™å››ä¸ªç»„ä»¶ä¸­ï¼Œæ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥å–åˆ°stateï¼Œå¹¶ä¸”å¯ä»¥å¯¹stateè¿›è¡Œæ“ä½œã€‚è¯´å®Œäº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•å•Šã€‚ã€‚ã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹index.jså§ï¼Œä¹Ÿå°±æ˜¯å…¥å£æ–‡ä»¶ã€‚ 12345678910111213141516var App = React.createClass(&#123; render: function()&#123; return ( &lt;div className=&quot;row&quot;&gt; &lt;div className=&quot;col-sm-4&quot; style=&#123;&#123; textAlign: &apos;center&apos; &#125;&#125;&gt; &lt;LeftComponent /&gt; &lt;/div&gt; &lt;div className=&quot;col-sm-4&quot; style=&#123;&#123; borderRight: &apos;1px solid #999&apos;, minHeight: &apos;600px&apos;, textAlign: &apos;center&apos; &#125;&#125;&gt; &lt;TopComponent/&gt; &lt;CenterComponent/&gt; &lt;/div&gt; &lt;div className=&quot;col-sm-4&quot; style=&#123;&#123; textAlign: &apos;center&apos; &#125;&#125;&gt; &lt;RightComponent /&gt; &lt;/div&gt; &lt;/div&gt; ); å¾ˆç®€å•å§ï¼Œå°±æ˜¯åˆ†åˆ«æ”¾äº†å››ä¸ªComponentç»„ä»¶è€Œå·²ï¼Œæˆ‘ä»¬ä¹Ÿä¸ç”¨ç®¡è¿™äº›ç»„ä»¶æ˜¯çˆ¶å­å…³ç³»è¿˜æ˜¯å…„å¼Ÿå…³ç³»ï¼Œå› ä¸ºreduxä¸ç”¨è€ƒè™‘è¿™äº›ã€‚ç„¶åæˆ‘ä»¬å»çœ‹çœ‹actionå§ã€‚ 12345678910111213141516171819202122232425262728// action module.exports = &#123; addModelAction: function(name)&#123; return &#123; type: &apos;ADD_MODEL&apos;, name: name &#125; &#125;, editModelAction: function(index, name) &#123; return &#123; type: &apos;EDIT_MODEL&apos;, index: index, name: name &#125; &#125;, deleteModelAction: function(index) &#123; return &#123; type: &apos;DELETE_MODEL&apos;, index: index &#125; &#125;, activeModelAction: function(index) &#123; return &#123; type: &apos;ACTIVE_MODEL&apos;, index: index &#125; &#125;&#125;; åœ¨action.jsè¿™ä¸ªæ–‡ä»¶é‡Œï¼Œæˆ‘ä»¬å†™äº†å››ä¸ªactionå‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°éƒ½è¿”å›ä¸€ä¸ªå¯¹è±¡ä½œä¸ºactionï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Œæ¯ä¸ªactionå‡½æ•°ä¸­è¿”å›çš„å¯¹è±¡é‡Œtypeéƒ½æ˜¯å®šä¹‰å¥½äº†çš„ï¼Œç„¶åæ ¹æ®ä¼ å…¥çš„å‚æ•°æ¥é…ç½®å…¶ä»–è¿”å›å‚æ•°ï¼›ç„¶åå†æ¥çœ‹çœ‹reducerã€‚ 123456789101112131415161718192021222324252627// reducersvar modelReducer = function(state, action)&#123; switch(action.type)&#123; case &apos;ADD_MODEL&apos;: state.items.push(&#123; name: action.name &#125;); return state; break; case &apos;DELETE_MODEL&apos;: state.items.splice(action.index, 1); return state; break; case &apos;EDIT_MODEL&apos;: state.items[action.index].name = action.name; return state; break; case &apos;ACTIVE_MODEL&apos;: state.activeIndex = action.index; return state; break; default: return state; &#125;&#125;;module.exports = modelReducer; è¿™ä¸ªä¹Ÿä¸éš¾ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“reduceréœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼šstateå’Œactionï¼Œé€šè¿‡actioné‡Œçš„typeæ¥å¯¹stateè¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œæœ€åreturn stateã€‚ å¥½äº†ï¼Œreducerå’Œactionéƒ½çœ‹äº†ï¼Œreduxä¸‰è¦ç´ ç°åœ¨æ¥çœ‹çœ‹storeã€‚ 1234import &#123; createStore &#125; from &apos;redux&apos;import modelReducer from &apos;./reducer&apos;var store = createStore(modelReducer, &#123;items: [], activeIndex: -1 &#125;);module.exports = store; å¯¹çš„ï¼Œä¸€å…±å°±è¿™å‡ è¡Œï¼Œstore=createStore(modelReducer, {items: [], activeIndex: -1 })ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯reducerï¼Œå¿…éœ€çš„ï¼Œå¦ä¸€ä¸ªæ˜¯stateåˆå§‹åŒ–çš„å€¼ï¼Œéå¿…éœ€ï¼Œè‹¥ä¸ä¼ åˆ™é»˜è®¤ä¸ºundefinedã€‚ å…¶å®åˆ°è¿™é‡Œï¼Œè¿™ä¸ªç¤ºä¾‹å°±å·²ç»åˆ°äº†å°¾å£°äº†ï¼›å‰©ä¸‹çš„å°±æ˜¯è¿™å››ä¸ªç»„ä»¶çš„å†…éƒ¨å¸ƒå±€ï¼Œè¿˜æœ‰å°±æ˜¯ç»™æŒ‰é’®ç»‘å®šäº‹ä»¶ï¼Œå½“ç‚¹å‡»çš„æ—¶å€™ç”¨dispatchåˆ†å‘ä¸€ä¸ªå¯¹åº”çš„actionå‡½æ•°ç»™reducerï¼Œè¿™äº›æˆ‘åœ¨ä¹‹å‰ä¹Ÿå·²ç»å†™è¿‡äº†ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚","tags":[]},{"title":"reactç”Ÿå‘½å‘¨æœŸè§£è¯»","date":"2016-07-24T06:54:34.000Z","path":"2016/07/24/reactç”Ÿå‘½å‘¨æœŸ/","text":"å‰å‡ å¤©åœ¨å·¥ä½œä¸­å‡ºç°äº†ä¸€ä¸ªæ¯”è¾ƒæ€ªå¼‚çš„bugï¼Œä¸è¿‡è¿˜å¥½ç”±äºreactçš„å•å‘æ•°æ®æµï¼Œä»æœ€å¤–å±‚çˆ¶ç»„ä»¶ä¸€å±‚ä¸€å±‚åœ°å¾€é‡Œé¢æ‰¾ï¼Œåœ¨æ¯ä¸€å±‚éƒ½æ£€æŸ¥ä¸€ä¸‹stateå’Œpropsçš„å€¼æ˜¯å¦æ­£ç¡®ï¼Œæ€»ä¼šæ‰¾åˆ°é—®é¢˜ï¼Œåªä¸è¿‡é‚£ä¸ªç»„ä»¶è¢«å‰äººåµŒå¥—äº†å››äº”å±‚ï¼Œæ‰€ä»¥åœ¨å®šä½é—®é¢˜çš„æ—¶å€™æ¯”è¾ƒè›‹ç–¼ï¼Œæ‰€ä»¥è¿˜æ˜¯æœ€å¥½å…»æˆè‰¯å¥½çš„ä¹ æƒ¯ï¼Œç»„ä»¶åµŒå¥—å±‚çº§ä¸è¦å¤ªå¤šï¼Œè€Œä¸”åœ¨å¼€å‘çš„æ—¶å€™æ¯ä¸€å±‚å°±åˆ«å¿˜äº†æ£€æµ‹propså’Œstateï¼Œå¦åˆ™åæ¥äººä¼šå¾ˆç´¯çš„ã€‚ã€‚ã€‚ ç»è¿‡äº†long long timeï¼Œæ‰åœ¨æŸä¸€å±‚ç»„ä»¶ä¸­æ‰¾åˆ°äº†é—®é¢˜ï¼Œå…·ä½“é—®é¢˜æ˜¯çˆ¶ç»„ä»¶ä¼ å…¥çš„propsæ”¹å˜åå­ç»„ä»¶é€šè¿‡propsæ¥æ¸²æŸ“çš„é¡µé¢æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œæœ‰ç–‘é—®å—ï¼Ÿçˆ¶ç»„ä»¶ä¼ å…¥çš„propsæ”¹å˜ï¼Œå­ç»„ä»¶çš„propsä¸æ˜¯ä¼šè‡ªåŠ¨æ¥æ”¶å˜åŒ–å¹¶ä¸”renderå—ï¼Ÿå—¯ï¼Œæ˜¯çš„ï¼Œä¸ºä»€ä¹ˆè¿™é‡Œæ²¡æœ‰å‘¢ã€‚ã€‚ã€‚åŸæ¥æœ‰äººåœ¨å¼€å‘çš„æ—¶å€™åœ¨getInitialStateå‡½æ•°ä¸­åŠ äº†è¿™ä¹ˆä¸€å¥ï¼šthis.state.xxx = this.props.xxxï¼Œé€šè¿‡è¿™æ ·ï¼Œä»–å°±æŠŠpropså’Œstateå…³è”äº†èµ·æ¥ï¼Œå¿ƒä¸­é¡¿æ—¶æœ‰æ— æ•°è‰æ³¥é©¬ç‹‚å¥”ã€‚ã€‚ã€‚æ€ä¹ˆæ”¹å‘¢ï¼Ÿéš¾é“è¦æˆ‘æŠŠå’Œstateå…³è”äº†çš„propséƒ½å–æ¶ˆå…³è”ï¼Ÿè¿™ä¸ªå·¥ä½œé‡ä¸å°ã€‚ã€‚ã€‚è¿˜å¥½ï¼Œreacté‡Œæœ‰ä¸ªç›‘æµ‹propså˜åŒ–çš„å‡½æ•°ï¼šcomponentWillReceivePropsï¼Œç„¶åæˆ‘å†åœ¨é‡Œé¢æŠŠæ›´æ–°åçš„propså’Œstateå…³è”èµ·æ¥ï¼Œè®©stateç­‰äºæ–°çš„propså°±å¥½äº†ï¼Œå¤§åŠŸå‘Šæˆï¼Œè¿™ä¸ªæ€ªå¼‚çš„é—®é¢˜å°±è§£å†³äº†ã€‚ æœ‰äººä¼šè§‰å¾—å¥‡æ€ªå—ï¼Ÿä¸ºä»€ä¹ˆåœ¨getInitialStateå‡½æ•°ä¸­ä½¿ç”¨äº†this.state.xxx = this.props.xxxï¼Œè€Œåœ¨å½“propsæ›´æ–°åä¼ è¿›æ¥æ—¶ï¼Œstateä¾ç„¶ç­‰äºåŸæ¥çš„propsï¼Œè¿™å°±è¯´åˆ°äº†æœ¬ç‰‡æ–‡ç« çš„ä¸»è¦ï¼Œå°±æ˜¯reactçš„ç”Ÿå‘½å‘¨æœŸã€‚ reactç»„ä»¶çš„è¯¦ç»†è¯´æ˜å’Œç”Ÿå‘½å‘¨æœŸå…ˆæ¥è¯´ä¸€ä¸‹reactåœºè§çš„å‡½æ•°å§ã€‚ 1ï¼Œrender é‡è¦çš„äº‹æƒ…è¯´ä¸‰éï¼šrender()æ–¹æ³•æ˜¯å¿…é¡»çš„ï¼render()æ–¹æ³•æ˜¯å¿…é¡»çš„ï¼ï¼render()æ–¹æ³•æ˜¯å¿…é¡»çš„ï¼ï¼ï¼ å½“ä½¿ç”¨renderæ–¹æ³•çš„æ—¶å€™ï¼Œå®ƒæœ€ç»ˆreturnä¸€ä¸ªå•å­çº§ç»„ä»¶ï¼Œè¿™ä¸ªæ„æ€å°±æ˜¯è¯´è¿”å›ä¸€ä¸ªdom ç»„ä»¶ï¼Œæ¯”å¦‚ä¸€ä¸ª div èŠ‚ç‚¹ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–è‡ªå®šä¹‰çš„ç»„ä»¶ï¼Œæœ‰ä¸ªè¦ç‚¹å°±æ˜¯ä¸€å®šåªèƒ½ return ä¸€ä¸ª dom ç»„ä»¶ï¼Œå½“ä½ æœ‰å¤šä¸ªå•ç‹¬çš„domèŠ‚ç‚¹æˆ–è€…å•ç‹¬çš„è‡ªå®šä¹‰ç»„ä»¶è¦ return çš„æ—¶å€™ï¼Œå¿…é¡»è¦åœ¨å¤–é¢åŒ…è£¹ä¸€å±‚ div æ‰è¡Œã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥è¿”å› null æˆ–è€… false æ¥è¡¨æ˜ä¸éœ€è¦æ¸²æŸ“ä»»ä½•ä¸œè¥¿ã€‚åœ¨ return å‰ä¼šå¹²ä»€ä¹ˆå‘¢ï¼Ÿreturn çš„ä½œç”¨æ˜¯æ¸²æŸ“é¡µé¢çš„ï¼Œè€Œæ¸²æŸ“é¡µé¢éœ€è¦æ•°æ®react é‡Œçš„æ•°æ®ä¸»è¦å°±æ˜¯ props å’Œ stateï¼Œæ‰€ä»¥åœ¨ render æ–¹æ³•ä¸­ï¼Œå®ƒå…ˆä¼šè‡ªåŠ¨ç›‘æµ‹ props å’Œ stateï¼Œrender æ–¹æ³•æœ‰å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹ï¼š1ï¼Œrender å‡½æ•°ä¸­ä¸èƒ½ä¿®æ”¹ stateï¼Œæ‰€ä»¥ setState æ–¹æ³•æ˜¯ä¸èƒ½ç”¨çš„ï¼›2ï¼Œrender å¹¶ä¸æ˜¯æ¸²æŸ“çœŸæ˜¯çš„ dom ï¼Œè€Œæ˜¯ Virtual DOMï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œä½ å¹¶ä¸èƒ½å¯¹ dom è¿›è¡Œæ“ä½œï¼Œthis.getDOMNode()ä¹Ÿå»ä¸åˆ°ä»»ä½•èŠ‚ç‚¹ï¼Œåªèƒ½å¾—åˆ° nullã€‚3ï¼Œä¸å’Œæµè§ˆå™¨äº¤äº’ï¼Œä¾‹å¦‚é€šè¿‡ä½¿ç”¨ setTimeoutã€‚ 2ï¼ŒgetInitialState è¿™æ˜¯åˆå§‹åŒ–stateçš„æ–¹æ³•ï¼Œä»…ä»…åœ¨ç»„ä»¶æŒ‚è½½ä¹‹å‰è°ƒç”¨ä¸€æ¬¡ï¼ 3ï¼ŒgetDefaultProps åœ¨ç»„ä»¶åˆ›å»ºçš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ï¼Œç„¶åè¿”å›å€¼è¢«ç¼“å­˜ä¸‹æ¥ã€‚å¦‚æœçˆ¶ç»„ä»¶æ²¡æœ‰æŒ‡å®š props ä¸­çš„æŸä¸ªé”®ï¼Œåˆ™æ­¤å¤„è¿”å›çš„å¯¹è±¡ä¸­çš„ç›¸åº”å±æ€§å°†ä¼šåˆå¹¶åˆ° this.propsï¼Œï¼ˆå¯ä»¥ä½¿ç”¨ in æ¥æ£€æµ‹å±æ€§ï¼‰ã€‚è¯¥æ–¹æ³•åœ¨å®ä¾‹åˆ›å»ºä¹‹å‰è°ƒç”¨ï¼Œå› æ­¤ä¸èƒ½ä¾èµ–äº this.propsã€‚ 4ï¼ŒcomponentWillMount è¿™ä¸ªæ–¹æ³•ä¼šåœ¨åˆå§‹åŒ–æ¸²æŸ“å®Œæ¯•ä¹‹å‰ç«‹å³è°ƒç”¨ï¼Œä»…æ‰§è¡Œä¸€æ¬¡ã€‚å¯ä»¥ä½¿ç”¨ setState æ–¹æ³•ã€‚ 5ï¼ŒcomponentDidMount è¿™ä¸ªæ–¹æ³•ä¼šåœ¨åˆå§‹åŒ–æ¸²æŸ“å®Œæ¯•ä¹‹åç«‹å³è°ƒç”¨ï¼Œä»…æ‰§è¡Œä¸€æ¬¡ã€‚è¿™ä¸ªæ—¶å€™å·²ç»æ¸²æŸ“å®Œæ¯•äº†ï¼Œæ‰€ä»¥ Virtual DOM å·²ç»æˆä¸ºäº†çœŸå®çš„ DOMï¼Œä½ å¯ä»¥ä½¿ç”¨ this.getDOMNode()æ–¹æ³•ï¼Œå‘é€ ajax è¯·æ±‚ï¼Œæˆ–è€… setTimeout ç­‰æ–¹æ³•ã€‚ 6ï¼ŒcomponentWillReceiveProps è¯¥æ–¹æ³•ä»…ä»…åœ¨ç»„ä»¶æ¥æ”¶åˆ°æ–°çš„ props çš„æ—¶å€™è°ƒç”¨ã€‚æ‰€ä»¥åˆå§‹åŒ–çš„æ—¶å€™ä¸ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¼ å…¥çš„å‚æ•°å°†æ˜¯å³å°†æ¥æ”¶åˆ°çš„æ–°çš„ propsï¼Œä¸€èˆ¬ä¼šé€šè¿‡æ–°è€ props æ¯”è¾ƒï¼Œç„¶åå†å†³å®šéœ€ä¸éœ€è¦æ›´æ–°é¡µé¢ã€‚ 7ï¼ŒshouldComponentUpdate å½“ç»„ä»¶æ¥æ”¶åˆ°äº†æ–°çš„ props æˆ–è€… state çš„æ—¶å€™ï¼Œå³å°†è¦æ¸²æŸ“é¡µé¢ä¹‹å‰è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚æŒ‰å¸¸è§„æ¥è¯´ï¼Œç»„ä»¶ state æˆ– props æ›´æ–°åï¼Œå¾€å¾€éƒ½æ˜¯éœ€è¦é‡æ–°æ¸²æŸ“ä¸€ä¸‹é¡µé¢çš„ï¼Œå½“ç„¶ï¼Œè¿™ä¸æ˜¯ç™¾åˆ†ä¹‹ç™¾ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™å°±éœ€è¦åœ¨æ¸²æŸ“ä¹‹å‰ï¼Œåœ¨åˆ¤æ–­ä¸€ä¸‹ï¼Œæ˜¯å¦çœŸçš„éœ€è¦æ¸²æŸ“ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­å¯ä»¥è·å¾— nextProps å’Œ nextStateï¼Œç„¶åæˆ‘ä»¬å¯ä»¥æ¯”è¾ƒï¼Œçœ‹æ˜¯ä¸æ˜¯çœŸçš„éœ€è¦æ¸²æŸ“ï¼Œå¦‚æœéœ€è¦æ¸²æŸ“ï¼Œå°±return trueï¼Œä¸éœ€è¦æ¸²æŸ“å°± return falseï¼Œè¿™ä¸ªæ–¹æ³•é»˜è®¤æ˜¯ä¼šè¿”å› true çš„ã€‚è¿™ä¸ªæ–¹æ³•å­˜åœ¨çš„æ„ä¹‰å°±æ˜¯ä¸è¯¥æ¸²æŸ“çš„æ—¶å€™ä¸æ¸²æŸ“ï¼ŒèŠ‚çº¦æ—¶é—´ä¼˜åŒ–æ€§èƒ½ï¼Œå½“ç„¶ï¼Œç»„ä»¶å°‘äº†ä¹Ÿæ²¡ä»€ä¹ˆå®é™…æ„ä¹‰ï¼Œå¯æ˜¯å½“ç»„ä»¶æ•°é‡æˆç™¾ä¸Šåƒçš„æ—¶å€™ï¼Œæˆ–è®¸å°±ä¼šå¾ˆæ˜æ˜¾åœ°æ„Ÿè§‰åˆ°ä¼˜åŒ–çš„æ€§èƒ½äº†ã€‚ 8ï¼ŒcomponentWillUpdate è¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯åœ¨æ¥æ”¶åˆ°æ–°çš„ props æˆ–è€… state ä¹‹å‰ç«‹åˆ»è°ƒç”¨ï¼Œä½¿ç”¨è¯¥æ–¹æ³•åšä¸€äº›æ›´æ–°ä¹‹å‰çš„å‡†å¤‡å·¥ä½œï¼Œæ­¤æ—¶ä¸èƒ½æ›´æ”¹ stateã€‚ 9ï¼ŒcomponentDidUpdate ä¸ªäººè§‰å¾—å’ŒcomponentDidMountç±»ä¼¼ï¼Œåªæ˜¯ä¸€ä¸ªåœ¨åˆå§‹åŒ–æ¸²æŸ“åè°ƒç”¨ï¼Œä¸€ä¸ªåœ¨æ›´æ–°æ¸²æŸ“åè°ƒç”¨ã€‚ 10ï¼ŒcomponentWillUnmount åœ¨ç»„ä»¶ä» DOM ä¸­ç§»é™¤çš„æ—¶å€™ç«‹åˆ»è¢«è°ƒç”¨ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­æ‰§è¡Œä»»ä½•æ¸…ç†ï¼Œæ¯”å¦‚æ— æ•ˆçš„å®šæ—¶å™¨ï¼Œæˆ–è€…æ¸…é™¤åœ¨ componentDidMount ä¸­åˆ›å»ºçš„ DOM å…ƒç´ ã€‚ å”‰ï¼Œå¥½ç´¯ï¼Œç»ˆäºæŠŠè¿™ä¸€å¤§å †å‡½æ•°ç§‘æ™®å®Œäº†ï¼Œæˆ‘ç¨å¾®å½’çº³ä¸€ä¸‹å§ï¼Œæ–¹æ³•å¤§è‡´æœ‰ä»¥ä¸‹å‡ ç±»ï¼šåˆå§‹åŒ–çš„æ—¶å€™æ‰§è¡Œçš„ï¼Œåˆå§‹åŒ–æ¸²æŸ“å‰æ‰§è¡Œçš„ï¼Œåˆå§‹åŒ–æ¸²æŸ“åæ‰§è¡Œçš„ï¼Œæ¥æ”¶æ›´æ–°æ—¶æ‰§è¡Œçš„ï¼Œæ¥æ”¶æ›´æ–°åæ¸²æŸ“ä¹‹å‰æ‰§è¡Œçš„ï¼Œæ¥æ”¶æ›´æ–°åæ¸²æŸ“ä¹‹åæ‰§è¡Œçš„ï¼Œå³å°†ç§»é™¤å‰æ‰§è¡Œçš„ã€‚è¿™ä¹ˆå¤šæ–¹æ³•ï¼Œéƒ½æ˜¯å’Œæ‰§è¡Œæ—¶é—´æœ‰å…³ï¼Œå¹¶ä¸”ä¸€ä¸ªæ–¹æ³•åå¾€å¾€ä¼šæ‰§è¡Œå¦ä¸€ç³»åˆ—çš„æ–¹æ³•ï¼Œè¿™å°±æ˜¯å®ƒçš„ç”Ÿå‘½å‘¨æœŸã€‚ æ‰€ä»¥å›åˆ°ä¸Šé¢çš„é—®é¢˜ï¼Œå½“çˆ¶ç»„ä»¶çš„ props æ›´æ–°åï¼Œå­ç»„ä»¶çš„ props ä¹Ÿä¼šæ›´æ–°æ²¡é”™ï¼Œä½†æ˜¯è¿™æ—¶å¹¶ä¸ä¼šé‡æ–°å»æ‰§è¡Œä¸€æ¬¡ getInitialState æ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•ä»…ä»…åœ¨åˆå§‹åŒ–çš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ï¼Œæ‰€ä»¥æœ€å render æ—¶è¿˜æ˜¯ç”¨çš„ä¹‹å‰çš„ state æ¥è¿›è¡Œæ¸²æŸ“ï¼Œæ‰€ä»¥æˆ‘åšçš„å°±æ˜¯åŠ ä¸Š componentWillReceiveProps æ¥è¿›è¡Œäººä¸ºæ›´æ–° stateã€‚ è¿™ç¯‡æ–‡ç« åˆ°è¿™é‡Œåº”è¯¥å°±å¯ä»¥ç»“æŸäº†ï¼Œä¸è¿‡æˆ‘è¿˜æœ‰ç‚¹æ„çŠ¹æœªå°½ï¼Œæ‰€ä»¥ç¨å¾®å¤šè¯´ä¸€ç‚¹å§ã€‚ ä¸Šé¢ä¸¤å¼ å›¾åˆ†åˆ«æ˜¯å„ä¸ªä¸åŒçš„å˜åŒ–ä¼šäº§ç”Ÿçš„ä¸åŒçš„ä¸€ç³»åˆ—çš„æ–¹æ³•è°ƒç”¨ï¼Œï¼Œä»¥åŠæ¯ä¸ªæ–¹æ³•æ˜¯å¦èƒ½å¤Ÿå¯¹ state è¿›è¡Œæ›´æ–°éƒ½åšäº†è¯´æ˜ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œåˆå§‹åŒ–çš„æ—¶å€™ï¼Œprops å˜åŒ–çš„æ—¶å€™ï¼Œstate å˜åŒ–çš„æ—¶å€™ï¼Œéƒ½ä¼šè§¦å‘ä¸åŒæ–¹æ³•æ¥è¿›è¡Œå¤„ç†ï¼Œæœ‰çš„å‡½æ•°æ˜¯å¯ä»¥ä¸å†™çš„ï¼Œå› ä¸ºå®ƒé»˜è®¤ä¼šæ‰§è¡Œï¼Œç»è¿‡ä¸Šæ¬¡æ”¹bugçš„äº‹æƒ…åï¼Œæˆ‘è§‰å¾—å§ï¼Œå±‚çº§å¤šäº†çš„æ—¶å€™è¿˜æ˜¯æœ€å¥½åœ¨æ¯ä¸ªå±‚çº§é‡Œé¢å¯¹ props å’Œ state è¿›è¡Œæ§åˆ¶ç›‘æµ‹ä¸€ä¸‹ï¼Œä»¥å…å‘ç”Ÿä¸å¿…è¦çš„é”™è¯¯ã€‚","tags":[]},{"title":"redux example(1)","date":"2016-07-23T08:48:01.000Z","path":"2016/07/23/redux example(1)/","text":"æœ€è¿‘åœ¨å­¦ä¹ reduxï¼Œçœ‹äº†ä¸å°‘ç›¸å…³çš„èµ„æ–™ï¼Œå‘ç°è¿™ä¸ªå®˜æ–¹æ•™ç¨‹çš„ä¸€äº›ä¾‹å­è¿˜æ˜¯å¾ˆä¸é”™çš„ï¼Œç”±æµ…å…¥æ·±å„ä¸ªæ¡£æ¬¡éƒ½æœ‰ï¼Œæ‰€ä»¥æˆ‘ç¨å¾®çœ‹äº†ä¸‹ï¼Œå‡†å¤‡æœ‰æ—¶é—´çš„è¯å°†ç¤ºä¾‹éƒ½è‡ªå·±å¼„æ‡‚ï¼Œç„¶ååˆ†åˆ«å†™ç¯‡è¯¦ç»†çš„è§£è¯»å‡ºæ¥ï¼Œç”±äºæ˜¯ä¸´æ—¶èµ·æ„ï¼Œæ‰€ä»¥ä»Šå¤©å…ˆå†™ç¬¬ä¸€ç¯‡å§ã€‚ counter-vanillaè¿™æ˜¯reduxä¸­çš„ç¬¬ä¸€ä¸ªç¤ºä¾‹ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜¯æœ€ç®€å•çš„ä¸€ä¸ªä¾‹å­ï¼Œä¸å¤šè¯´äº†ï¼Œå…ˆçœ‹çœ‹ä»£ç å§ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;Redux basic example&lt;/title&gt; &lt;script src=&quot;https://npmcdn.com/redux@latest/dist/redux.min.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;div&gt; &lt;p&gt; Clicked: &lt;span id=&quot;value&quot;&gt;0&lt;/span&gt; times &lt;button id=&quot;increment&quot;&gt;+&lt;/button&gt; &lt;button id=&quot;decrement&quot;&gt;-&lt;/button&gt; &lt;button id=&quot;incrementIfOdd&quot;&gt;Increment if odd&lt;/button&gt; &lt;button id=&quot;incrementAsync&quot;&gt;Increment async&lt;/button&gt; &lt;/p&gt; &lt;/div&gt; &lt;script&gt; function counter(state, action) &#123; if (typeof state === &apos;undefined&apos;) &#123; return 0 &#125; switch (action.type) &#123; case &apos;INCREMENT&apos;: return state + 1 case &apos;DECREMENT&apos;: return state - 1 default: return state &#125; &#125; var store = Redux.createStore(counter) var valueEl = document.getElementById(&apos;value&apos;) function render() &#123; valueEl.innerHTML = store.getState().toString() &#125; render() store.subscribe(render) document.getElementById(&apos;increment&apos;) .addEventListener(&apos;click&apos;, function () &#123; store.dispatch(&#123; type: &apos;INCREMENT&apos; &#125;) &#125;) document.getElementById(&apos;decrement&apos;) .addEventListener(&apos;click&apos;, function () &#123; store.dispatch(&#123; type: &apos;DECREMENT&apos; &#125;) &#125;) document.getElementById(&apos;incrementIfOdd&apos;) .addEventListener(&apos;click&apos;, function () &#123; if (store.getState() % 2 !== 0) &#123; store.dispatch(&#123; type: &apos;INCREMENT&apos; &#125;) &#125; &#125;) document.getElementById(&apos;incrementAsync&apos;) .addEventListener(&apos;click&apos;, function () &#123; setTimeout(function () &#123; store.dispatch(&#123; type: &apos;INCREMENT&apos; &#125;) &#125;, 1000) &#125;) &lt;/script&gt; &lt;/body&gt;&lt;/html&gt; å¦‚ä¸Šé¢ä»£ç æ‰€ç¤ºï¼Œä¸€å…±ä¹Ÿå°±å‡ åè¡Œï¼Œè€Œä¸”å°±è¿™ä¸€ä¸ªæ–‡ä»¶ï¼Œæ¯•ç«Ÿæ˜¯æœ€åŸºç¡€æœ€ç®€å•çš„ä¸€ä¸ªç¤ºä¾‹ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæ–‡ä»¶ç»“æ„å’ŒåŒ…ä¾èµ–ï¼Œä»¥åŠåˆ°nodeæœåŠ¡å™¨ç­‰ï¼Œï¼Œå”¯ä¸€çš„ä¸€ä¸ªä¾èµ–ä¹Ÿé€šè¿‡äº†scriptæ ‡ç­¾å¼•å…¥ã€‚ä¸åºŸè¯äº†ï¼Œä¸‹é¢å¼€å§‹è®²è§£ä¸€ä¸‹ä»£ç å§ã€‚ domç»“æ„å°±å¾ˆç®€å•å§ï¼Œä¸»è¦å°±æ˜¯ä¸€ä¸ªspanæ ‡ç­¾åŒ…è£¹ä¸€ä¸ªæ•°å­—ï¼Œç„¶åå°±æ˜¯å‡ ä¸ªbuttonæŒ‰é’®ï¼Œç‚¹å‡»æŒ‰é’®çš„æ—¶å€™ä¼šè®©spanæ ‡ç­¾é‡Œçš„æ•°å­—å¢ä¸€ã€å‡ä¸€ã€å¥‡æ•°åŠ ä¸€å˜ä¸ºå¶æ•°ã€å¼‚æ­¥åŠ ä¸€ï¼ˆä¹Ÿå°±æ˜¯åŠ ä¸ªå®šæ—¶å™¨å»¶è¿Ÿï¼‰ã€‚ ä¸‹é¢æ¥çœ‹scriptæ ‡ç­¾é‡Œçš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯å®ç°é€»è¾‘å’ŒåŠŸèƒ½çš„ä¸»è¦ä»£ç ã€‚ 12345678910111213function counter(state, action) &#123; if (typeof state === &apos;undefined&apos;) &#123; return 0 &#125; switch (action.type) &#123; case &apos;INCREMENT&apos;: return state + 1 case &apos;DECREMENT&apos;: return state - 1 default: return state &#125;&#125; è¿™æ®µä»£ç ä¸»è¦å®ç°çš„æ˜¯reducerï¼Œå®ƒä¸»è¦æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯stateï¼Œå¦ä¸€ä¸ªæ˜¯actionï¼ŒstateæŒ‡ä»£çš„æ˜¯reactä¸­çš„stateï¼ˆçŠ¶æ€ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œspanæ ‡ç­¾ä¸­çš„æ•°å­—ï¼Œactionæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé€šè¿‡actionï¼Œreducerå°±çŸ¥é“è¯¥åšä»€ä¹ˆï¼Œæ¯”å¦‚è¿™æ®µä»£ç å°±æ˜¯é€šè¿‡åˆ¤æ–­action.typeï¼Œæ¥å¯¹stateè¿›è¡Œæ“ä½œã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„ç‚¹ï¼Œé‚£å°±æ˜¯ç»™stateè®¾ç½®ä¸€ä¸ªreturnçš„é»˜è®¤å€¼ï¼Œä¸€èˆ¬æ¥è¯´å°±å†™æˆfunction counter(state = initialState, action)ï¼Œes6çš„å†™æ³•ï¼Œæ„æ€åœ¨å¿˜äº†ä¼ stateçš„æ—¶å€™ç»™stateä¼ å…¥ä¸€ä¸ªé»˜è®¤å€¼ã€‚ var store = Redux.createStore(counter) ä¸Šé¢è¿™å¥ä»£ç ï¼Œä¸»è¦å®ç°çš„æ˜¯ç”¨createStoreæ–¹æ³•ï¼Œåˆ›å»ºstoreï¼Œè€Œä¼ å…¥çš„å‚æ•°counteræˆ‘ä¸Šé¢å·²ç»è¯´è¿‡äº†ï¼Œæ˜¯ä¸€ä¸ªreducerï¼Œæ‰€ä»¥storeçš„åˆ›å»ºå®é™…ä¸Šæ˜¯è¿™æ ·çš„ï¼švar store = createStore(reducer)ã€‚ æ•´ä¸ªåº”ç”¨ï¼Œåªèƒ½æœ‰ä¸€ä¸ªstoreï¼å¯æ˜¯ï¼Œreducerå´å¯ä»¥æœ‰å¤šä¸ªï¼Œè¿™æ ·é—®é¢˜å°±æ¥äº†ï¼Œç”±äºåˆ›å»ºstoreçš„æ—¶å€™éœ€è¦ä¼ å…¥reducerï¼Œè€Œstoreåªèƒ½æœ‰ä¸€ä¸ªï¼Œä½†æ˜¯reducerå´å¯ä»¥æœ‰å¤šä¸ªï¼Œé‚£æ€ä¹ˆåŠï¼Ÿ]react-reduxä¸­åˆä¸€ä¸ªç®¡ç†reducerçš„æ–¹æ³•ï¼Œå«åšcombineReducersï¼Œå®ƒèƒ½æŠŠæ‰€æœ‰çš„reduceré›†ä¸­æ•´åˆä¸ºä¸€ä¸ªreducersï¼Œå…¶ä½¿ç”¨æ–¹æ³•æ˜¯ï¼š 1234var reducers = combineReducers(&#123; reducers1, reducers2...&#125;) å…³äºreact-reduxçš„å…·ä½“ç»†èŠ‚åé¢å†è¯´ã€‚ 123456var valueEl = document.getElementById(&apos;value&apos;)function render() &#123; valueEl.innerHTML = store.getState().toString()&#125;render()store.subscribe(render) è¿™æ®µä»£ç å°±ä¸»è¦å°±æ˜¯æ‰§è¡Œrenderå‡½æ•°äº†ï¼Œstore.getState() å‡½æ•°ï¼Œå®ƒå°†ä¼šè¿”å›stateã€‚å¦‚æœæ˜¯å¸¸è§„reactçš„renderå‡½æ•°çš„è¯ï¼Œæ˜¯å°†ä¸€ä¸ªdomèŠ‚ç‚¹æŒ‚è½½åˆ°root elementä¸‹é¢å»ï¼Œè€Œåœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œåªè¦å°†çŠ¶æ€æŒ‚è½½åˆ°å¯¹åº”çš„èŠ‚ç‚¹ä¸Šå»å°±å¯ä»¥äº†ã€‚æœ€åä¸€è¡Œä»£ç æ˜¯æ³¨å†ŒçŠ¶æ€ç›‘å¬å™¨ï¼Œåœ¨è¿™é‡ŒæŒ‡å½“storeé‡Œé¢çš„stateå‘ç”Ÿæ”¹å˜æ—¶ï¼Œè§¦å‘renderå›è°ƒå‡½æ•° 12345678910111213141516document.getElementById(&apos;increment&apos;).addEventListener(&apos;click&apos;, function () &#123; store.dispatch(&#123; type: &apos;INCREMENT&apos; &#125;) &#125;)document.getElementById(&apos;decrement&apos;).addEventListener(&apos;click&apos;, function () &#123; store.dispatch(&#123; type: &apos;DECREMENT&apos; &#125;) &#125;)document.getElementById(&apos;incrementIfOdd&apos;).addEventListener(&apos;click&apos;, function () &#123; if (store.getState() % 2 !== 0) &#123; store.dispatch(&#123; type: &apos;INCREMENT&apos; &#125;) &#125; &#125;)document.getElementById(&apos;incrementAsync&apos;).addEventListener(&apos;click&apos;, function () &#123; setTimeout(function () &#123; store.dispatch(&#123; type: &apos;INCREMENT&apos; &#125;) &#125;, 1000) &#125;) è¿™æ®µä»£ç ä¸»è¦æ˜¯ç»™ä¸‹é¢çš„å„ä¸ªæŒ‰é’®ç»‘å®šäº‹ä»¶ï¼Œè¿™é‡Œéœ€è¦åšçš„æ˜¯åˆ†å‘actionï¼Œé€šè¿‡store.dispatch(action)è¿™ä¸ªæ–¹æ³•ï¼ŒæŠŠactionä¼ é€’ç»™reducerï¼Œè€Œreducerä¸­å·²ç»å®šä¹‰å¥½äº†å…·ä½“çš„å‡½æ•°ï¼Œä¼šæ ¹æ®æ¥æ”¶åˆ°çš„actionæ¥åˆ¤æ–­å¯¹stateè¿›è¡Œä»€ä¹ˆæ“ä½œã€‚ å¥½äº†ï¼Œç¬¬ä¸€ä¸ªç¤ºä¾‹åˆ°æ­¤å°±åŸºæœ¬ç»“æŸäº†ï¼Œä¸‹é¢æˆ‘å†å¥½å¥½åœ°æ•´ç†ä¸€ä¸‹reduxçš„å…·ä½“æµç¨‹ï¼š 1ï¼Œé€šè¿‡createStoreæ–¹æ³•åˆ›å»ºstoreï¼Œä¼ å…¥reducerå‚æ•°ï¼Œä¸”ä¸€ä¸ªåº”ç”¨åªèƒ½æœ‰ä¸€ä¸ªstoreã€‚storeå¸¸ç”¨çš„æ–¹æ³•æœ‰ï¼šgetStateæ–¹æ³•ï¼Œç”¨æ¥è·å–stateï¼›dispatchæ–¹æ³•ç”¨æ¥åˆ†å‘actionï¼Œsubscribeæ–¹æ³•ç”¨æ¥æ³¨å†Œç›‘å¬å™¨æ‰§è¡Œå›è°ƒå‡½æ•°ã€‚ 2ï¼Œåˆ›å»ºå¥½storeåï¼Œé€šè¿‡dispatchæ–¹æ³•æ¥åˆ†å‘actionç»™reducerï¼Œactionæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚ 3ï¼Œreduceræ¥æ”¶åˆ°äº†stateï¼ˆstateå¯ä¼ å¯ä¸ä¼ ï¼Œä½†æ˜¯è¦åœ¨reducerä¸­å†™ä¸Šæ²¡æœ‰ä¼ stateæ—¶çš„æƒ…å†µåˆ¤æ–­ï¼‰ï¼Œactionåï¼Œä¼šæ ¹æ®actioné‡Œçš„typeå±æ€§æ¥å¯¹stateè¿›è¡Œå¯¹åº”çš„æ“ä½œã€‚ æˆ‘æç»˜ä¸€ä¸‹reduxçš„æµç¨‹å›¾ï¼Œå¤§è‡´è¿™æ ·çš„ï¼šconst store = createStore(reducer) â€“&gt; store.dispatch(action) â€“&gt; reducer(state, action) â€“&gt; æ ¹æ®stateæ¸²æŸ“é¡µé¢","tags":[]}]